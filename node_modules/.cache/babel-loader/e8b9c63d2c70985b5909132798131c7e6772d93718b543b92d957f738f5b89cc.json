{"ast":null,"code":"import _objectSpread from\"C:/Users/LENOVO/Documents/GitHub/court-marshal-connect/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useMemo,useCallback,memo,useEffect}from\"react\";import{Calendar as CalendarIcon,Plus,ChevronLeft,ChevronRight,Filter,Search,Edit,Trash2,Save,X,Clock,Users,Building,FileText,Settings,Sun,Moon}from'lucide-react';import{CONFIG}from'../config';// --- ฟังก์ชันตรวจสอบวันหยุด ---\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const isHoliday=function(date){let holidays=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(!date)return false;const dayOfWeek=date.getDay();if(dayOfWeek===0||dayOfWeek===6)return true;const dateStr=date.toISOString().split('T')[0];return holidays.some(holiday=>holiday.holiday_date===dateStr);};const isToday=date=>{if(!date)return false;const today=new Date();return date.getDate()===today.getDate()&&date.getMonth()===today.getMonth()&&date.getFullYear()===today.getFullYear();};// --- ฟังก์ชันหา shift_type ตาม period และ holiday ---\nconst getShiftTypeByPeriod=(period,isHolidayDate,shiftTypes)=>{if(!Array.isArray(shiftTypes))return null;if(period==='night'){return shiftTypes.find(type=>type.id===2||type.id===4);}else{return isHolidayDate?shiftTypes.find(type=>type.id===3):shiftTypes.find(type=>type.id===1);}};// --- Redesigned Calendar Components ---\nconst ShiftCalendarView=/*#__PURE__*/memo(_ref=>{let{currentDate,schedules,holidays,filters,setFilters,units,navigateMonth,goToToday,openAddModal,openEditModal}=_ref;const days=useMemo(()=>{const year=currentDate.getFullYear();const month=currentDate.getMonth();const firstDay=new Date(year,month,1);const lastDay=new Date(year,month+1,0);const daysInMonth=lastDay.getDate();const startingDayOfWeek=firstDay.getDay();const daysArray=[];// Add blank days for the start of the month\nfor(let i=0;i<startingDayOfWeek;i++){daysArray.push(null);}// Add days of the month\nfor(let day=1;day<=daysInMonth;day++){daysArray.push(new Date(year,month,day));}// Add blank days to complete the grid\nwhile(daysArray.length%7!==0){daysArray.push(null);}return daysArray;},[currentDate]);const getSchedulesForDate=useCallback(date=>{if(!date)return[];const dateStr=date.toISOString().split('T')[0];return schedules.filter(schedule=>schedule.duty_date===dateStr);},[schedules]);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-sm border border-slate-200 p-4 h-full flex flex-col\",children:[/*#__PURE__*/_jsx(CalendarHeader,{currentDate:currentDate,navigateMonth:navigateMonth,goToToday:goToToday,openAddModal:openAddModal}),/*#__PURE__*/_jsx(CalendarFilters,{filters:filters,setFilters:setFilters,units:units}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow mt-4 flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-7 border-t border-l border-slate-200\",children:['อาทิตย์','จันทร์','อังคาร','พุธ','พฤหัสบดี','ศุกร์','เสาร์'].map(day=>/*#__PURE__*/_jsx(\"div\",{className:\"p-3 text-center text-xs font-semibold text-slate-500 border-b border-r border-slate-200 bg-slate-50\",children:day},day))}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-7 grid-rows-6 flex-grow border-l border-slate-200\",children:days.map((date,index)=>/*#__PURE__*/_jsx(CalendarDayCell,{date:date,holidays:holidays,schedules:getSchedulesForDate(date),onAdd:()=>openAddModal(date),onEdit:openEditModal},date?date.toISOString():\"empty-\".concat(index)))})]})]});});const CalendarHeader=/*#__PURE__*/memo(_ref2=>{let{currentDate,navigateMonth,goToToday,openAddModal}=_ref2;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateMonth(-1),className:\"p-2 text-slate-500 hover:bg-slate-100 rounded-full\",children:/*#__PURE__*/_jsx(ChevronLeft,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-slate-800 text-center w-48\",children:currentDate.toLocaleDateString('th-TH',{month:'long',year:'numeric'})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateMonth(1),className:\"p-2 text-slate-500 hover:bg-slate-100 rounded-full\",children:/*#__PURE__*/_jsx(ChevronRight,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:goToToday,className:\"px-4 py-2 text-sm font-medium text-indigo-600 border border-indigo-200 bg-indigo-50 hover:bg-indigo-100 rounded-lg\",children:\"\\u0E27\\u0E31\\u0E19\\u0E19\\u0E35\\u0E49\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>openAddModal(),className:\"inline-flex items-center px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4 mr-2\"}),\"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E40\\u0E27\\u0E23\"]})]})]});});const CalendarFilters=/*#__PURE__*/memo(_ref3=>{let{filters,setFilters,units}=_ref3;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative flex-1\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0E04\\u0E49\\u0E19\\u0E2B\\u0E32\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48...\",value:filters.officer,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{officer:e.target.value})),className:\"w-full pl-9 pr-3 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Filter,{className:\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.unit,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{unit:e.target.value})),className:\"pl-9 pr-3 py-2 border border-slate-200 rounded-lg text-sm appearance-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u0E17\\u0E38\\u0E01\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E07\\u0E32\\u0E19\"}),Array.isArray(units)&&units.map(unit=>/*#__PURE__*/_jsx(\"option\",{value:unit.id,children:unit.unit_name},unit.id))]})]})]});});const CalendarDayCell=/*#__PURE__*/memo(_ref4=>{let{date,holidays,schedules,onAdd,onEdit}=_ref4;if(!date)return/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-r border-slate-200 bg-slate-50/50\"});const today=isToday(date);const holiday=isHoliday(date,holidays);return/*#__PURE__*/_jsxs(\"div\",{className:\"relative p-2 border-b border-r border-slate-200 flex flex-col group\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-7 h-7 flex items-center justify-center rounded-full text-sm font-semibold \".concat(today?'bg-indigo-600 text-white':holiday?'text-red-600':'text-slate-700'),children:date.getDate()}),holiday&&!today&&/*#__PURE__*/_jsx(\"div\",{className:\"w-1.5 h-1.5 bg-red-500 rounded-full\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 space-y-1 overflow-y-auto\",children:schedules.map(schedule=>/*#__PURE__*/_jsx(ScheduleItem,{schedule:schedule,onEdit:onEdit},schedule.id))}),/*#__PURE__*/_jsx(\"button\",{onClick:onAdd,className:\"absolute bottom-1 right-1 w-6 h-6 flex items-center justify-center bg-slate-100 text-slate-400 rounded-full opacity-0 group-hover:opacity-100 hover:bg-indigo-100 hover:text-indigo-600 transition-opacity\",children:/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"})})]});});const ScheduleItem=/*#__PURE__*/memo(_ref5=>{let{schedule,onEdit}=_ref5;const shiftColors={1:'border-yellow-500',// เวรปกติ\n3:'border-orange-500',// เวรวันหยุด\n2:'border-indigo-500',// เวรกลางคืน\n4:'border-indigo-500',// เวรกลางคืน\ndefault:'border-slate-400'};const borderColor=shiftColors[schedule.shift_type_id]||shiftColors.default;return/*#__PURE__*/_jsxs(\"div\",{onClick:()=>onEdit(schedule),className:\"p-1.5 rounded-md bg-slate-50 hover:bg-slate-100 cursor-pointer border-l-4 \".concat(borderColor),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-slate-800 truncate\",children:schedule.shift_type_name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-600 truncate\",children:schedule.officer_names})]});});const ShiftWorkPage=()=>{const[currentDate,setCurrentDate]=useState(new Date());const[showAddModal,setShowAddModal]=useState(false);const[showEditModal,setShowEditModal]=useState(false);const[selectedSchedule,setSelectedSchedule]=useState(null);const[schedules,setSchedules]=useState([]);const[officers,setOfficers]=useState([]);const[shiftTypes,setShiftTypes]=useState([]);const[units,setUnits]=useState([]);const[holidays,setHolidays]=useState([]);const[formData,setFormData]=useState({duty_date:'',shift_type_id:'',unit_id:'',officer_ids:[],notes:''});const[filters,setFilters]=useState({unit:'',officer:''});const[loading,setLoading]=useState(true);const[saving,setSaving]=useState(false);const[selectedShiftPeriod,setSelectedShiftPeriod]=useState('day');const[selectedUnits,setSelectedUnits]=useState([]);const[selectedOfficers,setSelectedOfficers]=useState([]);const[showOfficerList,setShowOfficerList]=useState(false);const[officerSearchTerm,setOfficerSearchTerm]=useState('');useEffect(()=>{const loadHolidaysByYear=async()=>{try{const response=await fetch(\"\".concat(CONFIG.SCHEDULES_API,\"?action=get_holidays&year=\").concat(currentDate.getFullYear()));const result=await response.json();if(!result.success)throw new Error(result.message);setHolidays(result.data);}catch(error){console.error(\"ล้มเหลวในการดึงข้อมูลวันหยุด:\",error);}};loadHolidaysByYear();},[currentDate]);useEffect(()=>{if(selectedUnits.length>0&&Array.isArray(officers)){const officersInSelectedUnits=officers.filter(officer=>officer.unit_id&&selectedUnits.includes(officer.unit_id)).map(officer=>officer.id);setSelectedOfficers(officersInSelectedUnits);}else{setSelectedOfficers([]);}},[selectedUnits,officers]);// --- ฟังก์ชันจัดการการเลือกส่วนงาน ---\nconst handleUnitSelect=unitId=>{setSelectedUnits(prev=>prev.includes(unitId)?prev.filter(id=>id!==unitId):[...prev,unitId]);};// --- ฟังก์ชันจัดการการเลือกเจ้าหน้าที่ ---\nconst handleOfficerAdd=officerId=>{setSelectedOfficers(prev=>[...prev,officerId]);};const handleOfficerRemove=officerId=>{setSelectedOfficers(prev=>prev.filter(id=>id!==officerId));};// --- ฟังก์ชันกรองเจ้าหน้าที่ที่ยังไม่ได้เลือก ---\nconst getAvailableOfficers=()=>{if(!Array.isArray(officers))return[];return officers.filter(officer=>officer.unit_id!==null&&(selectedUnits.length===0||selectedUnits.includes(officer.unit_id))&&!selectedOfficers.includes(officer.id)&&(officerSearchTerm===''||\"\".concat(officer.firstname,\" \").concat(officer.lastname).toLowerCase().includes(officerSearchTerm.toLowerCase())));};// --- ฟังก์ชันหาข้อมูลเจ้าหน้าที่ ---\nconst getOfficerById=officerId=>{return officers.find(o=>o.id===officerId);};useEffect(()=>{loadInitialData();},[]);useEffect(()=>{loadSchedules();},[currentDate]);const loadInitialData=async()=>{setLoading(true);try{await Promise.all([loadOfficers(),loadShiftTypes(),loadUnits(),loadHolidays(),loadSchedules()]);}catch(error){console.error('Error loading initial data:',error.message,error.stack);}finally{setLoading(false);}};const loadSchedules=async()=>{try{const month=currentDate.getMonth()+1;const year=currentDate.getFullYear();const response=await fetch(\"\".concat(CONFIG.SCHEDULES_API,\"?action=get_all_schedules&month=\").concat(month,\"&year=\").concat(year));const data=await response.json();if(data.success){setSchedules(data.data);}else{console.error('Failed to fetch schedules:',data.message);}}catch(error){console.error('Error loading schedules:',error.message,error.stack);}};const loadOfficers=async()=>{try{const response=await fetch(\"\".concat(CONFIG.OFFICERS_API,\"?action=get_all_officers\"));if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();if(data&&data.success&&Array.isArray(data.data)){setOfficers(data.data);}else{console.error('Failed to load officers:',data);setOfficers([]);}}catch(error){console.error('Error loading officers:',error);setOfficers([]);}};const loadShiftTypes=async()=>{try{const response=await fetch(\"\".concat(CONFIG.SCHEDULES_API,\"?action=get_all_shifttypes\"));const data=await response.json();if(Array.isArray(data)){setShiftTypes(data);}else{setShiftTypes([]);}}catch(error){console.error('Error loading shift types:',error);setShiftTypes([]);}};const loadUnits=async()=>{try{const response=await fetch(\"\".concat(CONFIG.SCHEDULES_API,\"?action=get_all_units\"));const data=await response.json();if(Array.isArray(data)){setUnits(data);}else{setUnits([]);}}catch(error){console.error('Error loading units:',error);setUnits([]);}};const loadHolidays=async()=>{try{const response=await fetch(\"\".concat(CONFIG.SCHEDULES_API,\"?action=get_holidays\"));const data=await response.json();if(Array.isArray(data)){setHolidays(data);}else{setHolidays([]);}}catch(error){console.error('Error loading holidays:',error);setHolidays([]);}};const navigateMonth=direction=>{setCurrentDate(prev=>{const newDate=new Date(prev);newDate.setMonth(prev.getMonth()+direction);return newDate;});};const goToToday=()=>{setCurrentDate(new Date());};// --- แก้ไข openAddModal ---\nconst openAddModal=function(){let date=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;const dateObj=date||new Date();const isHolidayDate=isHoliday(dateObj,holidays);const suggestedType=getShiftTypeByPeriod('day',isHolidayDate,shiftTypes);setSelectedShiftPeriod('day');setSelectedUnits([]);setSelectedOfficers([]);setFormData({duty_date:date?date.toISOString().split('T')[0]:'',shift_type_id:(suggestedType===null||suggestedType===void 0?void 0:suggestedType.id)||'',unit_id:'',officer_ids:[],notes:''});setShowAddModal(true);};const openEditModal=schedule=>{setSelectedSchedule(schedule);setFormData({duty_date:schedule.duty_date,shift_type_id:schedule.shift_type_id,unit_id:schedule.unit_id||'',officer_ids:schedule.officer_ids||[],notes:schedule.notes||''});setSelectedOfficers(schedule.officer_ids||[]);setShowEditModal(true);};const closeModals=()=>{setShowAddModal(false);setShowEditModal(false);setSelectedSchedule(null);setSelectedShiftPeriod('day');setSelectedUnits([]);setSelectedOfficers([]);setShowOfficerList(false);setOfficerSearchTerm('');};const handleInputChange=(field,value)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:value}));};const handleSave=async()=>{setSaving(true);try{// อัปเดต shift_type_id และ officer_ids ตาม UI ใหม่\nconst dateObj=new Date(formData.duty_date+'T00:00:00');const isHolidayDate=isHoliday(dateObj,holidays);const shiftType=getShiftTypeByPeriod(selectedShiftPeriod,isHolidayDate,shiftTypes);const payload=_objectSpread(_objectSpread({action:selectedSchedule?'update_schedule':'create_schedule'},formData),{},{shift_type_id:(shiftType===null||shiftType===void 0?void 0:shiftType.id)||formData.shift_type_id,officer_ids:selectedOfficers},selectedSchedule&&{schedule_id:selectedSchedule.id});const response=await fetch(CONFIG.SCHEDULES_API,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});const result=await response.json();if(!result.success)throw new Error(result.message);await loadSchedules();closeModals();}catch(error){console.error('Error saving schedule:',error);}finally{setSaving(false);}};const handleDelete=async()=>{if(!selectedSchedule||!window.confirm('คุณแน่ใจหรือไม่ที่จะลบตารางเวรนี้?'))return;setSaving(true);try{const payload={action:'delete_schedule',schedule_id:selectedSchedule.id};const response=await fetch(CONFIG.SCHEDULES_API,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});const result=await response.json();if(!result.success)throw new Error(result.message);await loadSchedules();closeModals();}catch(error){console.error('Error deleting schedule:',error);}finally{setSaving(false);}};const filteredSchedules=useMemo(()=>{return schedules.filter(schedule=>{const unitMatch=!filters.unit||schedule.unit_id===parseInt(filters.unit);const officerMatch=!filters.officer||schedule.officer_names&&schedule.officer_names.toLowerCase().includes(filters.officer.toLowerCase());return unitMatch&&officerMatch;});},[schedules,filters]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-full\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"h-full flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-grow p-4 bg-slate-50/50 overflow-y-auto\",children:/*#__PURE__*/_jsx(ShiftCalendarView,{currentDate:currentDate,schedules:filteredSchedules,officers:officers,shiftTypes:shiftTypes,units:units,holidays:holidays,filters:filters,setFilters:setFilters,navigateMonth:navigateMonth,goToToday:goToToday,openAddModal:openAddModal,openEditModal:openEditModal})}),(showAddModal||showEditModal)&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-xl w-full max-w-3xl mx-4 max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-b\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:showEditModal?'แก้ไขตารางเวร':'เพิ่มตารางเวรใหม่'}),formData.duty_date&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:[\"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48 \",new Date(formData.duty_date+'T00:00:00').toLocaleDateString('th-TH'),isHoliday(new Date(formData.duty_date+'T00:00:00'),holidays)&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 px-2 py-0.5 bg-red-100 text-red-600 text-xs rounded-full\",children:\"\\u0E27\\u0E31\\u0E19\\u0E2B\\u0E22\\u0E38\\u0E14\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.duty_date,onChange:e=>{handleInputChange('duty_date',e.target.value);// อัปเดต shift type อัตโนมัติเมื่อเปลี่ยนวันที่\nconst newDate=new Date(e.target.value+'T00:00:00');const isHol=isHoliday(newDate,holidays);const suggestedType=getShiftTypeByPeriod(selectedShiftPeriod,isHol,shiftTypes);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{shift_type_id:(suggestedType===null||suggestedType===void 0?void 0:suggestedType.id)||''}));},className:\"w-full border border-gray-300 rounded-lg px-3 py-2\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-3\",children:\"\\u0E0A\\u0E48\\u0E27\\u0E07\\u0E40\\u0E27\\u0E23\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>{setSelectedShiftPeriod('day');const isHol=formData.duty_date?isHoliday(new Date(formData.duty_date+'T00:00:00'),holidays):false;const suggestedType=getShiftTypeByPeriod('day',isHol,shiftTypes);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{shift_type_id:(suggestedType===null||suggestedType===void 0?void 0:suggestedType.id)||''}));},className:\"flex items-center px-4 py-2 rounded-lg border \".concat(selectedShiftPeriod==='day'?'bg-yellow-50 border-yellow-300 text-yellow-700':'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(Sun,{className:\"w-4 h-4 mr-2\"}),\"\\u0E01\\u0E25\\u0E32\\u0E07\\u0E27\\u0E31\\u0E19\"]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>{setSelectedShiftPeriod('night');const suggestedType=getShiftTypeByPeriod('night',false,shiftTypes);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{shift_type_id:(suggestedType===null||suggestedType===void 0?void 0:suggestedType.id)||''}));},className:\"flex items-center px-4 py-2 rounded-lg border \".concat(selectedShiftPeriod==='night'?'bg-indigo-50 border-indigo-300 text-indigo-700':'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(Moon,{className:\"w-4 h-4 mr-2\"}),\"\\u0E01\\u0E25\\u0E32\\u0E07\\u0E04\\u0E37\\u0E19\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-3\",children:\"\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E07\\u0E32\\u0E19\"}),/*#__PURE__*/_jsx(\"div\",{className:\"border border-gray-300 rounded-lg p-4 max-h-40 overflow-y-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-2\",children:Array.isArray(units)&&units.map(unit=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center py-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedUnits.includes(unit.id),onChange:()=>handleUnitSelect(unit.id),className:\"h-4 w-4 text-indigo-600\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-sm text-gray-900\",children:unit.unit_name})]},unit.id))})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-3\",children:\"\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48\\u0E17\\u0E35\\u0E48\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\"}),/*#__PURE__*/_jsx(\"div\",{className:\"border border-gray-300 rounded-lg p-3 min-h-[100px]\",children:selectedOfficers.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm\",children:\"\\u0E22\\u0E31\\u0E07\\u0E44\\u0E21\\u0E48\\u0E44\\u0E14\\u0E49\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:selectedOfficers.map(officerId=>{const officer=getOfficerById(officerId);return officer?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between bg-gray-50 px-3 py-2 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm\",children:[officer.prefix,\" \",officer.firstname,\" \",officer.lastname]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleOfficerRemove(officerId),className:\"text-red-600 hover:text-red-800\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]},officerId):null;})})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"\\u0E08\\u0E31\\u0E14\\u0E01\\u0E32\\u0E23\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowOfficerList(!showOfficerList),className:\"text-sm text-indigo-600 hover:text-indigo-800\",children:showOfficerList?'ซ่อน':'เพิ่มเจ้าหน้าที่'})]}),showOfficerList&&/*#__PURE__*/_jsxs(\"div\",{className:\"border border-gray-300 rounded-lg p-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Search,{className:\"w-4 h-4 text-gray-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0E04\\u0E49\\u0E19\\u0E2B\\u0E32\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48...\",value:officerSearchTerm,onChange:e=>setOfficerSearchTerm(e.target.value),className:\"flex-1 border border-gray-300 rounded px-2 py-1 text-sm\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-40 overflow-y-auto\",children:getAvailableOfficers().length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm\",children:selectedUnits.length===0?'กรุณาเลือกส่วนงานก่อน':officerSearchTerm?'ไม่พบเจ้าหน้าที่ที่ค้นหา':'ไม่มีเจ้าหน้าที่ที่สามารถเลือกได้'}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-1\",children:getAvailableOfficers().map(officer=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between py-2 hover:bg-gray-50 px-2 rounded\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm\",children:[officer.prefix,\" \",officer.firstname,\" \",officer.lastname]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{handleOfficerAdd(officer.id);setOfficerSearchTerm('');// ล้างค่าค้นหาหลังเพิ่ม\n},className:\"text-indigo-600 hover:text-indigo-800 p-1 rounded hover:bg-indigo-50\",children:/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"})})]},officer.id))})})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"\\u0E2B\\u0E21\\u0E32\\u0E22\\u0E40\\u0E2B\\u0E15\\u0E38\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.notes,onChange:e=>handleInputChange('notes',e.target.value),rows:3,className:\"w-full border border-gray-300 rounded-lg px-3 py-2\",placeholder:\"\\u0E23\\u0E32\\u0E22\\u0E25\\u0E30\\u0E40\\u0E2D\\u0E35\\u0E22\\u0E14\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E40\\u0E15\\u0E34\\u0E21...\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-t bg-gray-50 flex justify-between\",children:[/*#__PURE__*/_jsx(\"div\",{children:showEditModal&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleDelete,disabled:saving,className:\"inline-flex items-center px-4 py-2 border border-red-300 text-sm font-medium rounded-lg text-red-700 bg-red-50 hover:bg-red-100\",children:[/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4 mr-2\"}),\"\\u0E25\\u0E1A\\u0E40\\u0E27\\u0E23\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:closeModals,disabled:saving,className:\"px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50\",children:\"\\u0E22\\u0E01\\u0E40\\u0E25\\u0E34\\u0E01\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,disabled:saving||selectedOfficers.length===0,className:\"inline-flex items-center px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed\",children:saving?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"}),\"\\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Save,{className:\"w-4 h-4 mr-2\"}),\"\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\"]})})]})]})]})})]});};export default ShiftWorkPage;","map":{"version":3,"names":["React","useState","useMemo","useCallback","memo","useEffect","Calendar","CalendarIcon","Plus","ChevronLeft","ChevronRight","Filter","Search","Edit","Trash2","Save","X","Clock","Users","Building","FileText","Settings","Sun","Moon","CONFIG","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","isHoliday","date","holidays","arguments","length","undefined","dayOfWeek","getDay","dateStr","toISOString","split","some","holiday","holiday_date","isToday","today","Date","getDate","getMonth","getFullYear","getShiftTypeByPeriod","period","isHolidayDate","shiftTypes","Array","isArray","find","type","id","ShiftCalendarView","_ref","currentDate","schedules","filters","setFilters","units","navigateMonth","goToToday","openAddModal","openEditModal","days","year","month","firstDay","lastDay","daysInMonth","startingDayOfWeek","daysArray","i","push","day","getSchedulesForDate","filter","schedule","duty_date","className","children","CalendarHeader","CalendarFilters","map","index","CalendarDayCell","onAdd","onEdit","concat","_ref2","onClick","toLocaleDateString","_ref3","placeholder","value","officer","onChange","e","prev","_objectSpread","target","unit","unit_name","_ref4","ScheduleItem","_ref5","shiftColors","default","borderColor","shift_type_id","shift_type_name","officer_names","ShiftWorkPage","setCurrentDate","showAddModal","setShowAddModal","showEditModal","setShowEditModal","selectedSchedule","setSelectedSchedule","setSchedules","officers","setOfficers","setShiftTypes","setUnits","setHolidays","formData","setFormData","unit_id","officer_ids","notes","loading","setLoading","saving","setSaving","selectedShiftPeriod","setSelectedShiftPeriod","selectedUnits","setSelectedUnits","selectedOfficers","setSelectedOfficers","showOfficerList","setShowOfficerList","officerSearchTerm","setOfficerSearchTerm","loadHolidaysByYear","response","fetch","SCHEDULES_API","result","json","success","Error","message","data","error","console","officersInSelectedUnits","includes","handleUnitSelect","unitId","handleOfficerAdd","officerId","handleOfficerRemove","getAvailableOfficers","firstname","lastname","toLowerCase","getOfficerById","o","loadInitialData","loadSchedules","Promise","all","loadOfficers","loadShiftTypes","loadUnits","loadHolidays","stack","OFFICERS_API","ok","status","direction","newDate","setMonth","dateObj","suggestedType","closeModals","handleInputChange","field","handleSave","shiftType","payload","action","schedule_id","method","headers","body","JSON","stringify","handleDelete","window","confirm","filteredSchedules","unitMatch","parseInt","officerMatch","isHol","checked","prefix","rows","disabled"],"sources":["C:/Users/LENOVO/Documents/GitHub/court-marshal-connect/src/pages/ShiftWorkPage.js"],"sourcesContent":["import React, { useState, useMemo, useCallback, memo, useEffect } from \"react\";\nimport {\n  Calendar as CalendarIcon,\n  Plus,\n  ChevronLeft,\n  ChevronRight,\n  Filter,\n  Search,\n  Edit,\n  Trash2,\n  Save,\n  X,\n  Clock,\n  Users,\n  Building,\n  FileText,\n  Settings,\n  Sun,\n  Moon\n} from 'lucide-react';\nimport { CONFIG } from '../config';\n\n// --- ฟังก์ชันตรวจสอบวันหยุด ---\nconst isHoliday = (date, holidays = []) => {\n  if (!date) return false;\n  const dayOfWeek = date.getDay();\n  if (dayOfWeek === 0 || dayOfWeek === 6) return true;\n  const dateStr = date.toISOString().split('T')[0];\n  return holidays.some(holiday => holiday.holiday_date === dateStr);\n};\n\nconst isToday = (date) => {\n  if (!date) return false;\n  const today = new Date();\n  return date.getDate() === today.getDate() &&\n         date.getMonth() === today.getMonth() &&\n         date.getFullYear() === today.getFullYear();\n};\n\n// --- ฟังก์ชันหา shift_type ตาม period และ holiday ---\nconst getShiftTypeByPeriod = (period, isHolidayDate, shiftTypes) => {\n  if (!Array.isArray(shiftTypes)) return null;\n  if (period === 'night') {\n    return shiftTypes.find(type => type.id === 2 || type.id === 4);\n  } else {\n    return isHolidayDate \n      ? shiftTypes.find(type => type.id === 3)\n      : shiftTypes.find(type => type.id === 1);\n  }\n};\n\n// --- Redesigned Calendar Components ---\n\nconst ShiftCalendarView = memo(({\n  currentDate,\n  schedules,\n  holidays,\n  filters,\n  setFilters,\n  units,\n  navigateMonth,\n  goToToday,\n  openAddModal,\n  openEditModal\n}) => {\n\n  const days = useMemo(() => {\n    const year = currentDate.getFullYear();\n    const month = currentDate.getMonth();\n    const firstDay = new Date(year, month, 1);\n    const lastDay = new Date(year, month + 1, 0);\n    const daysInMonth = lastDay.getDate();\n    const startingDayOfWeek = firstDay.getDay();\n    const daysArray = [];\n    \n    // Add blank days for the start of the month\n    for (let i = 0; i < startingDayOfWeek; i++) {\n      daysArray.push(null);\n    }\n    \n    // Add days of the month\n    for (let day = 1; day <= daysInMonth; day++) {\n      daysArray.push(new Date(year, month, day));\n    }\n\n    // Add blank days to complete the grid\n    while (daysArray.length % 7 !== 0) {\n      daysArray.push(null);\n    }\n\n    return daysArray;\n  }, [currentDate]);\n\n  const getSchedulesForDate = useCallback((date) => {\n    if (!date) return [];\n    const dateStr = date.toISOString().split('T')[0];\n    return schedules.filter(schedule => schedule.duty_date === dateStr);\n  }, [schedules]);\n\n  return (\n    <div className=\"bg-white rounded-2xl shadow-sm border border-slate-200 p-4 h-full flex flex-col\">\n      <CalendarHeader \n        currentDate={currentDate}\n        navigateMonth={navigateMonth}\n        goToToday={goToToday}\n        openAddModal={openAddModal}\n      />\n      <CalendarFilters \n        filters={filters}\n        setFilters={setFilters}\n        units={units}\n      />\n      <div className=\"flex-grow mt-4 flex flex-col\">\n        <div className=\"grid grid-cols-7 border-t border-l border-slate-200\">\n          {['อาทิตย์', 'จันทร์', 'อังคาร', 'พุธ', 'พฤหัสบดี', 'ศุกร์', 'เสาร์'].map(day => (\n            <div key={day} className=\"p-3 text-center text-xs font-semibold text-slate-500 border-b border-r border-slate-200 bg-slate-50\">\n              {day}\n            </div>\n          ))}\n        </div>\n        <div className=\"grid grid-cols-7 grid-rows-6 flex-grow border-l border-slate-200\">\n          {days.map((date, index) => (\n            <CalendarDayCell\n              key={date ? date.toISOString() : `empty-${index}`}\n              date={date}\n              holidays={holidays}\n              schedules={getSchedulesForDate(date)}\n              onAdd={() => openAddModal(date)}\n              onEdit={openEditModal}\n            />\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n});\n\nconst CalendarHeader = memo(({ currentDate, navigateMonth, goToToday, openAddModal }) => (\n  <div className=\"flex items-center justify-between mb-4\">\n    <div className=\"flex items-center space-x-2\">\n      <button onClick={() => navigateMonth(-1)} className=\"p-2 text-slate-500 hover:bg-slate-100 rounded-full\">\n        <ChevronLeft className=\"w-5 h-5\" />\n      </button>\n      <h2 className=\"text-xl font-semibold text-slate-800 text-center w-48\">\n        {currentDate.toLocaleDateString('th-TH', { month: 'long', year: 'numeric' })}\n      </h2>\n      <button onClick={() => navigateMonth(1)} className=\"p-2 text-slate-500 hover:bg-slate-100 rounded-full\">\n        <ChevronRight className=\"w-5 h-5\" />\n      </button>\n    </div>\n    <div className=\"flex items-center space-x-2\">\n      <button onClick={goToToday} className=\"px-4 py-2 text-sm font-medium text-indigo-600 border border-indigo-200 bg-indigo-50 hover:bg-indigo-100 rounded-lg\">\n        วันนี้\n      </button>\n      <button\n        onClick={() => openAddModal()}\n        className=\"inline-flex items-center px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700\"\n      >\n        <Plus className=\"w-4 h-4 mr-2\" />\n        เพิ่มเวร\n      </button>\n    </div>\n  </div>\n));\n\nconst CalendarFilters = memo(({ filters, setFilters, units }) => (\n  <div className=\"flex items-center space-x-4\">\n    <div className=\"relative flex-1\">\n      <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400\" />\n      <input\n        type=\"text\"\n        placeholder=\"ค้นหาเจ้าหน้าที่...\"\n        value={filters.officer}\n        onChange={(e) => setFilters(prev => ({ ...prev, officer: e.target.value }))}\n        className=\"w-full pl-9 pr-3 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"\n      />\n    </div>\n    <div className=\"relative\">\n      <Filter className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400\" />\n      <select\n        value={filters.unit}\n        onChange={(e) => setFilters(prev => ({ ...prev, unit: e.target.value }))}\n        className=\"pl-9 pr-3 py-2 border border-slate-200 rounded-lg text-sm appearance-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"\n      >\n        <option value=\"\">ทุกส่วนงาน</option>\n        {Array.isArray(units) && units.map(unit => (\n          <option key={unit.id} value={unit.id}>{unit.unit_name}</option>\n        ))}\n      </select>\n    </div>\n  </div>\n));\n\nconst CalendarDayCell = memo(({ date, holidays, schedules, onAdd, onEdit }) => {\n  if (!date) return <div className=\"border-b border-r border-slate-200 bg-slate-50/50\"></div>;\n\n  const today = isToday(date);\n  const holiday = isHoliday(date, holidays);\n\n  return (\n    <div className=\"relative p-2 border-b border-r border-slate-200 flex flex-col group\">\n      <div className=\"flex items-center space-x-2 mb-2\">\n        <span className={`w-7 h-7 flex items-center justify-center rounded-full text-sm font-semibold ${today ? 'bg-indigo-600 text-white' : holiday ? 'text-red-600' : 'text-slate-700'}`}>\n          {date.getDate()}\n        </span>\n        {holiday && !today && <div className=\"w-1.5 h-1.5 bg-red-500 rounded-full\"></div>}\n      </div>\n      <div className=\"flex-1 space-y-1 overflow-y-auto\">\n        {schedules.map(schedule => <ScheduleItem key={schedule.id} schedule={schedule} onEdit={onEdit} />)}\n      </div>\n      <button onClick={onAdd} className=\"absolute bottom-1 right-1 w-6 h-6 flex items-center justify-center bg-slate-100 text-slate-400 rounded-full opacity-0 group-hover:opacity-100 hover:bg-indigo-100 hover:text-indigo-600 transition-opacity\">\n        <Plus className=\"w-4 h-4\" />\n      </button>\n    </div>\n  );\n});\n\nconst ScheduleItem = memo(({ schedule, onEdit }) => {\n  const shiftColors = {\n    1: 'border-yellow-500', // เวรปกติ\n    3: 'border-orange-500', // เวรวันหยุด\n    2: 'border-indigo-500', // เวรกลางคืน\n    4: 'border-indigo-500', // เวรกลางคืน\n    default: 'border-slate-400'\n  };\n  const borderColor = shiftColors[schedule.shift_type_id] || shiftColors.default;\n\n  return (\n    <div \n      onClick={() => onEdit(schedule)}\n      className={`p-1.5 rounded-md bg-slate-50 hover:bg-slate-100 cursor-pointer border-l-4 ${borderColor}`}\n    >\n      <p className=\"text-xs font-semibold text-slate-800 truncate\">{schedule.shift_type_name}</p>\n      <p className=\"text-xs text-slate-600 truncate\">{schedule.officer_names}</p>\n    </div>\n  );\n});\n\n\n\nconst ShiftWorkPage = () => {\n  const [currentDate, setCurrentDate] = useState(new Date());\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [selectedSchedule, setSelectedSchedule] = useState(null);\n  const [schedules, setSchedules] = useState([]);\n  const [officers, setOfficers] = useState([]);\n  const [shiftTypes, setShiftTypes] = useState([]);\n  const [units, setUnits] = useState([]);\n  const [holidays, setHolidays] = useState([]);\n  const [formData, setFormData] = useState({ duty_date: '', shift_type_id: '', unit_id: '', officer_ids: [], notes: '' });\n  const [filters, setFilters] = useState({ unit: '', officer: '' });\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [selectedShiftPeriod, setSelectedShiftPeriod] = useState('day');\n  const [selectedUnits, setSelectedUnits] = useState([]);\n  const [selectedOfficers, setSelectedOfficers] = useState([]);\n  const [showOfficerList, setShowOfficerList] = useState(false);\n  const [officerSearchTerm, setOfficerSearchTerm] = useState('');\n\n  useEffect(() => {\n    const loadHolidaysByYear = async () => {\n      try {\n        const response = await fetch(`${CONFIG.SCHEDULES_API}?action=get_holidays&year=${currentDate.getFullYear()}`);\n        const result = await response.json();\n        if (!result.success) throw new Error(result.message);\n        setHolidays(result.data);\n      } catch (error) {\n        console.error(\"ล้มเหลวในการดึงข้อมูลวันหยุด:\", error);\n      }\n    };\n\n    loadHolidaysByYear();\n  }, [currentDate]);\n  useEffect(() => {\n    if (selectedUnits.length > 0 && Array.isArray(officers)) {\n      const officersInSelectedUnits = officers\n        .filter(officer => officer.unit_id && selectedUnits.includes(officer.unit_id))\n        .map(officer => officer.id);\n\n      setSelectedOfficers(officersInSelectedUnits);\n    } else {\n      setSelectedOfficers([]);\n    }\n  }, [selectedUnits, officers]);\n\n  // --- ฟังก์ชันจัดการการเลือกส่วนงาน ---\n  const handleUnitSelect = (unitId) => {\n    setSelectedUnits(prev =>\n      prev.includes(unitId)\n        ? prev.filter(id => id !== unitId)\n        : [...prev, unitId]\n    );\n  };\n\n  // --- ฟังก์ชันจัดการการเลือกเจ้าหน้าที่ ---\n  const handleOfficerAdd = (officerId) => {\n    setSelectedOfficers(prev => [...prev, officerId]);\n  };\n\n  const handleOfficerRemove = (officerId) => {\n    setSelectedOfficers(prev => prev.filter(id => id !== officerId));\n  };\n\n  // --- ฟังก์ชันกรองเจ้าหน้าที่ที่ยังไม่ได้เลือก ---\n  const getAvailableOfficers = () => {\n    if (!Array.isArray(officers)) return [];\n\n    return officers.filter(officer =>\n      officer.unit_id !== null &&\n      (selectedUnits.length === 0 || selectedUnits.includes(officer.unit_id)) &&\n      !selectedOfficers.includes(officer.id) &&\n      (officerSearchTerm === '' ||\n        `${officer.firstname} ${officer.lastname}`.toLowerCase().includes(officerSearchTerm.toLowerCase()))\n    );\n  };\n\n  // --- ฟังก์ชันหาข้อมูลเจ้าหน้าที่ ---\n  const getOfficerById = (officerId) => {\n    return officers.find(o => o.id === officerId);\n  };\n\n  useEffect(() => {\n    loadInitialData();\n  }, []);\n\n  useEffect(() => {\n    loadSchedules();\n  }, [currentDate]);\n\n  const loadInitialData = async () => {\n    setLoading(true);\n    try {\n      await Promise.all([\n        loadOfficers(),\n        loadShiftTypes(),\n        loadUnits(),\n        loadHolidays(),\n        loadSchedules()\n      ]);\n    } catch (error) {\n      console.error('Error loading initial data:', error.message, error.stack);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadSchedules = async () => {\n    try {\n      const month = currentDate.getMonth() + 1;\n      const year = currentDate.getFullYear();\n      const response = await fetch(`${CONFIG.SCHEDULES_API}?action=get_all_schedules&month=${month}&year=${year}`);\n      const data = await response.json();\n      if (data.success) {\n        setSchedules(data.data);\n      } else {\n        console.error('Failed to fetch schedules:', data.message);\n      }\n    } catch (error) {\n      console.error('Error loading schedules:', error.message, error.stack);\n    }\n  };\n\n  const loadOfficers = async () => {\n    try {\n      const response = await fetch(`${CONFIG.OFFICERS_API}?action=get_all_officers`);\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      const data = await response.json();\n      if (data && data.success && Array.isArray(data.data)) {\n        setOfficers(data.data);\n      } else {\n        console.error('Failed to load officers:', data);\n        setOfficers([]);\n      }\n    } catch (error) {\n      console.error('Error loading officers:', error);\n      setOfficers([]);\n    }\n  };\n\n  const loadShiftTypes = async () => {\n    try {\n      const response = await fetch(`${CONFIG.SCHEDULES_API}?action=get_all_shifttypes`);\n      const data = await response.json();\n      if (Array.isArray(data)) {\n        setShiftTypes(data);\n      } else {\n        setShiftTypes([]);\n      }\n    } catch (error) {\n      console.error('Error loading shift types:', error);\n      setShiftTypes([]);\n    }\n  };\n\n  const loadUnits = async () => {\n      try {\n          const response = await fetch(`${CONFIG.SCHEDULES_API}?action=get_all_units`);\n    const data = await response.json();\n          if (Array.isArray(data)) {\n              setUnits(data);\n          } else {\n              setUnits([]);\n          }\n      } catch (error) {\n          console.error('Error loading units:', error);\n          setUnits([]);\n      }\n  };\n\n  const loadHolidays = async () => {\n      try {\n          const response = await fetch(`${CONFIG.SCHEDULES_API}?action=get_holidays`);\n    const data = await response.json();\n          if (Array.isArray(data)) {\n              setHolidays(data);\n          } else {\n              setHolidays([]);\n          }\n      } catch (error) {\n          console.error('Error loading holidays:', error);\n          setHolidays([]);\n      }\n  };\n\n  const navigateMonth = (direction) => {\n    setCurrentDate(prev => {\n      const newDate = new Date(prev);\n      newDate.setMonth(prev.getMonth() + direction);\n      return newDate;\n    });\n  };\n\n  const goToToday = () => {\n    setCurrentDate(new Date());\n  };\n\n  // --- แก้ไข openAddModal ---\n  const openAddModal = (date = null) => {\n    const dateObj = date || new Date();\n    const isHolidayDate = isHoliday(dateObj, holidays);\n\n    const suggestedType = getShiftTypeByPeriod('day', isHolidayDate, shiftTypes);\n    setSelectedShiftPeriod('day');\n    setSelectedUnits([]);\n    setSelectedOfficers([]);\n    setFormData({\n      duty_date: date ? date.toISOString().split('T')[0] : '',\n      shift_type_id: suggestedType?.id || '',\n      unit_id: '',\n      officer_ids: [],\n      notes: ''\n    });\n    setShowAddModal(true);\n  };\n\n  const openEditModal = (schedule) => {\n    setSelectedSchedule(schedule);\n    setFormData({\n      duty_date: schedule.duty_date,\n      shift_type_id: schedule.shift_type_id,\n      unit_id: schedule.unit_id || '',\n      officer_ids: schedule.officer_ids || [],\n      notes: schedule.notes || ''\n    });\n    setSelectedOfficers(schedule.officer_ids || []);\n    setShowEditModal(true);\n  };\n\n  const closeModals = () => {\n    setShowAddModal(false);\n    setShowEditModal(false);\n    setSelectedSchedule(null);\n    setSelectedShiftPeriod('day');\n    setSelectedUnits([]);\n    setSelectedOfficers([]);\n    setShowOfficerList(false);\n    setOfficerSearchTerm('');\n  };\n\n  const handleInputChange = (field, value) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n  };\n\n  const handleSave = async () => {\n    setSaving(true);\n    try {\n      // อัปเดต shift_type_id และ officer_ids ตาม UI ใหม่\n      const dateObj = new Date(formData.duty_date + 'T00:00:00');\n      const isHolidayDate = isHoliday(dateObj, holidays);\n      const shiftType = getShiftTypeByPeriod(selectedShiftPeriod, isHolidayDate, shiftTypes);\n\n      const payload = {\n        action: selectedSchedule ? 'update_schedule' : 'create_schedule',\n        ...formData,\n        shift_type_id: shiftType?.id || formData.shift_type_id,\n        officer_ids: selectedOfficers,\n        ...(selectedSchedule && { schedule_id: selectedSchedule.id })\n      };\n\n      const response = await fetch(CONFIG.SCHEDULES_API, {\n        method: 'POST', headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload)\n      });\n      const result = await response.json();\n      if (!result.success) throw new Error(result.message);\n      await loadSchedules();\n      closeModals();\n    } catch (error) {\n      console.error('Error saving schedule:', error);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!selectedSchedule || !window.confirm('คุณแน่ใจหรือไม่ที่จะลบตารางเวรนี้?')) return;\n    setSaving(true);\n    try {\n      const payload = { action: 'delete_schedule', schedule_id: selectedSchedule.id };\n      const response = await fetch(CONFIG.SCHEDULES_API, {\n        method: 'POST', headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload)\n      });\n      const result = await response.json();\n      if (!result.success) throw new Error(result.message);\n      await loadSchedules();\n      closeModals();\n    } catch (error) {\n      console.error('Error deleting schedule:', error);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const filteredSchedules = useMemo(() => {\n    return schedules.filter(schedule => {\n      const unitMatch = !filters.unit || schedule.unit_id === parseInt(filters.unit);\n      const officerMatch = !filters.officer ||\n        (schedule.officer_names && schedule.officer_names.toLowerCase().includes(filters.officer.toLowerCase()));\n      return unitMatch && officerMatch;\n    });\n  }, [schedules, filters]);\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-full\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full flex flex-col\">\n      <div className=\"flex-grow p-4 bg-slate-50/50 overflow-y-auto\">\n        <ShiftCalendarView\n          currentDate={currentDate}\n          schedules={filteredSchedules}\n          officers={officers}\n          shiftTypes={shiftTypes}\n          units={units}\n          holidays={holidays}\n          filters={filters}\n          setFilters={setFilters}\n          navigateMonth={navigateMonth}\n          goToToday={goToToday}\n          openAddModal={openAddModal}\n          openEditModal={openEditModal}\n        />\n      </div>\n\n      {(showAddModal || showEditModal) && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-3xl mx-4 max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6 border-b\">\n              <h3 className=\"text-lg font-semibold text-gray-900\">\n                {showEditModal ? 'แก้ไขตารางเวร' : 'เพิ่มตารางเวรใหม่'}\n              </h3>\n              {formData.duty_date && (\n                <p className=\"text-sm text-gray-600 mt-1\">\n                  วันที่ {new Date(formData.duty_date + 'T00:00:00').toLocaleDateString('th-TH')}\n                  {isHoliday(new Date(formData.duty_date + 'T00:00:00'), holidays) &&\n                    <span className=\"ml-2 px-2 py-0.5 bg-red-100 text-red-600 text-xs rounded-full\">วันหยุด</span>\n                  }\n                </p>\n              )}\n            </div>\n\n            <div className=\"p-6 space-y-6\">\n              {/* วันที่ */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">วันที่</label>\n                <input\n                  type=\"date\"\n                  value={formData.duty_date}\n                  onChange={(e) => {\n                    handleInputChange('duty_date', e.target.value);\n                    // อัปเดต shift type อัตโนมัติเมื่อเปลี่ยนวันที่\n                    const newDate = new Date(e.target.value + 'T00:00:00');\n                    const isHol = isHoliday(newDate, holidays);\n                    const suggestedType = getShiftTypeByPeriod(selectedShiftPeriod, isHol, shiftTypes);\n                    setFormData(prev => ({ ...prev, shift_type_id: suggestedType?.id || '' }));\n                  }}\n                  className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                />\n              </div>\n\n              {/* เลือกช่วงเวร */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-3\">ช่วงเวร</label>\n                <div className=\"flex space-x-3\">\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setSelectedShiftPeriod('day');\n                      const isHol = formData.duty_date ? isHoliday(new Date(formData.duty_date + 'T00:00:00'), holidays) : false;\n                                            const suggestedType = getShiftTypeByPeriod('day', isHol, shiftTypes);\n                                            setFormData(prev => ({ ...prev, shift_type_id: suggestedType?.id || '' }));\n                    }}\n                    className={`flex items-center px-4 py-2 rounded-lg border ${\n                        selectedShiftPeriod === 'day' \n                        ? 'bg-yellow-50 border-yellow-300 text-yellow-700'\n                        : 'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'\n                      }`}\n                  >\n                    <Sun className=\"w-4 h-4 mr-2\" />\n                    กลางวัน\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setSelectedShiftPeriod('night');\n                      const suggestedType = getShiftTypeByPeriod('night', false, shiftTypes);\n                      setFormData(prev => ({ ...prev, shift_type_id: suggestedType?.id || '' }));\n                    }}\n                    className={`flex items-center px-4 py-2 rounded-lg border ${\n                        selectedShiftPeriod === 'night' \n                        ? 'bg-indigo-50 border-indigo-300 text-indigo-700'\n                        : 'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'\n                      }`}\n                  >\n                    <Moon className=\"w-4 h-4 mr-2\" />\n                    กลางคืน\n                  </button>\n                </div>\n              </div>\n\n              {/* เลือกส่วนงาน (เช็คลิส) */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-3\">ส่วนงาน</label>\n                <div className=\"border border-gray-300 rounded-lg p-4 max-h-40 overflow-y-auto\">\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    {Array.isArray(units) && units.map(unit => (\n                      <label key={unit.id} className=\"flex items-center py-1\">\n                        <input\n                          type=\"checkbox\"\n                                    checked={selectedUnits.includes(unit.id)}\n                                    onChange={() => handleUnitSelect(unit.id)}\n                                    className=\"h-4 w-4 text-indigo-600\"\n                        />\n                        <span className=\"ml-2 text-sm text-gray-900\">{unit.unit_name}</span>\n                      </label>\n                    ))}\n                  </div>\n                </div>\n              </div>\n\n              {/* เจ้าหน้าที่ที่เลือกแล้ว */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-3\">เจ้าหน้าที่ที่เลือก</label>\n                <div className=\"border border-gray-300 rounded-lg p-3 min-h-[100px]\">\n                  {selectedOfficers.length === 0 ? (\n                    <p className=\"text-gray-500 text-sm\">ยังไม่ได้เลือกเจ้าหน้าที่</p>\n                  ) : (\n                    <div className=\"space-y-2\">\n                      {selectedOfficers.map(officerId => {\n                        const officer = getOfficerById(officerId);\n                        return officer ? (\n                          <div key={officerId} className=\"flex items-center justify-between bg-gray-50 px-3 py-2 rounded-lg\">\n                            <span className=\"text-sm\">{officer.prefix} {officer.firstname} {officer.lastname}</span>\n                            <button\n                              onClick={() => handleOfficerRemove(officerId)}\n                              className=\"text-red-600 hover:text-red-800\"\n                            >\n                              <X className=\"w-4 h-4\" />\n                            </button>\n                          </div>\n                        ) : null;\n                      })}\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* เพิ่มเจ้าหน้าที่ */}\n              <div>\n                <div className=\"flex items-center justify-between mb-3\">\n                  <label className=\"block text-sm font-medium text-gray-700\">จัดการเจ้าหน้าที่</label>\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowOfficerList(!showOfficerList)}\n                    className=\"text-sm text-indigo-600 hover:text-indigo-800\"\n                  >\n                    {showOfficerList ? 'ซ่อน' : 'เพิ่มเจ้าหน้าที่'}\n                  </button>\n                </div>\n\n                {showOfficerList && (\n                  <div className=\"border border-gray-300 rounded-lg p-3\">\n                    {/* ช่องค้นหา */}\n                    <div className=\"mb-3\">\n                      <div className=\"flex items-center space-x-2\">\n                        <Search className=\"w-4 h-4 text-gray-500\" />\n                        <input\n                          type=\"text\"\n                          placeholder=\"ค้นหาชื่อเจ้าหน้าที่...\"\n                          value={officerSearchTerm}\n                          onChange={(e) => setOfficerSearchTerm(e.target.value)}\n                          className=\"flex-1 border border-gray-300 rounded px-2 py-1 text-sm\"\n                        />\n                      </div>\n                    </div>\n\n                    {/* รายชื่อเจ้าหน้าที่ */}\n                    <div className=\"max-h-40 overflow-y-auto\">\n                      {getAvailableOfficers().length === 0 ? (\n                        <p className=\"text-gray-500 text-sm\">\n                          {selectedUnits.length === 0 ? 'กรุณาเลือกส่วนงานก่อน' :\n                            officerSearchTerm ? 'ไม่พบเจ้าหน้าที่ที่ค้นหา' : 'ไม่มีเจ้าหน้าที่ที่สามารถเลือกได้'}\n                                        </p>\n                      ) : (\n                        <div className=\"space-y-1\">\n                          {getAvailableOfficers().map(officer => (\n                            <div key={officer.id} className=\"flex items-center justify-between py-2 hover:bg-gray-50 px-2 rounded\">\n                              <span className=\"text-sm\">{officer.prefix} {officer.firstname} {officer.lastname}</span>\n                              <button\n                                onClick={() => {\n                                  handleOfficerAdd(officer.id);\n                                  setOfficerSearchTerm(''); // ล้างค่าค้นหาหลังเพิ่ม\n                                }}\n                                className=\"text-indigo-600 hover:text-indigo-800 p-1 rounded hover:bg-indigo-50\"\n                              >\n                                <Plus className=\"w-4 h-4\" />\n                              </button>\n                            </div>\n                          ))}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* หมายเหตุ */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">หมายเหตุ</label>\n                <textarea\n                  value={formData.notes}\n                  onChange={(e) => handleInputChange('notes', e.target.value)}\n                  rows={3}\n                  className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                  placeholder=\"รายละเอียดเพิ่มเติม...\"\n                />\n              </div>\n            </div>\n\n            <div className=\"p-6 border-t bg-gray-50 flex justify-between\">\n              <div>\n                {showEditModal && (\n                  <button\n                    onClick={handleDelete}\n                    disabled={saving}\n                    className=\"inline-flex items-center px-4 py-2 border border-red-300 text-sm font-medium rounded-lg text-red-700 bg-red-50 hover:bg-red-100\"\n                  >\n                    <Trash2 className=\"w-4 h-4 mr-2\" />ลบเวร\n                  </button>\n                )}\n              </div>\n              <div className=\"flex space-x-3\">\n                <button\n                  onClick={closeModals}\n                  disabled={saving}\n                  className=\"px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50\"\n                >\n                  ยกเลิก\n                </button>\n                <button\n                  onClick={handleSave}\n                  disabled={saving || selectedOfficers.length === 0}\n                  className=\"inline-flex items-center px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  {saving ? (\n                    <>\n                      <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                      กำลังบันทึก...\n                    </>\n                  ) : (\n                    <>\n                      <Save className=\"w-4 h-4 mr-2\" />บันทึก\n                    </>\n                  )}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ShiftWorkPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}