{"ast":null,"code":"import _objectSpread from\"C:/Users/LENOVO/Documents/GitHub/court-marshal-connect/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useMemo}from'react';import{Calendar,Shield,List,Grid}from'lucide-react';import{CONFIG}from'../../config';import UnitStructureManagement from'../UnitStructure/UnitStructureManagement';import ShiftCalendarView from'./ShiftCalendarView';import ShiftListView from'./ShiftListView';import DutyScheduleModal from'./DutyScheduleModal';import AlertSystem from'./AlertSystem';// ฟังก์ชันตรวจสอบวันหยุด\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const isHoliday=function(date){let holidays=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];const dayOfWeek=date.getDay();if(dayOfWeek===0||dayOfWeek===6)return true;const isSameDay=(date1,date2)=>date1.toDateString()===date2.toDateString();return holidays.some(holiday=>isSameDay(new Date(holiday.date+'T00:00:00'),date));};const ShiftWorkPage=()=>{// State for tabs\nconst[activeTab,setActiveTab]=useState('shifts');// State for view mode\nconst[viewMode,setViewMode]=useState('calendar');// 'calendar' or 'list'\n// State for calendar\nconst[currentDate,setCurrentDate]=useState(new Date());// State for modals\nconst[showAddModal,setShowAddModal]=useState(false);const[showEditModal,setShowEditModal]=useState(false);const[selectedSchedule,setSelectedSchedule]=useState(null);// State for data\nconst[schedules,setSchedules]=useState([]);const[officers,setOfficers]=useState([]);const[units,setUnits]=useState([]);const[holidays,setHolidays]=useState([]);// State for form\nconst[formData,setFormData]=useState({duty_date:'',position_number:'',shift_type:'day',day_type:'normal'});// State for filters\nconst[filters,setFilters]=useState({unit:'',officer:''});// State for loading and saving\nconst[loading,setLoading]=useState(true);const[saving,setSaving]=useState(false);// State for shift selection\nconst[selectedShiftPeriod,setSelectedShiftPeriod]=useState('day');const[selectedUnits,setSelectedUnits]=useState([]);const[selectedHeadUnit,setSelectedHeadUnit]=useState('');const[availableOfficers,setAvailableOfficers]=useState([]);const[manualAddedOfficers,setManualAddedOfficers]=useState([]);const[removedPositions,setRemovedPositions]=useState([]);const[manualSearch,setManualSearch]=useState('');// State for alerts\nconst[alert,setAlert]=useState({show:false,message:'',type:'info'});// ฟังก์ชันแสดง Alert\nconst showAlert=function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'info';setAlert({show:true,message,type});setTimeout(()=>setAlert({show:false,message:'',type:'info'}),5000);};// Auto-select officers from selected units\nuseEffect(()=>{if(selectedUnits.length>0&&Array.isArray(officers)){console.log('Selected units:',selectedUnits);console.log('Officers sample:',officers.slice(0,3));const available=officers.filter(officer=>{const hasUnitCode=officer.unit_code&&selectedUnits.includes(officer.unit_code);if(hasUnitCode){console.log('Matched officer:',officer.firstname,officer.lastname,'Unit:',officer.unit_code);}return hasUnitCode;});console.log('Available officers after filter:',available.length);setAvailableOfficers(available);}else{setAvailableOfficers([]);}},[selectedUnits,officers]);useEffect(()=>{loadInitialData();},[]);useEffect(()=>{loadSchedules();},[currentDate]);const loadInitialData=async()=>{setLoading(true);try{await Promise.all([loadOfficers(),loadUnits(),loadHolidays(),loadSchedules()]);}catch(error){console.error('Error loading initial data:',error);showAlert('เกิดข้อผิดพลาดในการโหลดข้อมูล','error');}finally{setLoading(false);}};const loadSchedules=async()=>{try{// ใช้ local date เพื่อป้องกัน timezone offset\nconst startDateObj=new Date(currentDate.getFullYear(),currentDate.getMonth(),1);const endDateObj=new Date(currentDate.getFullYear(),currentDate.getMonth()+1,0);const startDate=\"\".concat(startDateObj.getFullYear(),\"-\").concat(String(startDateObj.getMonth()+1).padStart(2,'0'),\"-\").concat(String(startDateObj.getDate()).padStart(2,'0'));const endDate=\"\".concat(endDateObj.getFullYear(),\"-\").concat(String(endDateObj.getMonth()+1).padStart(2,'0'),\"-\").concat(String(endDateObj.getDate()).padStart(2,'0'));const response=await fetch(\"\".concat(CONFIG.DUTY_SCHEDULE_API,\"?start_date=\").concat(startDate,\"&end_date=\").concat(endDate));const data=await response.json();if(data.success&&Array.isArray(data.data)){// แน่ใจว่าโหลด officers เสร็จแล้ว\nlet currentOfficers=officers;if(!Array.isArray(currentOfficers)||currentOfficers.length===0){await loadOfficers();// ใช้ fresh data หลังจาก loadOfficers เสร็จ\nconst freshOfficersResponse=await fetch(\"\".concat(CONFIG.UNIT_STRUCTURE_API));const freshOfficersData=await freshOfficersResponse.json();currentOfficers=freshOfficersData.success?freshOfficersData.data:[];}console.log('Current officers for mapping:',currentOfficers.length,'officers loaded');const officerMap=new Map((currentOfficers||[]).map(o=>[String(o.position_number),o]));const enriched=data.data.map(s=>{var _s$position_number;const posKey=s.position_number||s.officer_id||((_s$position_number=s.position_number)===null||_s$position_number===void 0?void 0:_s$position_number.toString());const officer=officerMap.get(String(posKey));const officerName=officer?\"\".concat(officer.prefix?officer.prefix+' ':'').concat(officer.firstname||'',\" \").concat(officer.lastname||'').trim():s.officer_name||null;return _objectSpread(_objectSpread({},s),{},{officer_name:officerName,officer_unit_code:officer?officer.unit_code:s.officer_unit_code||null,officer_unit_name:officer?officer.unit_name:s.officer_unit_name||null,position_number:s.position_number||s.officer_id||null});});setSchedules(enriched);}else{console.error('Failed to fetch schedules:',data&&data.message);showAlert('ไม่สามารถโหลดข้อมูลตารางเวรได้','error');}}catch(error){console.error('Error loading schedules:',error);showAlert('เกิดข้อผิดพลาดในการโหลดตารางเวร','error');}};const loadOfficers=async()=>{try{const response=await fetch(\"\".concat(CONFIG.UNIT_STRUCTURE_API));if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();if(data&&data.success&&Array.isArray(data.data)){setOfficers(data.data);}else{console.error('Failed to load officers:',data);setOfficers([]);}}catch(error){console.error('Error loading officers:',error);setOfficers([]);}};const loadUnits=async()=>{try{const response=await fetch(\"\".concat(CONFIG.UNIT_STRUCTURE_API,\"/duty-units\"));if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();if(data&&data.success&&Array.isArray(data.data)){setUnits(data.data);}else{console.error('Failed to load units:',data);setUnits([]);}}catch(error){console.error('Error loading units:',error);setUnits([]);}};const loadHolidays=async()=>{try{// For now, we'll use a simple weekend check\n// You can implement a real holiday API later\nsetHolidays([]);}catch(error){console.error('Error loading holidays:',error);setHolidays([]);}};const navigateMonth=direction=>{setCurrentDate(prev=>{const newDate=new Date(prev);newDate.setMonth(newDate.getMonth()+direction);return newDate;});};const goToToday=()=>{setCurrentDate(new Date());};const openAddModal=function(){let date=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(date){// ใช้ local date แทน ISO string เพื่อป้องกัน timezone offset\nconst year=date.getFullYear();const month=String(date.getMonth()+1).padStart(2,'0');const day=String(date.getDate()).padStart(2,'0');const dateStr=\"\".concat(year,\"-\").concat(month,\"-\").concat(day);setFormData({duty_date:dateStr,position_number:'',shift_type:'day',day_type:isHoliday(date,holidays)?'holiday':'normal'});}setSelectedSchedule(null);setSelectedShiftPeriod('day');setSelectedUnits([]);setSelectedHeadUnit('');setAvailableOfficers([]);setManualAddedOfficers([]);setRemovedPositions([]);setShowAddModal(true);};const openEditModal=schedule=>{setSelectedSchedule(schedule);setFormData({duty_date:schedule.duty_date,position_number:schedule.position_number,shift_type:schedule.shift_type,day_type:schedule.day_type});setSelectedShiftPeriod(schedule.shift_type||'day');setShowEditModal(true);};const closeModals=()=>{setShowAddModal(false);setShowEditModal(false);setSelectedSchedule(null);setSelectedShiftPeriod('day');setSelectedUnits([]);setSelectedHeadUnit('');setAvailableOfficers([]);setManualAddedOfficers([]);setRemovedPositions([]);};const handleSave=async()=>{setSaving(true);try{const combined=[];const mapPos=new Map();(availableOfficers||[]).forEach(o=>mapPos.set(String(o.position_number),o));(manualAddedOfficers||[]).forEach(o=>mapPos.set(String(o.position_number),o));for(const[pos,off]of mapPos.entries()){if(!removedPositions.includes(pos))combined.push(off);}if(!formData.duty_date||combined.length===0){showAlert('กรุณาระบุวันที่และเลือกเจ้าหน้าที่อย่างน้อย 1 คน','error');return;}if(!selectedHeadUnit){showAlert('กรุณาเลือกหน่วยงานหลักที่เป็นหัวหน้าเวร','error');return;}const promises=combined.map(async officer=>{const pos=officer.position_number||officer.officer_id||officer.id;const posNumber=Number(pos);const payload={duty_date:formData.duty_date,position_number:Number.isInteger(posNumber)?posNumber:pos,unit_code:officer.unit_code||selectedHeadUnit,shift_type:selectedShiftPeriod,day_type:isHoliday(new Date(formData.duty_date+'T00:00:00'),holidays)?'holiday':'normal'};console.log('Payload being sent:',payload);const url=selectedSchedule?\"\".concat(CONFIG.DUTY_SCHEDULE_API,\"/\").concat(selectedSchedule.duty_id):CONFIG.DUTY_SCHEDULE_API;const method=selectedSchedule?'PUT':'POST';const response=await fetch(url,{method,headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});const result=await response.json();if(!result.success){throw new Error(result.message||'เกิดข้อผิดพลาดในการบันทึก');}return result;});await Promise.all(promises);showAlert('บันทึกตารางเวรสำเร็จ','success');await loadSchedules();closeModals();}catch(error){console.error('Error saving schedule:',error);showAlert(error.message||'เกิดข้อผิดพลาดในการบันทึก','error');}finally{setSaving(false);}};const handleDelete=async()=>{if(!selectedSchedule||!window.confirm('คุณแน่ใจหรือไม่ที่จะลบตารางเวรนี้?'))return;setSaving(true);try{const response=await fetch(\"\".concat(CONFIG.DUTY_SCHEDULE_API,\"/\").concat(selectedSchedule.duty_id),{method:'DELETE'});const result=await response.json();if(!result.success){throw new Error(result.message||'เกิดข้อผิดพลาดในการลบ');}showAlert('ลบตารางเวรสำเร็จ','success');await loadSchedules();closeModals();}catch(error){console.error('Error deleting schedule:',error);showAlert(error.message||'เกิดข้อผิดพลาดในการลบ','error');}finally{setSaving(false);}};const handleDeleteFromList=async schedule=>{if(!window.confirm('คุณแน่ใจหรือไม่ที่จะลบตารางเวรนี้?'))return;setSaving(true);try{const response=await fetch(\"\".concat(CONFIG.DUTY_SCHEDULE_API,\"/\").concat(schedule.duty_id),{method:'DELETE'});const result=await response.json();if(!result.success){throw new Error(result.message||'เกิดข้อผิดพลาดในการลบ');}showAlert('ลบตารางเวรสำเร็จ','success');await loadSchedules();}catch(error){console.error('Error deleting schedule:',error);showAlert(error.message||'เกิดข้อผิดพลาดในการลบ','error');}finally{setSaving(false);}};const filteredSchedules=useMemo(()=>{let filtered=schedules;if(filters.unit){filtered=filtered.filter(schedule=>schedule.officer_unit_code===filters.unit||schedule.unit_code===filters.unit);}if(filters.officer){filtered=filtered.filter(schedule=>schedule.officer_name&&schedule.officer_name.toLowerCase().includes(filters.officer.toLowerCase()));}return filtered;},[schedules,filters]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-full\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"h-full flex flex-col\",children:[/*#__PURE__*/_jsx(AlertSystem,{alert:alert,onClose:()=>setAlert({show:false,message:'',type:'info'})}),/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-slate-200 bg-white\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-8 px-6\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('shifts'),className:\"flex items-center py-4 px-2 border-b-2 text-sm font-medium \".concat(activeTab==='shifts'?'border-indigo-500 text-indigo-600':'border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300'),children:[/*#__PURE__*/_jsx(Calendar,{className:\"w-5 h-5 mr-2\"}),\"\\u0E15\\u0E32\\u0E23\\u0E32\\u0E07\\u0E40\\u0E27\\u0E23\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('officers'),className:\"flex items-center py-4 px-2 border-b-2 text-sm font-medium \".concat(activeTab==='officers'?'border-indigo-500 text-indigo-600':'border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300'),children:[/*#__PURE__*/_jsx(Shield,{className:\"w-5 h-5 mr-2\"}),\"\\u0E08\\u0E31\\u0E14\\u0E01\\u0E32\\u0E23\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48\\u0E41\\u0E25\\u0E30\\u0E42\\u0E04\\u0E23\\u0E07\\u0E2A\\u0E23\\u0E49\\u0E32\\u0E07\"]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-hidden\",children:[activeTab==='shifts'&&/*#__PURE__*/_jsxs(\"div\",{className:\"h-full flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border-b border-slate-200 px-6 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-lg font-semibold text-slate-900\",children:[\"\\u0E15\\u0E32\\u0E23\\u0E32\\u0E07\\u0E40\\u0E27\\u0E23 - \",currentDate.toLocaleDateString('th-TH',{month:'long',year:'numeric'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center bg-slate-100 rounded-lg p-1\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setViewMode('calendar'),className:\"flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors \".concat(viewMode==='calendar'?'bg-white text-slate-900 shadow-sm':'text-slate-600 hover:text-slate-900'),children:[/*#__PURE__*/_jsx(Grid,{className:\"w-4 h-4 mr-2\"}),\"\\u0E1B\\u0E0F\\u0E34\\u0E17\\u0E34\\u0E19\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setViewMode('list'),className:\"flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors \".concat(viewMode==='list'?'bg-white text-slate-900 shadow-sm':'text-slate-600 hover:text-slate-900'),children:[/*#__PURE__*/_jsx(List,{className:\"w-4 h-4 mr-2\"}),\"\\u0E23\\u0E32\\u0E22\\u0E01\\u0E32\\u0E23\"]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 overflow-hidden p-6\",children:viewMode==='calendar'?/*#__PURE__*/_jsx(ShiftCalendarView,{currentDate:currentDate,schedules:filteredSchedules,officers:officers,units:units,holidays:holidays,filters:filters,setFilters:setFilters,navigateMonth:navigateMonth,goToToday:goToToday,openAddModal:openAddModal,openEditModal:openEditModal}):/*#__PURE__*/_jsx(ShiftListView,{currentDate:currentDate,schedules:filteredSchedules,onEdit:openEditModal,onDelete:handleDeleteFromList})})]}),activeTab==='officers'&&/*#__PURE__*/_jsx(UnitStructureManagement,{})]}),/*#__PURE__*/_jsx(DutyScheduleModal,{showModal:showAddModal||showEditModal,isEditMode:showEditModal,formData:formData,setFormData:setFormData,selectedShiftPeriod:selectedShiftPeriod,setSelectedShiftPeriod:setSelectedShiftPeriod,selectedUnits:selectedUnits,setSelectedUnits:setSelectedUnits,selectedHeadUnit:selectedHeadUnit,setSelectedHeadUnit:setSelectedHeadUnit,availableOfficers:availableOfficers,manualAddedOfficers:manualAddedOfficers,setManualAddedOfficers:setManualAddedOfficers,removedPositions:removedPositions,setRemovedPositions:setRemovedPositions,manualSearch:manualSearch,setManualSearch:setManualSearch,units:units,officers:officers,holidays:holidays,saving:saving,onClose:closeModals,onSave:handleSave,onDelete:handleDelete,showAlert:showAlert})]});};export default ShiftWorkPage;","map":{"version":3,"names":["React","useState","useEffect","useMemo","Calendar","Shield","List","Grid","CONFIG","UnitStructureManagement","ShiftCalendarView","ShiftListView","DutyScheduleModal","AlertSystem","jsx","_jsx","jsxs","_jsxs","isHoliday","date","holidays","arguments","length","undefined","dayOfWeek","getDay","isSameDay","date1","date2","toDateString","some","holiday","Date","ShiftWorkPage","activeTab","setActiveTab","viewMode","setViewMode","currentDate","setCurrentDate","showAddModal","setShowAddModal","showEditModal","setShowEditModal","selectedSchedule","setSelectedSchedule","schedules","setSchedules","officers","setOfficers","units","setUnits","setHolidays","formData","setFormData","duty_date","position_number","shift_type","day_type","filters","setFilters","unit","officer","loading","setLoading","saving","setSaving","selectedShiftPeriod","setSelectedShiftPeriod","selectedUnits","setSelectedUnits","selectedHeadUnit","setSelectedHeadUnit","availableOfficers","setAvailableOfficers","manualAddedOfficers","setManualAddedOfficers","removedPositions","setRemovedPositions","manualSearch","setManualSearch","alert","setAlert","show","message","type","showAlert","setTimeout","Array","isArray","console","log","slice","available","filter","hasUnitCode","unit_code","includes","firstname","lastname","loadInitialData","loadSchedules","Promise","all","loadOfficers","loadUnits","loadHolidays","error","startDateObj","getFullYear","getMonth","endDateObj","startDate","concat","String","padStart","getDate","endDate","response","fetch","DUTY_SCHEDULE_API","data","json","success","currentOfficers","freshOfficersResponse","UNIT_STRUCTURE_API","freshOfficersData","officerMap","Map","map","o","enriched","s","_s$position_number","posKey","officer_id","toString","get","officerName","prefix","trim","officer_name","_objectSpread","officer_unit_code","officer_unit_name","unit_name","ok","Error","status","navigateMonth","direction","prev","newDate","setMonth","goToToday","openAddModal","year","month","day","dateStr","openEditModal","schedule","closeModals","handleSave","combined","mapPos","forEach","set","pos","off","entries","push","promises","id","posNumber","Number","payload","isInteger","url","duty_id","method","headers","body","JSON","stringify","result","handleDelete","window","confirm","handleDeleteFromList","filteredSchedules","filtered","toLowerCase","className","children","onClose","onClick","toLocaleDateString","onEdit","onDelete","showModal","isEditMode","onSave"],"sources":["C:/Users/LENOVO/Documents/GitHub/court-marshal-connect/src/components/ShiftWork/ShiftWorkPageNew.js"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\r\nimport { Calendar, Shield, List, Grid } from 'lucide-react';\r\nimport { CONFIG } from '../../config';\r\nimport UnitStructureManagement from '../UnitStructure/UnitStructureManagement';\r\nimport ShiftCalendarView from './ShiftCalendarView';\r\nimport ShiftListView from './ShiftListView';\r\nimport DutyScheduleModal from './DutyScheduleModal';\r\nimport AlertSystem from './AlertSystem';\r\n\r\n// ฟังก์ชันตรวจสอบวันหยุด\r\nconst isHoliday = (date, holidays = []) => {\r\n  const dayOfWeek = date.getDay();\r\n  if (dayOfWeek === 0 || dayOfWeek === 6) return true;\r\n  const isSameDay = (date1, date2) => date1.toDateString() === date2.toDateString();\r\n  return holidays.some(holiday => isSameDay(new Date(holiday.date + 'T00:00:00'), date));\r\n};\r\n\r\nconst ShiftWorkPage = () => {\r\n  // State for tabs\r\n  const [activeTab, setActiveTab] = useState('shifts');\r\n  \r\n  // State for view mode\r\n  const [viewMode, setViewMode] = useState('calendar'); // 'calendar' or 'list'\r\n  \r\n  // State for calendar\r\n  const [currentDate, setCurrentDate] = useState(new Date());\r\n  \r\n  // State for modals\r\n  const [showAddModal, setShowAddModal] = useState(false);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [selectedSchedule, setSelectedSchedule] = useState(null);\r\n  \r\n  // State for data\r\n  const [schedules, setSchedules] = useState([]);\r\n  const [officers, setOfficers] = useState([]);\r\n  const [units, setUnits] = useState([]);\r\n  const [holidays, setHolidays] = useState([]);\r\n  \r\n  // State for form\r\n  const [formData, setFormData] = useState({\r\n    duty_date: '',\r\n    position_number: '',\r\n    shift_type: 'day',\r\n    day_type: 'normal'\r\n  });\r\n  \r\n  // State for filters\r\n  const [filters, setFilters] = useState({ unit: '', officer: '' });\r\n  \r\n  // State for loading and saving\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  \r\n  // State for shift selection\r\n  const [selectedShiftPeriod, setSelectedShiftPeriod] = useState('day');\r\n  const [selectedUnits, setSelectedUnits] = useState([]);\r\n  const [selectedHeadUnit, setSelectedHeadUnit] = useState('');\r\n  const [availableOfficers, setAvailableOfficers] = useState([]);\r\n  const [manualAddedOfficers, setManualAddedOfficers] = useState([]);\r\n  const [removedPositions, setRemovedPositions] = useState([]);\r\n  const [manualSearch, setManualSearch] = useState('');\r\n  \r\n  // State for alerts\r\n  const [alert, setAlert] = useState({ show: false, message: '', type: 'info' });\r\n\r\n  // ฟังก์ชันแสดง Alert\r\n  const showAlert = (message, type = 'info') => {\r\n    setAlert({ show: true, message, type });\r\n    setTimeout(() => setAlert({ show: false, message: '', type: 'info' }), 5000);\r\n  };\r\n\r\n  // Auto-select officers from selected units\r\n  useEffect(() => {\r\n    if (selectedUnits.length > 0 && Array.isArray(officers)) {\r\n      console.log('Selected units:', selectedUnits);\r\n      console.log('Officers sample:', officers.slice(0, 3));\r\n      \r\n      const available = officers.filter(officer => {\r\n        const hasUnitCode = officer.unit_code && selectedUnits.includes(officer.unit_code);\r\n        if (hasUnitCode) {\r\n          console.log('Matched officer:', officer.firstname, officer.lastname, 'Unit:', officer.unit_code);\r\n        }\r\n        return hasUnitCode;\r\n      });\r\n      \r\n      console.log('Available officers after filter:', available.length);\r\n      setAvailableOfficers(available);\r\n    } else {\r\n      setAvailableOfficers([]);\r\n    }\r\n  }, [selectedUnits, officers]);\r\n\r\n  useEffect(() => {\r\n    loadInitialData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    loadSchedules();\r\n  }, [currentDate]);\r\n\r\n  const loadInitialData = async () => {\r\n    setLoading(true);\r\n    try {\r\n      await Promise.all([\r\n        loadOfficers(),\r\n        loadUnits(),\r\n        loadHolidays(),\r\n        loadSchedules()\r\n      ]);\r\n    } catch (error) {\r\n      console.error('Error loading initial data:', error);\r\n      showAlert('เกิดข้อผิดพลาดในการโหลดข้อมูล', 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadSchedules = async () => {\r\n    try {\r\n      // ใช้ local date เพื่อป้องกัน timezone offset\r\n      const startDateObj = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);\r\n      const endDateObj = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);\r\n      \r\n      const startDate = `${startDateObj.getFullYear()}-${String(startDateObj.getMonth() + 1).padStart(2, '0')}-${String(startDateObj.getDate()).padStart(2, '0')}`;\r\n      const endDate = `${endDateObj.getFullYear()}-${String(endDateObj.getMonth() + 1).padStart(2, '0')}-${String(endDateObj.getDate()).padStart(2, '0')}`;\r\n      \r\n      const response = await fetch(`${CONFIG.DUTY_SCHEDULE_API}?start_date=${startDate}&end_date=${endDate}`);\r\n      const data = await response.json();\r\n\r\n      if (data.success && Array.isArray(data.data)) {\r\n        // แน่ใจว่าโหลด officers เสร็จแล้ว\r\n        let currentOfficers = officers;\r\n        if (!Array.isArray(currentOfficers) || currentOfficers.length === 0) {\r\n          await loadOfficers();\r\n          // ใช้ fresh data หลังจาก loadOfficers เสร็จ\r\n          const freshOfficersResponse = await fetch(`${CONFIG.UNIT_STRUCTURE_API}`);\r\n          const freshOfficersData = await freshOfficersResponse.json();\r\n          currentOfficers = freshOfficersData.success ? freshOfficersData.data : [];\r\n        }\r\n\r\n        console.log('Current officers for mapping:', currentOfficers.length, 'officers loaded');\r\n\r\n        const officerMap = new Map((currentOfficers || []).map(o => [String(o.position_number), o]));\r\n\r\n        const enriched = data.data.map(s => {\r\n          const posKey = s.position_number || s.officer_id || s.position_number?.toString();\r\n          const officer = officerMap.get(String(posKey));\r\n          const officerName = officer ? `${officer.prefix ? officer.prefix + ' ' : ''}${officer.firstname || ''} ${officer.lastname || ''}`.trim() : (s.officer_name || null);\r\n          \r\n          return {\r\n            ...s,\r\n            officer_name: officerName,\r\n            officer_unit_code: officer ? officer.unit_code : (s.officer_unit_code || null),\r\n            officer_unit_name: officer ? officer.unit_name : (s.officer_unit_name || null),\r\n            position_number: s.position_number || s.officer_id || null\r\n          };\r\n        });\r\n\r\n        setSchedules(enriched);\r\n      } else {\r\n        console.error('Failed to fetch schedules:', data && data.message);\r\n        showAlert('ไม่สามารถโหลดข้อมูลตารางเวรได้', 'error');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading schedules:', error);\r\n      showAlert('เกิดข้อผิดพลาดในการโหลดตารางเวร', 'error');\r\n    }\r\n  };\r\n\r\n  const loadOfficers = async () => {\r\n    try {\r\n      const response = await fetch(`${CONFIG.UNIT_STRUCTURE_API}`);\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n      const data = await response.json();\r\n      if (data && data.success && Array.isArray(data.data)) {\r\n        setOfficers(data.data);\r\n      } else {\r\n        console.error('Failed to load officers:', data);\r\n        setOfficers([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading officers:', error);\r\n      setOfficers([]);\r\n    }\r\n  };\r\n\r\n  const loadUnits = async () => {\r\n    try {\r\n      const response = await fetch(`${CONFIG.UNIT_STRUCTURE_API}/duty-units`);\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n      const data = await response.json();\r\n      if (data && data.success && Array.isArray(data.data)) {\r\n        setUnits(data.data);\r\n      } else {\r\n        console.error('Failed to load units:', data);\r\n        setUnits([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading units:', error);\r\n      setUnits([]);\r\n    }\r\n  };\r\n\r\n  const loadHolidays = async () => {\r\n    try {\r\n      // For now, we'll use a simple weekend check\r\n      // You can implement a real holiday API later\r\n      setHolidays([]);\r\n    } catch (error) {\r\n      console.error('Error loading holidays:', error);\r\n      setHolidays([]);\r\n    }\r\n  };\r\n\r\n  const navigateMonth = (direction) => {\r\n    setCurrentDate(prev => {\r\n      const newDate = new Date(prev);\r\n      newDate.setMonth(newDate.getMonth() + direction);\r\n      return newDate;\r\n    });\r\n  };\r\n\r\n  const goToToday = () => {\r\n    setCurrentDate(new Date());\r\n  };\r\n\r\n  const openAddModal = (date = null) => {\r\n    if (date) {\r\n      // ใช้ local date แทน ISO string เพื่อป้องกัน timezone offset\r\n      const year = date.getFullYear();\r\n      const month = String(date.getMonth() + 1).padStart(2, '0');\r\n      const day = String(date.getDate()).padStart(2, '0');\r\n      const dateStr = `${year}-${month}-${day}`;\r\n      \r\n      setFormData({\r\n        duty_date: dateStr,\r\n        position_number: '',\r\n        shift_type: 'day',\r\n        day_type: isHoliday(date, holidays) ? 'holiday' : 'normal'\r\n      });\r\n    }\r\n    setSelectedSchedule(null);\r\n    setSelectedShiftPeriod('day');\r\n    setSelectedUnits([]);\r\n    setSelectedHeadUnit('');\r\n    setAvailableOfficers([]);\r\n    setManualAddedOfficers([]);\r\n    setRemovedPositions([]);\r\n    setShowAddModal(true);\r\n  };\r\n\r\n  const openEditModal = (schedule) => {\r\n    setSelectedSchedule(schedule);\r\n    setFormData({\r\n      duty_date: schedule.duty_date,\r\n      position_number: schedule.position_number,\r\n      shift_type: schedule.shift_type,\r\n      day_type: schedule.day_type\r\n    });\r\n    setSelectedShiftPeriod(schedule.shift_type || 'day');\r\n    setShowEditModal(true);\r\n  };\r\n\r\n  const closeModals = () => {\r\n    setShowAddModal(false);\r\n    setShowEditModal(false);\r\n    setSelectedSchedule(null);\r\n    setSelectedShiftPeriod('day');\r\n    setSelectedUnits([]);\r\n    setSelectedHeadUnit('');\r\n    setAvailableOfficers([]);\r\n    setManualAddedOfficers([]);\r\n    setRemovedPositions([]);\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    setSaving(true);\r\n    try {\r\n      const combined = [];\r\n      const mapPos = new Map();\r\n      (availableOfficers || []).forEach(o => mapPos.set(String(o.position_number), o));\r\n      (manualAddedOfficers || []).forEach(o => mapPos.set(String(o.position_number), o));\r\n      for (const [pos, off] of mapPos.entries()) {\r\n        if (!removedPositions.includes(pos)) combined.push(off);\r\n      }\r\n\r\n      if (!formData.duty_date || combined.length === 0) {\r\n        showAlert('กรุณาระบุวันที่และเลือกเจ้าหน้าที่อย่างน้อย 1 คน', 'error');\r\n        return;\r\n      }\r\n\r\n      if (!selectedHeadUnit) {\r\n        showAlert('กรุณาเลือกหน่วยงานหลักที่เป็นหัวหน้าเวร', 'error');\r\n        return;\r\n      }\r\n\r\n      const promises = combined.map(async (officer) => {\r\n        const pos = officer.position_number || officer.officer_id || officer.id;\r\n        const posNumber = Number(pos);\r\n        const payload = {\r\n          duty_date: formData.duty_date,\r\n          position_number: Number.isInteger(posNumber) ? posNumber : pos,\r\n          unit_code: officer.unit_code || selectedHeadUnit,\r\n          shift_type: selectedShiftPeriod,\r\n          day_type: isHoliday(new Date(formData.duty_date + 'T00:00:00'), holidays) ? 'holiday' : 'normal'\r\n        };\r\n\r\n        console.log('Payload being sent:', payload);\r\n\r\n        const url = selectedSchedule ? `${CONFIG.DUTY_SCHEDULE_API}/${selectedSchedule.duty_id}` : CONFIG.DUTY_SCHEDULE_API;\r\n        const method = selectedSchedule ? 'PUT' : 'POST';\r\n\r\n        const response = await fetch(url, {\r\n          method,\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(payload)\r\n        });\r\n\r\n        const result = await response.json();\r\n        if (!result.success) {\r\n          throw new Error(result.message || 'เกิดข้อผิดพลาดในการบันทึก');\r\n        }\r\n        return result;\r\n      });\r\n\r\n      await Promise.all(promises);\r\n      showAlert('บันทึกตารางเวรสำเร็จ', 'success');\r\n      await loadSchedules();\r\n      closeModals();\r\n    } catch (error) {\r\n      console.error('Error saving schedule:', error);\r\n      showAlert(error.message || 'เกิดข้อผิดพลาดในการบันทึก', 'error');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!selectedSchedule || !window.confirm('คุณแน่ใจหรือไม่ที่จะลบตารางเวรนี้?')) return;\r\n    setSaving(true);\r\n    try {\r\n      const response = await fetch(`${CONFIG.DUTY_SCHEDULE_API}/${selectedSchedule.duty_id}`, {\r\n        method: 'DELETE'\r\n      });\r\n      \r\n      const result = await response.json();\r\n      if (!result.success) {\r\n        throw new Error(result.message || 'เกิดข้อผิดพลาดในการลบ');\r\n      }\r\n      \r\n      showAlert('ลบตารางเวรสำเร็จ', 'success');\r\n      await loadSchedules();\r\n      closeModals();\r\n    } catch (error) {\r\n      console.error('Error deleting schedule:', error);\r\n      showAlert(error.message || 'เกิดข้อผิดพลาดในการลบ', 'error');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteFromList = async (schedule) => {\r\n    if (!window.confirm('คุณแน่ใจหรือไม่ที่จะลบตารางเวรนี้?')) return;\r\n    setSaving(true);\r\n    try {\r\n      const response = await fetch(`${CONFIG.DUTY_SCHEDULE_API}/${schedule.duty_id}`, {\r\n        method: 'DELETE'\r\n      });\r\n      \r\n      const result = await response.json();\r\n      if (!result.success) {\r\n        throw new Error(result.message || 'เกิดข้อผิดพลาดในการลบ');\r\n      }\r\n      \r\n      showAlert('ลบตารางเวรสำเร็จ', 'success');\r\n      await loadSchedules();\r\n    } catch (error) {\r\n      console.error('Error deleting schedule:', error);\r\n      showAlert(error.message || 'เกิดข้อผิดพลาดในการลบ', 'error');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const filteredSchedules = useMemo(() => {\r\n    let filtered = schedules;\r\n    \r\n    if (filters.unit) {\r\n      filtered = filtered.filter(schedule => \r\n        schedule.officer_unit_code === filters.unit || schedule.unit_code === filters.unit\r\n      );\r\n    }\r\n    \r\n    if (filters.officer) {\r\n      filtered = filtered.filter(schedule => \r\n        schedule.officer_name && schedule.officer_name.toLowerCase().includes(filters.officer.toLowerCase())\r\n      );\r\n    }\r\n    \r\n    return filtered;\r\n  }, [schedules, filters]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-full\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col\">\r\n      {/* Alert System */}\r\n      <AlertSystem \r\n        alert={alert} \r\n        onClose={() => setAlert({ show: false, message: '', type: 'info' })} \r\n      />\r\n      \r\n      {/* Tab Navigation */}\r\n      <div className=\"border-b border-slate-200 bg-white\">\r\n        <div className=\"flex space-x-8 px-6\">\r\n          <button\r\n            onClick={() => setActiveTab('shifts')}\r\n            className={`flex items-center py-4 px-2 border-b-2 text-sm font-medium ${\r\n              activeTab === 'shifts'\r\n                ? 'border-indigo-500 text-indigo-600'\r\n                : 'border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300'\r\n            }`}\r\n          >\r\n            <Calendar className=\"w-5 h-5 mr-2\" />\r\n            ตารางเวร\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('officers')}\r\n            className={`flex items-center py-4 px-2 border-b-2 text-sm font-medium ${\r\n              activeTab === 'officers'\r\n                ? 'border-indigo-500 text-indigo-600'\r\n                : 'border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300'\r\n            }`}\r\n          >\r\n            <Shield className=\"w-5 h-5 mr-2\" />\r\n            จัดการเจ้าหน้าที่และโครงสร้าง\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tab Content */}\r\n      <div className=\"flex-1 overflow-hidden\">\r\n        {activeTab === 'shifts' && (\r\n          <div className=\"h-full flex flex-col\">\r\n            {/* View Mode Toggle */}\r\n            <div className=\"bg-white border-b border-slate-200 px-6 py-4\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <h1 className=\"text-lg font-semibold text-slate-900\">\r\n                  ตารางเวร - {currentDate.toLocaleDateString('th-TH', { month: 'long', year: 'numeric' })}\r\n                </h1>\r\n                <div className=\"flex items-center bg-slate-100 rounded-lg p-1\">\r\n                  <button\r\n                    onClick={() => setViewMode('calendar')}\r\n                    className={`flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors ${\r\n                      viewMode === 'calendar'\r\n                        ? 'bg-white text-slate-900 shadow-sm'\r\n                        : 'text-slate-600 hover:text-slate-900'\r\n                    }`}\r\n                  >\r\n                    <Grid className=\"w-4 h-4 mr-2\" />\r\n                    ปฏิทิน\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setViewMode('list')}\r\n                    className={`flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors ${\r\n                      viewMode === 'list'\r\n                        ? 'bg-white text-slate-900 shadow-sm'\r\n                        : 'text-slate-600 hover:text-slate-900'\r\n                    }`}\r\n                  >\r\n                    <List className=\"w-4 h-4 mr-2\" />\r\n                    รายการ\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div className=\"flex-1 overflow-hidden p-6\">\r\n              {viewMode === 'calendar' ? (\r\n                <ShiftCalendarView\r\n                  currentDate={currentDate}\r\n                  schedules={filteredSchedules}\r\n                  officers={officers}\r\n                  units={units}\r\n                  holidays={holidays}\r\n                  filters={filters}\r\n                  setFilters={setFilters}\r\n                  navigateMonth={navigateMonth}\r\n                  goToToday={goToToday}\r\n                  openAddModal={openAddModal}\r\n                  openEditModal={openEditModal}\r\n                />\r\n              ) : (\r\n                <ShiftListView\r\n                  currentDate={currentDate}\r\n                  schedules={filteredSchedules}\r\n                  onEdit={openEditModal}\r\n                  onDelete={handleDeleteFromList}\r\n                />\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {activeTab === 'officers' && <UnitStructureManagement />}\r\n      </div>\r\n\r\n      {/* Modals */}\r\n      <DutyScheduleModal\r\n        showModal={showAddModal || showEditModal}\r\n        isEditMode={showEditModal}\r\n        formData={formData}\r\n        setFormData={setFormData}\r\n        selectedShiftPeriod={selectedShiftPeriod}\r\n        setSelectedShiftPeriod={setSelectedShiftPeriod}\r\n        selectedUnits={selectedUnits}\r\n        setSelectedUnits={setSelectedUnits}\r\n        selectedHeadUnit={selectedHeadUnit}\r\n        setSelectedHeadUnit={setSelectedHeadUnit}\r\n        availableOfficers={availableOfficers}\r\n        manualAddedOfficers={manualAddedOfficers}\r\n        setManualAddedOfficers={setManualAddedOfficers}\r\n        removedPositions={removedPositions}\r\n        setRemovedPositions={setRemovedPositions}\r\n        manualSearch={manualSearch}\r\n        setManualSearch={setManualSearch}\r\n        units={units}\r\n        officers={officers}\r\n        holidays={holidays}\r\n        saving={saving}\r\n        onClose={closeModals}\r\n        onSave={handleSave}\r\n        onDelete={handleDelete}\r\n        showAlert={showAlert}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShiftWorkPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}