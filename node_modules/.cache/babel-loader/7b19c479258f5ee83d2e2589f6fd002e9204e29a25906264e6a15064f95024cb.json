{"ast":null,"code":"import _objectSpread from\"C:/Users/LENOVO/Documents/GitHub/court-marshal-connect/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useMemo,memo}from'react';import{ChevronLeft,ChevronRight,Calendar,Filter,Plus,Shield,Save,Edit,Trash2,Search,X,Moon,Sun,Users,Briefcase,Crown,Star,User}from'lucide-react';import{CONFIG}from'../config';import UnitStructureManagement from'../components/UnitStructure/UnitStructureManagement';// Helper functions\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const getDaysInMonth=date=>new Date(date.getFullYear(),date.getMonth()+1,0).getDate();const getFirstDayOfMonth=date=>new Date(date.getFullYear(),date.getMonth(),1).getDay();const isToday=(date,today)=>date.toDateString()===today.toDateString();const isSameDay=(date1,date2)=>date1.toDateString()===date2.toDateString();const isHoliday=(date,holidays)=>holidays.some(holiday=>isSameDay(new Date(holiday.date+'T00:00:00'),date));const getShiftTypeByPeriod=(period,isHolidayDate,shiftTypes)=>shiftTypes.find(st=>st.type_name===(period==='day'?isHolidayDate?'วันหยุด (กลางวัน)':'ปกติ (กลางวัน)':'ปกติ (กลางคืน)'));const getRoleIcon=role=>{switch(role){case'director':return/*#__PURE__*/_jsx(Crown,{className:\"w-4 h-4 text-purple-600\"});case'supervisor':return/*#__PURE__*/_jsx(Star,{className:\"w-4 h-4 text-blue-600\"});default:return/*#__PURE__*/_jsx(User,{className:\"w-4 h-4 text-green-600\"});}};const getRoleLabel=role=>{switch(role){case'director':return'ผู้อำนวยการ';case'supervisor':return'หัวหน้าส่วน';default:return'เจ้าหน้าที่';}};const getRoleBadgeClass=role=>{switch(role){case'director':return'bg-purple-100 text-purple-700';case'supervisor':return'bg-blue-100 text-blue-700';default:return'bg-green-100 text-green-700';}};const CalendarDayCell=/*#__PURE__*/memo(_ref=>{let{date,holidays,schedules,onAdd,onEdit}=_ref;const today=new Date();const isHolidayDate=isHoliday(date,holidays);const daySchedules=schedules.filter(schedule=>isSameDay(new Date(schedule.duty_date+'T00:00:00'),date));return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-[120px] border border-slate-200 p-1 cursor-pointer hover:bg-slate-50 \".concat(isToday(date,today)?'bg-indigo-50 border-indigo-300':'',\" \").concat(isHolidayDate?'bg-red-50':''),onClick:()=>onAdd(date),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium \".concat(isToday(date,today)?'text-indigo-600':isHolidayDate?'text-red-600':'text-slate-700'),children:date.getDate()}),isHolidayDate&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-red-500\",children:\"\\u0E2B\\u0E22\\u0E38\\u0E14\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-1\",children:daySchedules.map(schedule=>/*#__PURE__*/_jsx(ScheduleItem,{schedule:schedule,onEdit:onEdit},schedule.id))})]});});const ScheduleItem=/*#__PURE__*/memo(_ref2=>{let{schedule,onEdit}=_ref2;return/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs p-1 bg-indigo-100 text-indigo-800 rounded truncate cursor-pointer hover:bg-indigo-200\",onClick:e=>{e.stopPropagation();onEdit(schedule);},title:\"\".concat(schedule.shift_type_name,\" - \").concat(schedule.officer_names||'ไม่ระบุเจ้าหน้าที่',\" \").concat(schedule.notes?\"(\".concat(schedule.notes,\")\"):''),children:[schedule.shift_type_name,\" - \",schedule.officer_names||'ไม่ระบุ']});});const ShiftCalendarView=_ref3=>{let{currentDate,schedules,officers,shiftTypes,units,holidays,filters,setFilters,navigateMonth,goToToday,openAddModal,openEditModal}=_ref3;const daysInMonth=getDaysInMonth(currentDate);const firstDay=getFirstDayOfMonth(currentDate);const today=new Date();const monthDays=useMemo(()=>{const days=[];for(let i=1;i<=daysInMonth;i++){days.push(new Date(currentDate.getFullYear(),currentDate.getMonth(),i));}return days;},[currentDate,daysInMonth]);const emptyDays=Array.from({length:firstDay},(_,i)=>i);return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateMonth(-1),className:\"p-2 hover:bg-slate-100 rounded-lg transition-colors\",children:/*#__PURE__*/_jsx(ChevronLeft,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-slate-800 min-w-[200px] text-center\",children:currentDate.toLocaleDateString('th-TH',{year:'numeric',month:'long'})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateMonth(1),className:\"p-2 hover:bg-slate-100 rounded-lg transition-colors\",children:/*#__PURE__*/_jsx(ChevronRight,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:goToToday,className:\"px-3 py-2 text-sm bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors\",children:\"\\u0E27\\u0E31\\u0E19\\u0E19\\u0E35\\u0E49\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Filter,{className:\"w-4 h-4 text-slate-500\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.unit,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{unit:e.target.value})),className:\"text-sm border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u0E17\\u0E38\\u0E01\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E07\\u0E32\\u0E19\"}),units.map(unit=>/*#__PURE__*/_jsx(\"option\",{value:unit.id,children:unit.unit_name},unit.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0E04\\u0E49\\u0E19\\u0E2B\\u0E32\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48...\",value:filters.officer,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{officer:e.target.value})),className:\"pl-9 pr-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg border border-slate-200 overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-7 bg-slate-50 border-b border-slate-200\",children:['อาทิตย์','จันทร์','อังคาร','พุธ','พฤหัสบดี','ศุกร์','เสาร์'].map(day=>/*#__PURE__*/_jsx(\"div\",{className:\"p-3 text-center text-sm font-medium text-slate-600\",children:day},day))}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-7\",children:[emptyDays.map(day=>/*#__PURE__*/_jsx(\"div\",{className:\"min-h-[120px] border border-slate-200 bg-slate-50\"},\"empty-\".concat(day))),monthDays.map(date=>/*#__PURE__*/_jsx(CalendarDayCell,{date:date,holidays:holidays,schedules:schedules,onAdd:openAddModal,onEdit:openEditModal},date.toISOString()))]})]})]});};const ShiftWorkPage=()=>{const[activeTab,setActiveTab]=useState('shifts');const[currentDate,setCurrentDate]=useState(new Date());const[showAddModal,setShowAddModal]=useState(false);const[showEditModal,setShowEditModal]=useState(false);const[selectedSchedule,setSelectedSchedule]=useState(null);const[schedules,setSchedules]=useState([]);const[officers,setOfficers]=useState([]);const[shiftTypes,setShiftTypes]=useState([]);const[units,setUnits]=useState([]);const[holidays,setHolidays]=useState([]);const[formData,setFormData]=useState({duty_date:'',shift_type_id:'',unit_id:'',officer_ids:[],notes:''});const[filters,setFilters]=useState({unit:'',officer:''});const[loading,setLoading]=useState(true);const[saving,setSaving]=useState(false);const[selectedShiftPeriod,setSelectedShiftPeriod]=useState('day');const[selectedUnits,setSelectedUnits]=useState([]);const[selectedOfficers,setSelectedOfficers]=useState([]);const[showOfficerList,setShowOfficerList]=useState(false);const[officerSearchTerm,setOfficerSearchTerm]=useState('');useEffect(()=>{const loadHolidaysByYear=async()=>{try{const response=await fetch(\"\".concat(CONFIG.SCHEDULES_API,\"?action=get_holidays&year=\").concat(currentDate.getFullYear()));const result=await response.json();if(result.success&&Array.isArray(result.data)){setHolidays(result.data);}else{console.warn('No holidays data available');setHolidays([]);}}catch(error){console.error(\"ล้มเหลวในการดึงข้อมูลวันหยุด:\",error);setHolidays([]);}};loadHolidaysByYear();},[currentDate]);useEffect(()=>{if(selectedUnits.length>0&&Array.isArray(officers)){const officersInSelectedUnits=officers.filter(officer=>officer.unit_id&&selectedUnits.includes(officer.unit_id)).map(officer=>officer.id);setSelectedOfficers(officersInSelectedUnits);}else{setSelectedOfficers([]);}},[selectedUnits,officers]);// --- ฟังก์ชันจัดการการเลือกส่วนงาน ---\nconst handleUnitSelect=unitId=>{setSelectedUnits(prev=>prev.includes(unitId)?prev.filter(id=>id!==unitId):[...prev,unitId]);};// --- ฟังก์ชันจัดการการเลือกเจ้าหน้าที่ ---\nconst handleOfficerAdd=officerId=>{setSelectedOfficers(prev=>[...prev,officerId]);};const handleOfficerRemove=officerId=>{setSelectedOfficers(prev=>prev.filter(id=>id!==officerId));};// --- ฟังก์ชันกรองเจ้าหน้าที่ที่ยังไม่ได้เลือก ---\nconst getAvailableOfficers=()=>{if(!Array.isArray(officers))return[];return officers.filter(officer=>officer.unit_id!==null&&(selectedUnits.length===0||selectedUnits.includes(officer.unit_id))&&!selectedOfficers.includes(officer.id)&&(officerSearchTerm===''||\"\".concat(officer.firstname,\" \").concat(officer.lastname).toLowerCase().includes(officerSearchTerm.toLowerCase())));};// --- ฟังก์ชันหาข้อมูลเจ้าหน้าที่ ---\nconst getOfficerById=officerId=>{return officers.find(o=>o.id===officerId);};useEffect(()=>{loadInitialData();},[]);useEffect(()=>{loadSchedules();},[currentDate]);const loadInitialData=async()=>{setLoading(true);try{await Promise.all([loadOfficers(),loadShiftTypes(),loadUnits(),loadHolidays(),loadSchedules()]);}catch(error){console.error('Error loading initial data:',error.message,error.stack);}finally{setLoading(false);}};const loadSchedules=async()=>{try{const month=currentDate.getMonth()+1;const year=currentDate.getFullYear();const response=await fetch(\"\".concat(CONFIG.SCHEDULES_API,\"?action=get_all_schedules&month=\").concat(month,\"&year=\").concat(year));const data=await response.json();if(data.success){setSchedules(data.data);}else{console.error('Failed to fetch schedules:',data.message);}}catch(error){console.error('Error loading schedules:',error.message,error.stack);}};const loadOfficers=async()=>{try{const response=await fetch(\"\".concat(CONFIG.OFFICERS_API,\"?action=get_all_officers\"));if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();if(data&&data.success&&Array.isArray(data.data)){setOfficers(data.data);}else{console.error('Failed to load officers:',data);setOfficers([]);}}catch(error){console.error('Error loading officers:',error);setOfficers([]);}};const loadShiftTypes=async()=>{try{const response=await fetch(\"\".concat(CONFIG.SCHEDULES_API,\"?action=get_all_shifttypes\"));const data=await response.json();if(Array.isArray(data)){setShiftTypes(data);}else{setShiftTypes([]);}}catch(error){console.error('Error loading shift types:',error);setShiftTypes([]);}};const loadUnits=async()=>{try{const response=await fetch(\"\".concat(CONFIG.SCHEDULES_API,\"?action=get_all_units\"));const data=await response.json();if(Array.isArray(data)){setUnits(data);}else{setUnits([]);}}catch(error){console.error('Error loading units:',error);setUnits([]);}};const loadHolidays=async()=>{try{const response=await fetch(\"\".concat(CONFIG.SCHEDULES_API,\"?action=get_holidays\"));const data=await response.json();if(Array.isArray(data)){setHolidays(data);}else{setHolidays([]);}}catch(error){console.error('Error loading holidays:',error);setHolidays([]);}};const navigateMonth=direction=>{setCurrentDate(prev=>{const newDate=new Date(prev);newDate.setMonth(prev.getMonth()+direction);return newDate;});};const goToToday=()=>{setCurrentDate(new Date());};// --- แก้ไข openAddModal ---\nconst openAddModal=function(){let date=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;const dateObj=date||new Date();const isHolidayDate=isHoliday(dateObj,holidays);const suggestedType=getShiftTypeByPeriod('day',isHolidayDate,shiftTypes);setSelectedShiftPeriod('day');setSelectedUnits([]);setSelectedOfficers([]);setFormData({duty_date:date?date.toISOString().split('T')[0]:'',shift_type_id:(suggestedType===null||suggestedType===void 0?void 0:suggestedType.id)||'',unit_id:'',officer_ids:[],notes:''});setShowAddModal(true);};const openEditModal=schedule=>{setSelectedSchedule(schedule);setFormData({duty_date:schedule.duty_date,shift_type_id:schedule.shift_type_id,unit_id:schedule.unit_id||'',officer_ids:schedule.officer_ids||[],notes:schedule.notes||''});setSelectedOfficers(schedule.officer_ids||[]);setShowEditModal(true);};const closeModals=()=>{setShowAddModal(false);setShowEditModal(false);setSelectedSchedule(null);setSelectedShiftPeriod('day');setSelectedUnits([]);setSelectedOfficers([]);setShowOfficerList(false);setOfficerSearchTerm('');};const handleInputChange=(field,value)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:value}));};const handleSave=async()=>{setSaving(true);try{// อัปเดต shift_type_id และ officer_ids ตาม UI ใหม่\nconst dateObj=new Date(formData.duty_date+'T00:00:00');const isHolidayDate=isHoliday(dateObj,holidays);const shiftType=getShiftTypeByPeriod(selectedShiftPeriod,isHolidayDate,shiftTypes);const payload=_objectSpread(_objectSpread({action:selectedSchedule?'update_schedule':'create_schedule'},formData),{},{shift_type_id:(shiftType===null||shiftType===void 0?void 0:shiftType.id)||formData.shift_type_id,officer_ids:selectedOfficers},selectedSchedule&&{schedule_id:selectedSchedule.id});const response=await fetch(CONFIG.SCHEDULES_API,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});const result=await response.json();if(!result.success)throw new Error(result.message);await loadSchedules();closeModals();}catch(error){console.error('Error saving schedule:',error);}finally{setSaving(false);}};const handleDelete=async()=>{if(!selectedSchedule||!window.confirm('คุณแน่ใจหรือไม่ที่จะลบตารางเวรนี้?'))return;setSaving(true);try{const payload={action:'delete_schedule',schedule_id:selectedSchedule.id};const response=await fetch(CONFIG.SCHEDULES_API,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});const result=await response.json();if(!result.success)throw new Error(result.message);await loadSchedules();closeModals();}catch(error){console.error('Error deleting schedule:',error);}finally{setSaving(false);}};const filteredSchedules=useMemo(()=>{return schedules.filter(schedule=>{const unitMatch=!filters.unit||schedule.unit_id===parseInt(filters.unit);const officerMatch=!filters.officer||schedule.officer_names&&schedule.officer_names.toLowerCase().includes(filters.officer.toLowerCase());return unitMatch&&officerMatch;});},[schedules,filters]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-full\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"h-full flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-slate-200\",children:/*#__PURE__*/_jsxs(\"nav\",{className:\"flex space-x-4 px-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('shifts'),className:\"flex items-center space-x-2 py-3 px-3 rounded-t-lg font-medium text-sm whitespace-nowrap \".concat(activeTab==='shifts'?'border-b-2 border-indigo-600 text-indigo-600':'text-slate-500 hover:text-slate-700'),children:[/*#__PURE__*/_jsx(Shield,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0E40\\u0E27\\u0E23\\u0E23\\u0E31\\u0E01\\u0E29\\u0E32\\u0E01\\u0E32\\u0E23\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('documents'),className:\"flex items-center space-x-2 py-3 px-3 rounded-t-lg font-medium text-sm whitespace-nowrap \".concat(activeTab==='documents'?'border-b-2 border-indigo-600 text-indigo-600':'text-slate-500 hover:text-slate-700'),children:[/*#__PURE__*/_jsx(Briefcase,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0E08\\u0E31\\u0E14\\u0E01\\u0E32\\u0E23\\u0E42\\u0E04\\u0E23\\u0E07\\u0E2A\\u0E23\\u0E49\\u0E32\\u0E07\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow p-4 bg-slate-50/50 overflow-y-auto\",children:[activeTab==='shifts'&&/*#__PURE__*/_jsx(ShiftCalendarView,{currentDate:currentDate,schedules:filteredSchedules,officers:officers,shiftTypes:shiftTypes,units:units,holidays:holidays,filters:filters,setFilters:setFilters,navigateMonth:navigateMonth,goToToday:goToToday,openAddModal:openAddModal,openEditModal:openEditModal}),activeTab==='documents'&&/*#__PURE__*/_jsx(UnitStructureManagement,{})]}),(showAddModal||showEditModal)&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-xl w-full max-w-3xl mx-4 max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-b\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:showEditModal?'แก้ไขตารางเวร':'เพิ่มตารางเวรใหม่'}),formData.duty_date&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:[\"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48 \",new Date(formData.duty_date+'T00:00:00').toLocaleDateString('th-TH'),isHoliday(new Date(formData.duty_date+'T00:00:00'),holidays)&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 px-2 py-0.5 bg-red-100 text-red-600 text-xs rounded-full\",children:\"\\u0E27\\u0E31\\u0E19\\u0E2B\\u0E22\\u0E38\\u0E14\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.duty_date,onChange:e=>{handleInputChange('duty_date',e.target.value);// อัปเดต shift type อัตโนมัติเมื่อเปลี่ยนวันที่\nconst newDate=new Date(e.target.value+'T00:00:00');const isHol=isHoliday(newDate,holidays);const suggestedType=getShiftTypeByPeriod(selectedShiftPeriod,isHol,shiftTypes);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{shift_type_id:(suggestedType===null||suggestedType===void 0?void 0:suggestedType.id)||''}));},className:\"w-full border border-gray-300 rounded-lg px-3 py-2\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-3\",children:\"\\u0E0A\\u0E48\\u0E27\\u0E07\\u0E40\\u0E27\\u0E23\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>{setSelectedShiftPeriod('day');const isHol=formData.duty_date?isHoliday(new Date(formData.duty_date+'T00:00:00'),holidays):false;const suggestedType=getShiftTypeByPeriod('day',isHol,shiftTypes);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{shift_type_id:(suggestedType===null||suggestedType===void 0?void 0:suggestedType.id)||''}));},className:\"flex items-center px-4 py-2 rounded-lg border \".concat(selectedShiftPeriod==='day'?'bg-yellow-50 border-yellow-300 text-yellow-700':'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(Sun,{className:\"w-4 h-4 mr-2\"}),\"\\u0E01\\u0E25\\u0E32\\u0E07\\u0E27\\u0E31\\u0E19\"]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>{setSelectedShiftPeriod('night');const suggestedType=getShiftTypeByPeriod('night',false,shiftTypes);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{shift_type_id:(suggestedType===null||suggestedType===void 0?void 0:suggestedType.id)||''}));},className:\"flex items-center px-4 py-2 rounded-lg border \".concat(selectedShiftPeriod==='night'?'bg-indigo-50 border-indigo-300 text-indigo-700':'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(Moon,{className:\"w-4 h-4 mr-2\"}),\"\\u0E01\\u0E25\\u0E32\\u0E07\\u0E04\\u0E37\\u0E19\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-3\",children:\"\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E07\\u0E32\\u0E19\"}),/*#__PURE__*/_jsx(\"div\",{className:\"border border-gray-300 rounded-lg p-4 max-h-40 overflow-y-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-2\",children:Array.isArray(units)&&units.map(unit=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center py-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedUnits.includes(unit.id),onChange:()=>handleUnitSelect(unit.id),className:\"h-4 w-4 text-indigo-600\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-sm text-gray-900\",children:unit.unit_name})]},unit.id))})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-3\",children:\"\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48\\u0E17\\u0E35\\u0E48\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\"}),/*#__PURE__*/_jsx(\"div\",{className:\"border border-gray-300 rounded-lg p-3 min-h-[100px]\",children:selectedOfficers.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm\",children:\"\\u0E22\\u0E31\\u0E07\\u0E44\\u0E21\\u0E48\\u0E44\\u0E14\\u0E49\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:selectedOfficers.map(officerId=>{const officer=getOfficerById(officerId);return officer?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between bg-gray-50 px-3 py-2 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm\",children:[officer.prefix,\" \",officer.firstname,\" \",officer.lastname]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleOfficerRemove(officerId),className:\"text-red-600 hover:text-red-800\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]},officerId):null;})})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"\\u0E08\\u0E31\\u0E14\\u0E01\\u0E32\\u0E23\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowOfficerList(!showOfficerList),className:\"text-sm text-indigo-600 hover:text-indigo-800\",children:showOfficerList?'ซ่อน':'เพิ่มเจ้าหน้าที่'})]}),showOfficerList&&/*#__PURE__*/_jsxs(\"div\",{className:\"border border-gray-300 rounded-lg p-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Search,{className:\"w-4 h-4 text-gray-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0E04\\u0E49\\u0E19\\u0E2B\\u0E32\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48...\",value:officerSearchTerm,onChange:e=>setOfficerSearchTerm(e.target.value),className:\"flex-1 border border-gray-300 rounded px-2 py-1 text-sm\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-40 overflow-y-auto\",children:getAvailableOfficers().length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm\",children:selectedUnits.length===0?'กรุณาเลือกส่วนงานก่อน':officerSearchTerm?'ไม่พบเจ้าหน้าที่ที่ค้นหา':'ไม่มีเจ้าหน้าที่ที่สามารถเลือกได้'}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-1\",children:getAvailableOfficers().map(officer=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between py-2 hover:bg-gray-50 px-2 rounded\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm\",children:[officer.prefix,\" \",officer.firstname,\" \",officer.lastname]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{handleOfficerAdd(officer.id);setOfficerSearchTerm('');// ล้างค่าค้นหาหลังเพิ่ม\n},className:\"text-indigo-600 hover:text-indigo-800 p-1 rounded hover:bg-indigo-50\",children:/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"})})]},officer.id))})})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"\\u0E2B\\u0E21\\u0E32\\u0E22\\u0E40\\u0E2B\\u0E15\\u0E38\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.notes,onChange:e=>handleInputChange('notes',e.target.value),rows:3,className:\"w-full border border-gray-300 rounded-lg px-3 py-2\",placeholder:\"\\u0E23\\u0E32\\u0E22\\u0E25\\u0E30\\u0E40\\u0E2D\\u0E35\\u0E22\\u0E14\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E40\\u0E15\\u0E34\\u0E21...\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-t bg-gray-50 flex justify-between\",children:[/*#__PURE__*/_jsx(\"div\",{children:showEditModal&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleDelete,disabled:saving,className:\"inline-flex items-center px-4 py-2 border border-red-300 text-sm font-medium rounded-lg text-red-700 bg-red-50 hover:bg-red-100\",children:[/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4 mr-2\"}),\"\\u0E25\\u0E1A\\u0E40\\u0E27\\u0E23\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:closeModals,disabled:saving,className:\"px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50\",children:\"\\u0E22\\u0E01\\u0E40\\u0E25\\u0E34\\u0E01\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,disabled:saving||selectedOfficers.length===0,className:\"inline-flex items-center px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed\",children:saving?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"}),\"\\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Save,{className:\"w-4 h-4 mr-2\"}),\"\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\"]})})]})]})]})})]});};export default ShiftWorkPage;","map":{"version":3,"names":["React","useState","useEffect","useMemo","memo","ChevronLeft","ChevronRight","Calendar","Filter","Plus","Shield","Save","Edit","Trash2","Search","X","Moon","Sun","Users","Briefcase","Crown","Star","User","CONFIG","UnitStructureManagement","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","getDaysInMonth","date","Date","getFullYear","getMonth","getDate","getFirstDayOfMonth","getDay","isToday","today","toDateString","isSameDay","date1","date2","isHoliday","holidays","some","holiday","getShiftTypeByPeriod","period","isHolidayDate","shiftTypes","find","st","type_name","getRoleIcon","role","className","getRoleLabel","getRoleBadgeClass","CalendarDayCell","_ref","schedules","onAdd","onEdit","daySchedules","filter","schedule","duty_date","concat","onClick","children","map","ScheduleItem","id","_ref2","e","stopPropagation","title","shift_type_name","officer_names","notes","ShiftCalendarView","_ref3","currentDate","officers","units","filters","setFilters","navigateMonth","goToToday","openAddModal","openEditModal","daysInMonth","firstDay","monthDays","days","i","push","emptyDays","Array","from","length","_","toLocaleDateString","year","month","value","unit","onChange","prev","_objectSpread","target","unit_name","type","placeholder","officer","day","toISOString","ShiftWorkPage","activeTab","setActiveTab","setCurrentDate","showAddModal","setShowAddModal","showEditModal","setShowEditModal","selectedSchedule","setSelectedSchedule","setSchedules","setOfficers","setShiftTypes","setUnits","setHolidays","formData","setFormData","shift_type_id","unit_id","officer_ids","loading","setLoading","saving","setSaving","selectedShiftPeriod","setSelectedShiftPeriod","selectedUnits","setSelectedUnits","selectedOfficers","setSelectedOfficers","showOfficerList","setShowOfficerList","officerSearchTerm","setOfficerSearchTerm","loadHolidaysByYear","response","fetch","SCHEDULES_API","result","json","success","isArray","data","console","warn","error","officersInSelectedUnits","includes","handleUnitSelect","unitId","handleOfficerAdd","officerId","handleOfficerRemove","getAvailableOfficers","firstname","lastname","toLowerCase","getOfficerById","o","loadInitialData","loadSchedules","Promise","all","loadOfficers","loadShiftTypes","loadUnits","loadHolidays","message","stack","OFFICERS_API","ok","Error","status","direction","newDate","setMonth","arguments","undefined","dateObj","suggestedType","split","closeModals","handleInputChange","field","handleSave","shiftType","payload","action","schedule_id","method","headers","body","JSON","stringify","handleDelete","window","confirm","filteredSchedules","unitMatch","parseInt","officerMatch","isHol","checked","prefix","rows","disabled"],"sources":["C:/Users/LENOVO/Documents/GitHub/court-marshal-connect/src/pages/ShiftWorkPage.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, memo } from 'react';\r\nimport { \r\n  ChevronLeft, \r\n  ChevronRight, \r\n  Calendar, \r\n  Filter, \r\n  Plus, \r\n  Shield, \r\n  Save, \r\n  Edit, \r\n  Trash2, \r\n  Search, \r\n  X, \r\n  Moon, \r\n  Sun, \r\n  Users, \r\n  Briefcase,\r\n  Crown,\r\n  Star,\r\n  User\r\n} from 'lucide-react';\r\nimport { CONFIG } from '../config';\r\nimport UnitStructureManagement from '../components/UnitStructure/UnitStructureManagement';\r\n\r\n// Helper functions\r\nconst getDaysInMonth = (date) => new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();\r\nconst getFirstDayOfMonth = (date) => new Date(date.getFullYear(), date.getMonth(), 1).getDay();\r\nconst isToday = (date, today) => date.toDateString() === today.toDateString();\r\nconst isSameDay = (date1, date2) => date1.toDateString() === date2.toDateString();\r\nconst isHoliday = (date, holidays) => holidays.some(holiday => isSameDay(new Date(holiday.date + 'T00:00:00'), date));\r\nconst getShiftTypeByPeriod = (period, isHolidayDate, shiftTypes) => shiftTypes.find(st => st.type_name === (period === 'day' ? (isHolidayDate ? 'วันหยุด (กลางวัน)' : 'ปกติ (กลางวัน)') : 'ปกติ (กลางคืน)'));\r\n\r\nconst getRoleIcon = (role) => {\r\n  switch (role) {\r\n    case 'director': return <Crown className=\"w-4 h-4 text-purple-600\" />;\r\n    case 'supervisor': return <Star className=\"w-4 h-4 text-blue-600\" />;\r\n    default: return <User className=\"w-4 h-4 text-green-600\" />;\r\n  }\r\n};\r\n\r\nconst getRoleLabel = (role) => {\r\n  switch (role) {\r\n    case 'director': return 'ผู้อำนวยการ';\r\n    case 'supervisor': return 'หัวหน้าส่วน';\r\n    default: return 'เจ้าหน้าที่';\r\n  }\r\n};\r\n\r\nconst getRoleBadgeClass = (role) => {\r\n  switch (role) {\r\n    case 'director': return 'bg-purple-100 text-purple-700';\r\n    case 'supervisor': return 'bg-blue-100 text-blue-700';\r\n    default: return 'bg-green-100 text-green-700';\r\n  }\r\n};\r\n\r\nconst CalendarDayCell = memo(({ date, holidays, schedules, onAdd, onEdit }) => {\r\n  const today = new Date();\r\n  const isHolidayDate = isHoliday(date, holidays);\r\n  const daySchedules = schedules.filter(schedule => isSameDay(new Date(schedule.duty_date + 'T00:00:00'), date));\r\n\r\n  return (\r\n    <div \r\n      className={`min-h-[120px] border border-slate-200 p-1 cursor-pointer hover:bg-slate-50 ${\r\n        isToday(date, today) ? 'bg-indigo-50 border-indigo-300' : ''\r\n      } ${isHolidayDate ? 'bg-red-50' : ''}`}\r\n      onClick={() => onAdd(date)}\r\n    >\r\n      <div className=\"flex justify-between items-start mb-1\">\r\n        <span className={`text-sm font-medium ${\r\n          isToday(date, today) ? 'text-indigo-600' : \r\n          isHolidayDate ? 'text-red-600' : 'text-slate-700'\r\n        }`}>\r\n          {date.getDate()}\r\n        </span>\r\n        {isHolidayDate && <span className=\"text-xs text-red-500\">หยุด</span>}\r\n      </div>\r\n      \r\n      <div className=\"space-y-1\">\r\n        {daySchedules.map(schedule => (\r\n          <ScheduleItem key={schedule.id} schedule={schedule} onEdit={onEdit} />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nconst ScheduleItem = memo(({ schedule, onEdit }) => (\r\n  <div \r\n    className=\"text-xs p-1 bg-indigo-100 text-indigo-800 rounded truncate cursor-pointer hover:bg-indigo-200\"\r\n    onClick={(e) => { e.stopPropagation(); onEdit(schedule); }}\r\n    title={`${schedule.shift_type_name} - ${schedule.officer_names || 'ไม่ระบุเจ้าหน้าที่'} ${schedule.notes ? `(${schedule.notes})` : ''}`}\r\n  >\r\n    {schedule.shift_type_name} - {schedule.officer_names || 'ไม่ระบุ'}\r\n  </div>\r\n));\r\n\r\nconst ShiftCalendarView = ({ \r\n  currentDate, \r\n  schedules, \r\n  officers, \r\n  shiftTypes, \r\n  units, \r\n  holidays, \r\n  filters, \r\n  setFilters, \r\n  navigateMonth, \r\n  goToToday, \r\n  openAddModal, \r\n  openEditModal \r\n}) => {\r\n  const daysInMonth = getDaysInMonth(currentDate);\r\n  const firstDay = getFirstDayOfMonth(currentDate);\r\n  const today = new Date();\r\n  \r\n  const monthDays = useMemo(() => {\r\n    const days = [];\r\n    for (let i = 1; i <= daysInMonth; i++) {\r\n      days.push(new Date(currentDate.getFullYear(), currentDate.getMonth(), i));\r\n    }\r\n    return days;\r\n  }, [currentDate, daysInMonth]);\r\n\r\n  const emptyDays = Array.from({ length: firstDay }, (_, i) => i);\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Calendar Header */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0\">\r\n        <div className=\"flex items-center space-x-4\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <button \r\n              onClick={() => navigateMonth(-1)}\r\n              className=\"p-2 hover:bg-slate-100 rounded-lg transition-colors\"\r\n            >\r\n              <ChevronLeft className=\"w-5 h-5\" />\r\n            </button>\r\n            <h2 className=\"text-xl font-semibold text-slate-800 min-w-[200px] text-center\">\r\n              {currentDate.toLocaleDateString('th-TH', { year: 'numeric', month: 'long' })}\r\n            </h2>\r\n            <button \r\n              onClick={() => navigateMonth(1)}\r\n              className=\"p-2 hover:bg-slate-100 rounded-lg transition-colors\"\r\n            >\r\n              <ChevronRight className=\"w-5 h-5\" />\r\n            </button>\r\n          </div>\r\n          <button \r\n            onClick={goToToday}\r\n            className=\"px-3 py-2 text-sm bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors\"\r\n          >\r\n            วันนี้\r\n          </button>\r\n        </div>\r\n        \r\n        {/* Filters */}\r\n        <div className=\"flex items-center space-x-4\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Filter className=\"w-4 h-4 text-slate-500\" />\r\n            <select \r\n              value={filters.unit}\r\n              onChange={(e) => setFilters(prev => ({ ...prev, unit: e.target.value }))}\r\n              className=\"text-sm border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"\r\n            >\r\n              <option value=\"\">ทุกส่วนงาน</option>\r\n              {units.map(unit => (\r\n                <option key={unit.id} value={unit.id}>{unit.unit_name}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          \r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"ค้นหาเจ้าหน้าที่...\"\r\n              value={filters.officer}\r\n              onChange={(e) => setFilters(prev => ({ ...prev, officer: e.target.value }))}\r\n              className=\"pl-9 pr-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Calendar Grid */}\r\n      <div className=\"bg-white rounded-lg border border-slate-200 overflow-hidden\">\r\n        {/* Days of week header */}\r\n        <div className=\"grid grid-cols-7 bg-slate-50 border-b border-slate-200\">\r\n          {['อาทิตย์', 'จันทร์', 'อังคาร', 'พุธ', 'พฤหัสบดี', 'ศุกร์', 'เสาร์'].map(day => (\r\n            <div key={day} className=\"p-3 text-center text-sm font-medium text-slate-600\">\r\n              {day}\r\n            </div>\r\n          ))}\r\n        </div>\r\n        \r\n        {/* Calendar body */}\r\n        <div className=\"grid grid-cols-7\">\r\n          {/* Empty cells for days before month starts */}\r\n          {emptyDays.map(day => (\r\n            <div key={`empty-${day}`} className=\"min-h-[120px] border border-slate-200 bg-slate-50\"></div>\r\n          ))}\r\n          \r\n          {/* Month days */}\r\n          {monthDays.map(date => (\r\n            <CalendarDayCell\r\n              key={date.toISOString()}\r\n              date={date}\r\n              holidays={holidays}\r\n              schedules={schedules}\r\n              onAdd={openAddModal}\r\n              onEdit={openEditModal}\r\n            />\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ShiftWorkPage = () => {\r\n  const [activeTab, setActiveTab] = useState('shifts');\r\n  const [currentDate, setCurrentDate] = useState(new Date());\r\n  const [showAddModal, setShowAddModal] = useState(false);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [selectedSchedule, setSelectedSchedule] = useState(null);\r\n  const [schedules, setSchedules] = useState([]);\r\n  const [officers, setOfficers] = useState([]);\r\n  const [shiftTypes, setShiftTypes] = useState([]);\r\n  const [units, setUnits] = useState([]);\r\n  const [holidays, setHolidays] = useState([]);\r\n  const [formData, setFormData] = useState({ duty_date: '', shift_type_id: '', unit_id: '', officer_ids: [], notes: '' });\r\n  const [filters, setFilters] = useState({ unit: '', officer: '' });\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [selectedShiftPeriod, setSelectedShiftPeriod] = useState('day');\r\n  const [selectedUnits, setSelectedUnits] = useState([]);\r\n  const [selectedOfficers, setSelectedOfficers] = useState([]);\r\n  const [showOfficerList, setShowOfficerList] = useState(false);\r\n  const [officerSearchTerm, setOfficerSearchTerm] = useState('');\r\n\r\n  useEffect(() => {\r\n    const loadHolidaysByYear = async () => {\r\n      try {\r\n        const response = await fetch(`${CONFIG.SCHEDULES_API}?action=get_holidays&year=${currentDate.getFullYear()}`);\r\n        const result = await response.json();\r\n        if (result.success && Array.isArray(result.data)) {\r\n          setHolidays(result.data);\r\n        } else {\r\n          console.warn('No holidays data available');\r\n          setHolidays([]);\r\n        }\r\n      } catch (error) {\r\n        console.error(\"ล้มเหลวในการดึงข้อมูลวันหยุด:\", error);\r\n        setHolidays([]);\r\n      }\r\n    };\r\n\r\n    loadHolidaysByYear();\r\n  }, [currentDate]);\r\n\r\n  useEffect(() => {\r\n    if (selectedUnits.length > 0 && Array.isArray(officers)) {\r\n      const officersInSelectedUnits = officers\r\n        .filter(officer => officer.unit_id && selectedUnits.includes(officer.unit_id))\r\n        .map(officer => officer.id);\r\n\r\n      setSelectedOfficers(officersInSelectedUnits);\r\n    } else {\r\n      setSelectedOfficers([]);\r\n    }\r\n  }, [selectedUnits, officers]);\r\n\r\n  // --- ฟังก์ชันจัดการการเลือกส่วนงาน ---\r\n  const handleUnitSelect = (unitId) => {\r\n    setSelectedUnits(prev =>\r\n      prev.includes(unitId)\r\n        ? prev.filter(id => id !== unitId)\r\n        : [...prev, unitId]\r\n    );\r\n  };\r\n\r\n  // --- ฟังก์ชันจัดการการเลือกเจ้าหน้าที่ ---\r\n  const handleOfficerAdd = (officerId) => {\r\n    setSelectedOfficers(prev => [...prev, officerId]);\r\n  };\r\n\r\n  const handleOfficerRemove = (officerId) => {\r\n    setSelectedOfficers(prev => prev.filter(id => id !== officerId));\r\n  };\r\n\r\n  // --- ฟังก์ชันกรองเจ้าหน้าที่ที่ยังไม่ได้เลือก ---\r\n  const getAvailableOfficers = () => {\r\n    if (!Array.isArray(officers)) return [];\r\n\r\n    return officers.filter(officer =>\r\n      officer.unit_id !== null &&\r\n      (selectedUnits.length === 0 || selectedUnits.includes(officer.unit_id)) &&\r\n      !selectedOfficers.includes(officer.id) &&\r\n      (officerSearchTerm === '' ||\r\n        `${officer.firstname} ${officer.lastname}`.toLowerCase().includes(officerSearchTerm.toLowerCase()))\r\n    );\r\n  };\r\n\r\n  // --- ฟังก์ชันหาข้อมูลเจ้าหน้าที่ ---\r\n  const getOfficerById = (officerId) => {\r\n    return officers.find(o => o.id === officerId);\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadInitialData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    loadSchedules();\r\n  }, [currentDate]);\r\n\r\n  const loadInitialData = async () => {\r\n    setLoading(true);\r\n    try {\r\n      await Promise.all([\r\n        loadOfficers(),\r\n        loadShiftTypes(),\r\n        loadUnits(),\r\n        loadHolidays(),\r\n        loadSchedules()\r\n      ]);\r\n    } catch (error) {\r\n      console.error('Error loading initial data:', error.message, error.stack);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadSchedules = async () => {\r\n    try {\r\n      const month = currentDate.getMonth() + 1;\r\n      const year = currentDate.getFullYear();\r\n      const response = await fetch(`${CONFIG.SCHEDULES_API}?action=get_all_schedules&month=${month}&year=${year}`);\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setSchedules(data.data);\r\n      } else {\r\n        console.error('Failed to fetch schedules:', data.message);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading schedules:', error.message, error.stack);\r\n    }\r\n  };\r\n\r\n  const loadOfficers = async () => {\r\n    try {\r\n      const response = await fetch(`${CONFIG.OFFICERS_API}?action=get_all_officers`);\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n      const data = await response.json();\r\n      if (data && data.success && Array.isArray(data.data)) {\r\n        setOfficers(data.data);\r\n      } else {\r\n        console.error('Failed to load officers:', data);\r\n        setOfficers([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading officers:', error);\r\n      setOfficers([]);\r\n    }\r\n  };\r\n\r\n  const loadShiftTypes = async () => {\r\n    try {\r\n      const response = await fetch(`${CONFIG.SCHEDULES_API}?action=get_all_shifttypes`);\r\n      const data = await response.json();\r\n      if (Array.isArray(data)) {\r\n        setShiftTypes(data);\r\n      } else {\r\n        setShiftTypes([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading shift types:', error);\r\n      setShiftTypes([]);\r\n    }\r\n  };\r\n\r\n  const loadUnits = async () => {\r\n      try {\r\n          const response = await fetch(`${CONFIG.SCHEDULES_API}?action=get_all_units`);\r\n    const data = await response.json();\r\n          if (Array.isArray(data)) {\r\n              setUnits(data);\r\n          } else {\r\n              setUnits([]);\r\n          }\r\n      } catch (error) {\r\n          console.error('Error loading units:', error);\r\n          setUnits([]);\r\n      }\r\n  };\r\n\r\n  const loadHolidays = async () => {\r\n      try {\r\n          const response = await fetch(`${CONFIG.SCHEDULES_API}?action=get_holidays`);\r\n    const data = await response.json();\r\n          if (Array.isArray(data)) {\r\n              setHolidays(data);\r\n          } else {\r\n              setHolidays([]);\r\n          }\r\n      } catch (error) {\r\n          console.error('Error loading holidays:', error);\r\n          setHolidays([]);\r\n      }\r\n  };\r\n\r\n  const navigateMonth = (direction) => {\r\n    setCurrentDate(prev => {\r\n      const newDate = new Date(prev);\r\n      newDate.setMonth(prev.getMonth() + direction);\r\n      return newDate;\r\n    });\r\n  };\r\n\r\n  const goToToday = () => {\r\n    setCurrentDate(new Date());\r\n  };\r\n\r\n  // --- แก้ไข openAddModal ---\r\n  const openAddModal = (date = null) => {\r\n    const dateObj = date || new Date();\r\n    const isHolidayDate = isHoliday(dateObj, holidays);\r\n\r\n    const suggestedType = getShiftTypeByPeriod('day', isHolidayDate, shiftTypes);\r\n    setSelectedShiftPeriod('day');\r\n    setSelectedUnits([]);\r\n    setSelectedOfficers([]);\r\n    setFormData({\r\n      duty_date: date ? date.toISOString().split('T')[0] : '',\r\n      shift_type_id: suggestedType?.id || '',\r\n      unit_id: '',\r\n      officer_ids: [],\r\n      notes: ''\r\n    });\r\n    setShowAddModal(true);\r\n  };\r\n\r\n  const openEditModal = (schedule) => {\r\n    setSelectedSchedule(schedule);\r\n    setFormData({\r\n      duty_date: schedule.duty_date,\r\n      shift_type_id: schedule.shift_type_id,\r\n      unit_id: schedule.unit_id || '',\r\n      officer_ids: schedule.officer_ids || [],\r\n      notes: schedule.notes || ''\r\n    });\r\n    setSelectedOfficers(schedule.officer_ids || []);\r\n    setShowEditModal(true);\r\n  };\r\n\r\n  const closeModals = () => {\r\n    setShowAddModal(false);\r\n    setShowEditModal(false);\r\n    setSelectedSchedule(null);\r\n    setSelectedShiftPeriod('day');\r\n    setSelectedUnits([]);\r\n    setSelectedOfficers([]);\r\n    setShowOfficerList(false);\r\n    setOfficerSearchTerm('');\r\n  };\r\n\r\n  const handleInputChange = (field, value) => {\r\n    setFormData(prev => ({ ...prev, [field]: value }));\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    setSaving(true);\r\n    try {\r\n      // อัปเดต shift_type_id และ officer_ids ตาม UI ใหม่\r\n      const dateObj = new Date(formData.duty_date + 'T00:00:00');\r\n      const isHolidayDate = isHoliday(dateObj, holidays);\r\n      const shiftType = getShiftTypeByPeriod(selectedShiftPeriod, isHolidayDate, shiftTypes);\r\n\r\n      const payload = {\r\n        action: selectedSchedule ? 'update_schedule' : 'create_schedule',\r\n        ...formData,\r\n        shift_type_id: shiftType?.id || formData.shift_type_id,\r\n        officer_ids: selectedOfficers,\r\n        ...(selectedSchedule && { schedule_id: selectedSchedule.id })\r\n      };\r\n\r\n      const response = await fetch(CONFIG.SCHEDULES_API, {\r\n        method: 'POST', headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload)\r\n      });\r\n      const result = await response.json();\r\n      if (!result.success) throw new Error(result.message);\r\n      await loadSchedules();\r\n      closeModals();\r\n    } catch (error) {\r\n      console.error('Error saving schedule:', error);\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!selectedSchedule || !window.confirm('คุณแน่ใจหรือไม่ที่จะลบตารางเวรนี้?')) return;\r\n    setSaving(true);\r\n    try {\r\n      const payload = { action: 'delete_schedule', schedule_id: selectedSchedule.id };\r\n      const response = await fetch(CONFIG.SCHEDULES_API, {\r\n        method: 'POST', headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload)\r\n      });\r\n      const result = await response.json();\r\n      if (!result.success) throw new Error(result.message);\r\n      await loadSchedules();\r\n      closeModals();\r\n    } catch (error) {\r\n      console.error('Error deleting schedule:', error);\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const filteredSchedules = useMemo(() => {\r\n    return schedules.filter(schedule => {\r\n      const unitMatch = !filters.unit || schedule.unit_id === parseInt(filters.unit);\r\n      const officerMatch = !filters.officer ||\r\n        (schedule.officer_names && schedule.officer_names.toLowerCase().includes(filters.officer.toLowerCase()));\r\n      return unitMatch && officerMatch;\r\n    });\r\n  }, [schedules, filters]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-full\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col\">\r\n      <div className=\"border-b border-slate-200\">\r\n        <nav className=\"flex space-x-4 px-4\">\r\n          <button\r\n            onClick={() => setActiveTab('shifts')}\r\n            className={`flex items-center space-x-2 py-3 px-3 rounded-t-lg font-medium text-sm whitespace-nowrap ${activeTab === 'shifts' ? 'border-b-2 border-indigo-600 text-indigo-600' : 'text-slate-500 hover:text-slate-700'\r\n              }`}\r\n          >\r\n            <Shield className=\"w-4 h-4\" />\r\n            <span>เวรรักษาการ</span>\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('documents')}\r\n                className={`flex items-center space-x-2 py-3 px-3 rounded-t-lg font-medium text-sm whitespace-nowrap ${\r\n                    activeTab === 'documents' ? 'border-b-2 border-indigo-600 text-indigo-600' : 'text-slate-500 hover:text-slate-700'\r\n              }`}\r\n          >\r\n            <Briefcase className=\"w-4 h-4\" />\r\n            <span>จัดการโครงสร้าง</span>\r\n          </button>\r\n        </nav>\r\n      </div>\r\n\r\n      <div className=\"flex-grow p-4 bg-slate-50/50 overflow-y-auto\">\r\n        {activeTab === 'shifts' && (\r\n          <ShiftCalendarView\r\n            currentDate={currentDate}\r\n            schedules={filteredSchedules}\r\n            officers={officers}\r\n            shiftTypes={shiftTypes}\r\n            units={units}\r\n            holidays={holidays}\r\n            filters={filters}\r\n            setFilters={setFilters}\r\n            navigateMonth={navigateMonth}\r\n            goToToday={goToToday}\r\n            openAddModal={openAddModal}\r\n            openEditModal={openEditModal}\r\n          />\r\n        )}\r\n        {activeTab === 'documents' && <UnitStructureManagement />}\r\n      </div>\r\n\r\n      {(showAddModal || showEditModal) && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-3xl mx-4 max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"p-6 border-b\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900\">\r\n                {showEditModal ? 'แก้ไขตารางเวร' : 'เพิ่มตารางเวรใหม่'}\r\n              </h3>\r\n              {formData.duty_date && (\r\n                <p className=\"text-sm text-gray-600 mt-1\">\r\n                  วันที่ {new Date(formData.duty_date + 'T00:00:00').toLocaleDateString('th-TH')}\r\n                  {isHoliday(new Date(formData.duty_date + 'T00:00:00'), holidays) &&\r\n                    <span className=\"ml-2 px-2 py-0.5 bg-red-100 text-red-600 text-xs rounded-full\">วันหยุด</span>\r\n                  }\r\n                </p>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"p-6 space-y-6\">\r\n              {/* วันที่ */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">วันที่</label>\r\n                <input\r\n                  type=\"date\"\r\n                  value={formData.duty_date}\r\n                  onChange={(e) => {\r\n                    handleInputChange('duty_date', e.target.value);\r\n                    // อัปเดต shift type อัตโนมัติเมื่อเปลี่ยนวันที่\r\n                    const newDate = new Date(e.target.value + 'T00:00:00');\r\n                    const isHol = isHoliday(newDate, holidays);\r\n                    const suggestedType = getShiftTypeByPeriod(selectedShiftPeriod, isHol, shiftTypes);\r\n                    setFormData(prev => ({ ...prev, shift_type_id: suggestedType?.id || '' }));\r\n                  }}\r\n                  className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\r\n                />\r\n              </div>\r\n\r\n              {/* เลือกช่วงเวร */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-3\">ช่วงเวร</label>\r\n                <div className=\"flex space-x-3\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => {\r\n                      setSelectedShiftPeriod('day');\r\n                      const isHol = formData.duty_date ? isHoliday(new Date(formData.duty_date + 'T00:00:00'), holidays) : false;\r\n                                            const suggestedType = getShiftTypeByPeriod('day', isHol, shiftTypes);\r\n                                            setFormData(prev => ({ ...prev, shift_type_id: suggestedType?.id || '' }));\r\n                    }}\r\n                    className={`flex items-center px-4 py-2 rounded-lg border ${\r\n                        selectedShiftPeriod === 'day' \r\n                        ? 'bg-yellow-50 border-yellow-300 text-yellow-700'\r\n                        : 'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'\r\n                      }`}\r\n                  >\r\n                    <Sun className=\"w-4 h-4 mr-2\" />\r\n                    กลางวัน\r\n                  </button>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => {\r\n                      setSelectedShiftPeriod('night');\r\n                      const suggestedType = getShiftTypeByPeriod('night', false, shiftTypes);\r\n                      setFormData(prev => ({ ...prev, shift_type_id: suggestedType?.id || '' }));\r\n                    }}\r\n                    className={`flex items-center px-4 py-2 rounded-lg border ${\r\n                        selectedShiftPeriod === 'night' \r\n                        ? 'bg-indigo-50 border-indigo-300 text-indigo-700'\r\n                        : 'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'\r\n                      }`}\r\n                  >\r\n                    <Moon className=\"w-4 h-4 mr-2\" />\r\n                    กลางคืน\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* เลือกส่วนงาน (เช็คลิส) */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-3\">ส่วนงาน</label>\r\n                <div className=\"border border-gray-300 rounded-lg p-4 max-h-40 overflow-y-auto\">\r\n                  <div className=\"grid grid-cols-2 gap-2\">\r\n                    {Array.isArray(units) && units.map(unit => (\r\n                      <label key={unit.id} className=\"flex items-center py-1\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                                    checked={selectedUnits.includes(unit.id)}\r\n                                    onChange={() => handleUnitSelect(unit.id)}\r\n                                    className=\"h-4 w-4 text-indigo-600\"\r\n                        />\r\n                        <span className=\"ml-2 text-sm text-gray-900\">{unit.unit_name}</span>\r\n                      </label>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* เจ้าหน้าที่ที่เลือกแล้ว */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-3\">เจ้าหน้าที่ที่เลือก</label>\r\n                <div className=\"border border-gray-300 rounded-lg p-3 min-h-[100px]\">\r\n                  {selectedOfficers.length === 0 ? (\r\n                    <p className=\"text-gray-500 text-sm\">ยังไม่ได้เลือกเจ้าหน้าที่</p>\r\n                  ) : (\r\n                    <div className=\"space-y-2\">\r\n                      {selectedOfficers.map(officerId => {\r\n                        const officer = getOfficerById(officerId);\r\n                        return officer ? (\r\n                          <div key={officerId} className=\"flex items-center justify-between bg-gray-50 px-3 py-2 rounded-lg\">\r\n                            <span className=\"text-sm\">{officer.prefix} {officer.firstname} {officer.lastname}</span>\r\n                            <button\r\n                              onClick={() => handleOfficerRemove(officerId)}\r\n                              className=\"text-red-600 hover:text-red-800\"\r\n                            >\r\n                              <X className=\"w-4 h-4\" />\r\n                            </button>\r\n                          </div>\r\n                        ) : null;\r\n                      })}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* เพิ่มเจ้าหน้าที่ */}\r\n              <div>\r\n                <div className=\"flex items-center justify-between mb-3\">\r\n                  <label className=\"block text-sm font-medium text-gray-700\">จัดการเจ้าหน้าที่</label>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setShowOfficerList(!showOfficerList)}\r\n                    className=\"text-sm text-indigo-600 hover:text-indigo-800\"\r\n                  >\r\n                    {showOfficerList ? 'ซ่อน' : 'เพิ่มเจ้าหน้าที่'}\r\n                  </button>\r\n                </div>\r\n\r\n                {showOfficerList && (\r\n                  <div className=\"border border-gray-300 rounded-lg p-3\">\r\n                    {/* ช่องค้นหา */}\r\n                    <div className=\"mb-3\">\r\n                      <div className=\"flex items-center space-x-2\">\r\n                        <Search className=\"w-4 h-4 text-gray-500\" />\r\n                        <input\r\n                          type=\"text\"\r\n                          placeholder=\"ค้นหาชื่อเจ้าหน้าที่...\"\r\n                          value={officerSearchTerm}\r\n                          onChange={(e) => setOfficerSearchTerm(e.target.value)}\r\n                          className=\"flex-1 border border-gray-300 rounded px-2 py-1 text-sm\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* รายชื่อเจ้าหน้าที่ */}\r\n                    <div className=\"max-h-40 overflow-y-auto\">\r\n                      {getAvailableOfficers().length === 0 ? (\r\n                        <p className=\"text-gray-500 text-sm\">\r\n                          {selectedUnits.length === 0 ? 'กรุณาเลือกส่วนงานก่อน' :\r\n                            officerSearchTerm ? 'ไม่พบเจ้าหน้าที่ที่ค้นหา' : 'ไม่มีเจ้าหน้าที่ที่สามารถเลือกได้'}\r\n                                        </p>\r\n                      ) : (\r\n                        <div className=\"space-y-1\">\r\n                          {getAvailableOfficers().map(officer => (\r\n                            <div key={officer.id} className=\"flex items-center justify-between py-2 hover:bg-gray-50 px-2 rounded\">\r\n                              <span className=\"text-sm\">{officer.prefix} {officer.firstname} {officer.lastname}</span>\r\n                              <button\r\n                                onClick={() => {\r\n                                  handleOfficerAdd(officer.id);\r\n                                  setOfficerSearchTerm(''); // ล้างค่าค้นหาหลังเพิ่ม\r\n                                }}\r\n                                className=\"text-indigo-600 hover:text-indigo-800 p-1 rounded hover:bg-indigo-50\"\r\n                              >\r\n                                <Plus className=\"w-4 h-4\" />\r\n                              </button>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* หมายเหตุ */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">หมายเหตุ</label>\r\n                <textarea\r\n                  value={formData.notes}\r\n                  onChange={(e) => handleInputChange('notes', e.target.value)}\r\n                  rows={3}\r\n                  className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\r\n                  placeholder=\"รายละเอียดเพิ่มเติม...\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-6 border-t bg-gray-50 flex justify-between\">\r\n              <div>\r\n                {showEditModal && (\r\n                  <button\r\n                    onClick={handleDelete}\r\n                    disabled={saving}\r\n                    className=\"inline-flex items-center px-4 py-2 border border-red-300 text-sm font-medium rounded-lg text-red-700 bg-red-50 hover:bg-red-100\"\r\n                  >\r\n                    <Trash2 className=\"w-4 h-4 mr-2\" />ลบเวร\r\n                  </button>\r\n                )}\r\n              </div>\r\n              <div className=\"flex space-x-3\">\r\n                <button\r\n                  onClick={closeModals}\r\n                  disabled={saving}\r\n                  className=\"px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50\"\r\n                >\r\n                  ยกเลิก\r\n                </button>\r\n                <button\r\n                  onClick={handleSave}\r\n                  disabled={saving || selectedOfficers.length === 0}\r\n                  className=\"inline-flex items-center px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                >\r\n                  {saving ? (\r\n                    <>\r\n                      <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                      กำลังบันทึก...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <Save className=\"w-4 h-4 mr-2\" />บันทึก\r\n                    </>\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShiftWorkPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}