{"ast":null,"code":"import _objectSpread from\"C:/Users/LENOVO/Documents/GitHub/court-marshal-connect/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React from'react';import{X,Sun,Moon,Save,Plus,Trash2}from'lucide-react';// ฟังก์ชันตรวจสอบวันหยุด\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const isHoliday=function(date){let holidays=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];const dayOfWeek=date.getDay();if(dayOfWeek===0||dayOfWeek===6)return true;const isSameDay=(date1,date2)=>date1.toDateString()===date2.toDateString();return holidays.some(holiday=>isSameDay(new Date(holiday.date+'T00:00:00'),date));};const DutyScheduleModal=_ref=>{let{showModal,isEditMode,formData,setFormData,selectedShiftPeriod,setSelectedShiftPeriod,selectedUnits,setSelectedUnits,selectedHeadUnit,setSelectedHeadUnit,availableOfficers,manualAddedOfficers,setManualAddedOfficers,removedPositions,setRemovedPositions,manualSearch,setManualSearch,units,officers,holidays,saving,onClose,onSave,onDelete,showAlert}=_ref;if(!showModal)return null;// --- ฟังก์ชันจัดการการเลือกส่วนงาน ---\nconst handleUnitSelect=unitCode=>{setSelectedUnits(prev=>{const newUnits=prev.includes(unitCode)?prev.filter(code=>code!==unitCode):[...prev,unitCode];// ล้างการเลือกหน่วยงานหลักถ้าไม่มีส่วนงานที่เลือก\nif(newUnits.length===0){setSelectedHeadUnit('');}return newUnits;});};const handleHeadUnitSelect=unitCode=>{setSelectedHeadUnit(unitCode);};const handleAddManualOfficer=()=>{const q=manualSearch&&manualSearch.trim();if(!q)return showAlert('กรุณากรอกข้อมูลเพื่อค้นหา/เพิ่ม','error');// หาใน officers จาก unit_structure\nconst found=officers.find(o=>String(o.position_number)===q||\"\".concat(o.firstname,\" \").concat(o.lastname).toLowerCase().includes(q.toLowerCase()));if(found){// ถ้ายังไม่มีใน manualAdded หรือ available ให้เพิ่ม\nconst key=String(found.position_number);const already=manualAddedOfficers.find(a=>String(a.position_number)===key)||availableOfficers.find(a=>String(a.position_number)===key);if(already){showAlert('เจ้าหน้าที่คนนี้ถูกเพิ่มแล้ว','info');}else{setManualAddedOfficers(prev=>[...prev,found]);showAlert('เพิ่มเจ้าหน้าที่สำเร็จ','success');}}else{showAlert('ไม่พบเจ้าหน้าที่ตามคำค้น','error');}setManualSearch('');};const handleRemoveOfficer=positionNumber=>{const key=String(positionNumber);setRemovedPositions(prev=>[...prev,key]);};const handleRestoreOfficer=positionNumber=>{const key=String(positionNumber);setRemovedPositions(prev=>prev.filter(p=>p!==key));};const handleRemoveManualOfficer=positionNumber=>{const key=String(positionNumber);setManualAddedOfficers(prev=>prev.filter(o=>String(o.position_number)!==key));};// รวมรายการที่จะแสดง\nconst combinedOfficers=[];const mapPos=new Map();(availableOfficers||[]).forEach(o=>mapPos.set(String(o.position_number),_objectSpread(_objectSpread({},o),{},{source:'unit'})));(manualAddedOfficers||[]).forEach(o=>mapPos.set(String(o.position_number),_objectSpread(_objectSpread({},o),{},{source:'manual'})));for(const[pos,off]of mapPos.entries()){const isRemoved=removedPositions.includes(pos);combinedOfficers.push(_objectSpread(_objectSpread({},off),{},{isRemoved}));}return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4 text-white\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold\",children:isEditMode?'✏️ แก้ไขตารางเวร':'➕ เพิ่มตารางเวรใหม่'}),formData.duty_date&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-indigo-100 mt-1 flex items-center\",children:[\"\\uD83D\\uDCC5 \\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48 \",new Date(formData.duty_date+'T00:00:00').toLocaleDateString('th-TH',{weekday:'long',year:'numeric',month:'long',day:'numeric'}),isHoliday(new Date(formData.duty_date+'T00:00:00'),holidays)&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-3 px-2 py-1 bg-red-500 text-white text-xs rounded-full font-medium\",children:\"\\uD83C\\uDFD6\\uFE0F \\u0E27\\u0E31\\u0E19\\u0E2B\\u0E22\\u0E38\\u0E14\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"p-2 hover:bg-white/20 rounded-full transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-y-auto max-h-[calc(90vh-120px)]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-50 rounded-xl p-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-slate-700 mb-3 flex items-center\",children:\"\\uD83D\\uDCC5 \\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.duty_date,onChange:e=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{duty_date:e.target.value,day_type:isHoliday(new Date(e.target.value+'T00:00:00'),holidays)?'holiday':'normal'}));},className:\"w-full border-2 border-slate-300 rounded-lg px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all\"}),formData.duty_date&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 p-3 bg-white rounded-lg border-l-4 border-indigo-500\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-slate-700\",children:\"\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17\\u0E27\\u0E31\\u0E19:\"}),isHoliday(new Date(formData.duty_date+'T00:00:00'),holidays)?/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 px-2 py-1 bg-red-100 text-red-700 rounded-full font-medium\",children:\"\\uD83C\\uDFD6\\uFE0F \\u0E27\\u0E31\\u0E19\\u0E2B\\u0E22\\u0E38\\u0E14\"}):/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 px-2 py-1 bg-green-100 text-green-700 rounded-full font-medium\",children:\"\\uD83D\\uDCCB \\u0E27\\u0E31\\u0E19\\u0E1B\\u0E01\\u0E15\\u0E34\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-50 rounded-xl p-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-slate-700 mb-4 flex items-center\",children:\"\\u23F0 \\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E0A\\u0E48\\u0E27\\u0E07\\u0E40\\u0E27\\u0E23\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>{setSelectedShiftPeriod('day');setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{shift_type:'day'}));},className:\"flex items-center justify-center px-6 py-4 rounded-xl border-2 text-sm font-semibold transition-all \".concat(selectedShiftPeriod==='day'?'bg-gradient-to-r from-amber-50 to-orange-50 border-amber-300 text-amber-700 shadow-md':'bg-white border-slate-300 text-slate-700 hover:bg-slate-50'),children:[/*#__PURE__*/_jsx(Sun,{className:\"w-5 h-5 mr-3\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-left\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\uD83C\\uDF05 \\u0E01\\u0E25\\u0E32\\u0E07\\u0E27\\u0E31\\u0E19\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs opacity-75\",children:\"(08:30-16:30)\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>{setSelectedShiftPeriod('night');setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{shift_type:'night'}));},className:\"flex items-center justify-center px-6 py-4 rounded-xl border-2 text-sm font-semibold transition-all \".concat(selectedShiftPeriod==='night'?'bg-gradient-to-r from-indigo-50 to-blue-50 border-indigo-300 text-indigo-700 shadow-md':'bg-white border-slate-300 text-slate-700 hover:bg-slate-50'),children:[/*#__PURE__*/_jsx(Moon,{className:\"w-5 h-5 mr-3\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-left\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\uD83C\\uDF19 \\u0E01\\u0E25\\u0E32\\u0E07\\u0E04\\u0E37\\u0E19\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs opacity-75\",children:\"(16:30-08:30)\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-50 rounded-xl p-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-slate-700 mb-4 flex items-center\",children:\"\\uD83C\\uDFE2 \\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E07\\u0E32\\u0E19\\u0E17\\u0E35\\u0E48\\u0E40\\u0E02\\u0E49\\u0E32\\u0E40\\u0E27\\u0E23\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border-2 border-slate-300 rounded-lg p-4 max-h-40 overflow-y-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 gap-3\",children:Array.isArray(units)&&units.map(unit=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center p-2 hover:bg-slate-50 rounded-lg cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedUnits.includes(unit.unit_code),onChange:()=>handleUnitSelect(unit.unit_code),className:\"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-slate-300 rounded\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-3 text-sm font-medium text-slate-900\",children:unit.unit_name})]},unit.unit_code))})})]}),selectedUnits.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 rounded-xl p-4 border-2 border-blue-200\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-blue-800 mb-3 flex items-center\",children:\"\\uD83D\\uDC51 \\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E2B\\u0E19\\u0E48\\u0E27\\u0E22\\u0E07\\u0E32\\u0E19\\u0E2B\\u0E25\\u0E31\\u0E01\\u0E17\\u0E35\\u0E48\\u0E40\\u0E1B\\u0E47\\u0E19\\u0E2B\\u0E31\\u0E27\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E40\\u0E27\\u0E23\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 gap-2\",children:selectedUnits.map(unitCode=>{const unit=units.find(u=>u.unit_code===unitCode);return/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center p-2 bg-white rounded-lg cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"headUnit\",value:unitCode,checked:selectedHeadUnit===unitCode,onChange:()=>handleHeadUnitSelect(unitCode),className:\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-slate-300\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-3 text-sm font-medium text-slate-900\",children:unit===null||unit===void 0?void 0:unit.unit_name})]},unitCode);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-50 rounded-xl p-4\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-slate-700 mb-4 flex items-center\",children:[\"\\uD83D\\uDC65 \\u0E23\\u0E32\\u0E22\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48\\u0E17\\u0E35\\u0E48\\u0E08\\u0E30\\u0E40\\u0E02\\u0E49\\u0E32\\u0E40\\u0E27\\u0E23\",combinedOfficers.length>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 px-2 py-1 bg-indigo-100 text-indigo-700 text-xs rounded-full font-medium\",children:[combinedOfficers.filter(o=>!o.isRemoved).length,\" \\u0E04\\u0E19\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0E04\\u0E49\\u0E19\\u0E2B\\u0E32/\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48 (\\u0E23\\u0E30\\u0E1A\\u0E38\\u0E2B\\u0E21\\u0E32\\u0E22\\u0E40\\u0E25\\u0E02\\u0E15\\u0E33\\u0E41\\u0E2B\\u0E19\\u0E48\\u0E07\\u0E2B\\u0E23\\u0E37\\u0E2D\\u0E0A\\u0E37\\u0E48\\u0E2D)\",value:manualSearch,onChange:e=>setManualSearch(e.target.value),className:\"flex-1 border-2 border-slate-300 rounded-lg px-4 py-2 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\",onKeyPress:e=>e.key==='Enter'&&handleAddManualOfficer()}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:handleAddManualOfficer,className:\"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4 mr-1\"}),\"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border-2 border-slate-300 rounded-lg p-3 max-h-60 overflow-y-auto\",children:combinedOfficers.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:combinedOfficers.map((officer,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 rounded-lg border \".concat(officer.isRemoved?'bg-red-50 border-red-200 opacity-60':'bg-slate-50 border-slate-200'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full \".concat(officer.source==='manual'?'bg-blue-500':'bg-green-500')}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-medium text-slate-900\",children:[officer.prefix,\" \",officer.firstname,\" \",officer.lastname]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-slate-600\",children:[\"\\u0E15\\u0E33\\u0E41\\u0E2B\\u0E19\\u0E48\\u0E07: \",officer.position_number,\" | \",officer.unit_name]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-2\",children:officer.isRemoved?/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRestoreOfficer(officer.position_number),className:\"text-green-600 hover:text-green-800 text-sm font-medium\",children:\"\\u0E40\\u0E23\\u0E35\\u0E22\\u0E01\\u0E04\\u0E37\\u0E19\"}):/*#__PURE__*/_jsx(\"button\",{onClick:()=>officer.source==='manual'?handleRemoveManualOfficer(officer.position_number):handleRemoveOfficer(officer.position_number),className:\"text-red-600 hover:text-red-800\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})})]},index))}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-slate-500 py-8\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u0E22\\u0E31\\u0E07\\u0E44\\u0E21\\u0E48\\u0E21\\u0E35\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48\\u0E43\\u0E19\\u0E23\\u0E32\\u0E22\\u0E01\\u0E32\\u0E23\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"\\u0E01\\u0E23\\u0E38\\u0E13\\u0E32\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E07\\u0E32\\u0E19\\u0E2B\\u0E23\\u0E37\\u0E2D\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E40\\u0E08\\u0E49\\u0E32\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E17\\u0E35\\u0E48\\u0E14\\u0E49\\u0E27\\u0E22\\u0E15\\u0E19\\u0E40\\u0E2D\\u0E07\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between pt-6 border-t border-slate-200\",children:[isEditMode&&/*#__PURE__*/_jsxs(\"button\",{onClick:onDelete,disabled:saving,className:\"flex items-center px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\",children:[/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4 mr-2\"}),\"\\u0E25\\u0E1A\\u0E15\\u0E32\\u0E23\\u0E32\\u0E07\\u0E40\\u0E27\\u0E23\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3 ml-auto\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,disabled:saving,className:\"px-6 py-2 border-2 border-slate-300 text-sm font-medium rounded-lg text-slate-700 bg-white hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\",children:\"\\u0E22\\u0E01\\u0E40\\u0E25\\u0E34\\u0E01\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onSave,disabled:saving||combinedOfficers.filter(o=>!o.isRemoved).length===0||!selectedHeadUnit,className:\"inline-flex items-center px-6 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\",children:saving?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"}),\"\\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Save,{className:\"w-4 h-4 mr-2\"}),\"\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\"]})})]})]})]})})]})});};export default DutyScheduleModal;","map":{"version":3,"names":["React","X","Sun","Moon","Save","Plus","Trash2","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","isHoliday","date","holidays","arguments","length","undefined","dayOfWeek","getDay","isSameDay","date1","date2","toDateString","some","holiday","Date","DutyScheduleModal","_ref","showModal","isEditMode","formData","setFormData","selectedShiftPeriod","setSelectedShiftPeriod","selectedUnits","setSelectedUnits","selectedHeadUnit","setSelectedHeadUnit","availableOfficers","manualAddedOfficers","setManualAddedOfficers","removedPositions","setRemovedPositions","manualSearch","setManualSearch","units","officers","saving","onClose","onSave","onDelete","showAlert","handleUnitSelect","unitCode","prev","newUnits","includes","filter","code","handleHeadUnitSelect","handleAddManualOfficer","q","trim","found","find","o","String","position_number","concat","firstname","lastname","toLowerCase","key","already","a","handleRemoveOfficer","positionNumber","handleRestoreOfficer","p","handleRemoveManualOfficer","combinedOfficers","mapPos","Map","forEach","set","_objectSpread","source","pos","off","entries","isRemoved","push","className","children","duty_date","toLocaleDateString","weekday","year","month","day","onClick","type","value","onChange","e","target","day_type","shift_type","Array","isArray","map","unit","checked","unit_code","unit_name","u","name","placeholder","onKeyPress","officer","index","prefix","disabled"],"sources":["C:/Users/LENOVO/Documents/GitHub/court-marshal-connect/src/components/ShiftWork/DutyScheduleModal.js"],"sourcesContent":["import React from 'react';\r\nimport { X, Sun, Moon, Save, Plus, Trash2 } from 'lucide-react';\r\n\r\n// ฟังก์ชันตรวจสอบวันหยุด\r\nconst isHoliday = (date, holidays = []) => {\r\n  const dayOfWeek = date.getDay();\r\n  if (dayOfWeek === 0 || dayOfWeek === 6) return true;\r\n  const isSameDay = (date1, date2) => date1.toDateString() === date2.toDateString();\r\n  return holidays.some(holiday => isSameDay(new Date(holiday.date + 'T00:00:00'), date));\r\n};\r\n\r\nconst DutyScheduleModal = ({\r\n  showModal,\r\n  isEditMode,\r\n  formData,\r\n  setFormData,\r\n  selectedShiftPeriod,\r\n  setSelectedShiftPeriod,\r\n  selectedUnits,\r\n  setSelectedUnits,\r\n  selectedHeadUnit,\r\n  setSelectedHeadUnit,\r\n  availableOfficers,\r\n  manualAddedOfficers,\r\n  setManualAddedOfficers,\r\n  removedPositions,\r\n  setRemovedPositions,\r\n  manualSearch,\r\n  setManualSearch,\r\n  units,\r\n  officers,\r\n  holidays,\r\n  saving,\r\n  onClose,\r\n  onSave,\r\n  onDelete,\r\n  showAlert\r\n}) => {\r\n  if (!showModal) return null;\r\n\r\n  // --- ฟังก์ชันจัดการการเลือกส่วนงาน ---\r\n  const handleUnitSelect = (unitCode) => {\r\n    setSelectedUnits(prev => {\r\n      const newUnits = prev.includes(unitCode)\r\n        ? prev.filter(code => code !== unitCode)\r\n        : [...prev, unitCode];\r\n      \r\n      // ล้างการเลือกหน่วยงานหลักถ้าไม่มีส่วนงานที่เลือก\r\n      if (newUnits.length === 0) {\r\n        setSelectedHeadUnit('');\r\n      }\r\n      \r\n      return newUnits;\r\n    });\r\n  };\r\n\r\n  const handleHeadUnitSelect = (unitCode) => {\r\n    setSelectedHeadUnit(unitCode);\r\n  };\r\n\r\n  const handleAddManualOfficer = () => {\r\n    const q = manualSearch && manualSearch.trim();\r\n    if (!q) return showAlert('กรุณากรอกข้อมูลเพื่อค้นหา/เพิ่ม', 'error');\r\n    \r\n    // หาใน officers จาก unit_structure\r\n    const found = officers.find(o => \r\n      String(o.position_number) === q || \r\n      (`${o.firstname} ${o.lastname}`).toLowerCase().includes(q.toLowerCase())\r\n    );\r\n    \r\n    if (found) {\r\n      // ถ้ายังไม่มีใน manualAdded หรือ available ให้เพิ่ม\r\n      const key = String(found.position_number);\r\n      const already = manualAddedOfficers.find(a => String(a.position_number) === key) || \r\n                     availableOfficers.find(a => String(a.position_number) === key);\r\n      \r\n      if (already) {\r\n        showAlert('เจ้าหน้าที่คนนี้ถูกเพิ่มแล้ว', 'info');\r\n      } else {\r\n        setManualAddedOfficers(prev => [...prev, found]);\r\n        showAlert('เพิ่มเจ้าหน้าที่สำเร็จ', 'success');\r\n      }\r\n    } else {\r\n      showAlert('ไม่พบเจ้าหน้าที่ตามคำค้น', 'error');\r\n    }\r\n    setManualSearch('');\r\n  };\r\n\r\n  const handleRemoveOfficer = (positionNumber) => {\r\n    const key = String(positionNumber);\r\n    setRemovedPositions(prev => [...prev, key]);\r\n  };\r\n\r\n  const handleRestoreOfficer = (positionNumber) => {\r\n    const key = String(positionNumber);\r\n    setRemovedPositions(prev => prev.filter(p => p !== key));\r\n  };\r\n\r\n  const handleRemoveManualOfficer = (positionNumber) => {\r\n    const key = String(positionNumber);\r\n    setManualAddedOfficers(prev => prev.filter(o => String(o.position_number) !== key));\r\n  };\r\n\r\n  // รวมรายการที่จะแสดง\r\n  const combinedOfficers = [];\r\n  const mapPos = new Map();\r\n  (availableOfficers || []).forEach(o => mapPos.set(String(o.position_number), { ...o, source: 'unit' }));\r\n  (manualAddedOfficers || []).forEach(o => mapPos.set(String(o.position_number), { ...o, source: 'manual' }));\r\n\r\n  for (const [pos, off] of mapPos.entries()) {\r\n    const isRemoved = removedPositions.includes(pos);\r\n    combinedOfficers.push({ ...off, isRemoved });\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden\">\r\n        {/* Header */}\r\n        <div className=\"bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4 text-white\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h3 className=\"text-xl font-bold\">\r\n                {isEditMode ? '✏️ แก้ไขตารางเวร' : '➕ เพิ่มตารางเวรใหม่'}\r\n              </h3>\r\n              {formData.duty_date && (\r\n                <p className=\"text-indigo-100 mt-1 flex items-center\">\r\n                  📅 วันที่ {new Date(formData.duty_date + 'T00:00:00').toLocaleDateString('th-TH', { \r\n                    weekday: 'long',\r\n                    year: 'numeric', \r\n                    month: 'long', \r\n                    day: 'numeric' \r\n                  })}\r\n                  {isHoliday(new Date(formData.duty_date + 'T00:00:00'), holidays) && (\r\n                    <span className=\"ml-3 px-2 py-1 bg-red-500 text-white text-xs rounded-full font-medium\">\r\n                      🏖️ วันหยุด\r\n                    </span>\r\n                  )}\r\n                </p>\r\n              )}\r\n            </div>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"p-2 hover:bg-white/20 rounded-full transition-colors\"\r\n            >\r\n              <X className=\"w-6 h-6\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"overflow-y-auto max-h-[calc(90vh-120px)]\">\r\n          <div className=\"p-6 space-y-6\">\r\n            {/* วันที่ */}\r\n            <div className=\"bg-slate-50 rounded-xl p-4\">\r\n              <label className=\"block text-sm font-semibold text-slate-700 mb-3 flex items-center\">\r\n                📅 เลือกวันที่\r\n              </label>\r\n              <input\r\n                type=\"date\"\r\n                value={formData.duty_date}\r\n                onChange={(e) => {\r\n                  setFormData(prev => ({ \r\n                    ...prev, \r\n                    duty_date: e.target.value,\r\n                    day_type: isHoliday(new Date(e.target.value + 'T00:00:00'), holidays) ? 'holiday' : 'normal'\r\n                  }));\r\n                }}\r\n                className=\"w-full border-2 border-slate-300 rounded-lg px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all\"\r\n              />\r\n              \r\n              {/* แสดงประเภทวัน */}\r\n              {formData.duty_date && (\r\n                <div className=\"mt-3 p-3 bg-white rounded-lg border-l-4 border-indigo-500\">\r\n                  <div className=\"flex items-center text-sm\">\r\n                    <span className=\"font-medium text-slate-700\">ประเภทวัน:</span>\r\n                    {isHoliday(new Date(formData.duty_date + 'T00:00:00'), holidays) ? (\r\n                      <span className=\"ml-2 px-2 py-1 bg-red-100 text-red-700 rounded-full font-medium\">\r\n                        🏖️ วันหยุด\r\n                      </span>\r\n                    ) : (\r\n                      <span className=\"ml-2 px-2 py-1 bg-green-100 text-green-700 rounded-full font-medium\">\r\n                        📋 วันปกติ\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* เลือกช่วงเวร */}\r\n            <div className=\"bg-slate-50 rounded-xl p-4\">\r\n              <label className=\"block text-sm font-semibold text-slate-700 mb-4 flex items-center\">\r\n                ⏰ เลือกช่วงเวร\r\n              </label>\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    setSelectedShiftPeriod('day');\r\n                    setFormData(prev => ({ ...prev, shift_type: 'day' }));\r\n                  }}\r\n                  className={`flex items-center justify-center px-6 py-4 rounded-xl border-2 text-sm font-semibold transition-all ${\r\n                    selectedShiftPeriod === 'day' \r\n                      ? 'bg-gradient-to-r from-amber-50 to-orange-50 border-amber-300 text-amber-700 shadow-md'\r\n                      : 'bg-white border-slate-300 text-slate-700 hover:bg-slate-50'\r\n                  }`}\r\n                >\r\n                  <Sun className=\"w-5 h-5 mr-3\" />\r\n                  <div className=\"text-left\">\r\n                    <div>🌅 กลางวัน</div>\r\n                    <div className=\"text-xs opacity-75\">(08:30-16:30)</div>\r\n                  </div>\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    setSelectedShiftPeriod('night');\r\n                    setFormData(prev => ({ ...prev, shift_type: 'night' }));\r\n                  }}\r\n                  className={`flex items-center justify-center px-6 py-4 rounded-xl border-2 text-sm font-semibold transition-all ${\r\n                    selectedShiftPeriod === 'night' \r\n                      ? 'bg-gradient-to-r from-indigo-50 to-blue-50 border-indigo-300 text-indigo-700 shadow-md'\r\n                      : 'bg-white border-slate-300 text-slate-700 hover:bg-slate-50'\r\n                  }`}\r\n                >\r\n                  <Moon className=\"w-5 h-5 mr-3\" />\r\n                  <div className=\"text-left\">\r\n                    <div>🌙 กลางคืน</div>\r\n                    <div className=\"text-xs opacity-75\">(16:30-08:30)</div>\r\n                  </div>\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* เลือกส่วนงาน */}\r\n            <div className=\"bg-slate-50 rounded-xl p-4\">\r\n              <label className=\"block text-sm font-semibold text-slate-700 mb-4 flex items-center\">\r\n                🏢 เลือกส่วนงานที่เข้าเวร\r\n              </label>\r\n              <div className=\"bg-white border-2 border-slate-300 rounded-lg p-4 max-h-40 overflow-y-auto\">\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\r\n                  {Array.isArray(units) && units.map(unit => (\r\n                    <label key={unit.unit_code} className=\"flex items-center p-2 hover:bg-slate-50 rounded-lg cursor-pointer\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedUnits.includes(unit.unit_code)}\r\n                        onChange={() => handleUnitSelect(unit.unit_code)}\r\n                        className=\"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-slate-300 rounded\"\r\n                      />\r\n                      <span className=\"ml-3 text-sm font-medium text-slate-900\">{unit.unit_name}</span>\r\n                    </label>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* เลือกหน่วยงานหลัก */}\r\n            {selectedUnits.length > 0 && (\r\n              <div className=\"bg-blue-50 rounded-xl p-4 border-2 border-blue-200\">\r\n                <label className=\"block text-sm font-semibold text-blue-800 mb-3 flex items-center\">\r\n                  👑 เลือกหน่วยงานหลักที่เป็นหัวหน้าเวร\r\n                </label>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\r\n                  {selectedUnits.map(unitCode => {\r\n                    const unit = units.find(u => u.unit_code === unitCode);\r\n                    return (\r\n                      <label key={unitCode} className=\"flex items-center p-2 bg-white rounded-lg cursor-pointer\">\r\n                        <input\r\n                          type=\"radio\"\r\n                          name=\"headUnit\"\r\n                          value={unitCode}\r\n                          checked={selectedHeadUnit === unitCode}\r\n                          onChange={() => handleHeadUnitSelect(unitCode)}\r\n                          className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-slate-300\"\r\n                        />\r\n                        <span className=\"ml-3 text-sm font-medium text-slate-900\">{unit?.unit_name}</span>\r\n                      </label>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* รายชื่อเจ้าหน้าที่ */}\r\n            <div className=\"bg-slate-50 rounded-xl p-4\">\r\n              <label className=\"block text-sm font-semibold text-slate-700 mb-4 flex items-center\">\r\n                👥 รายชื่อเจ้าหน้าที่ที่จะเข้าเวร\r\n                {combinedOfficers.length > 0 && (\r\n                  <span className=\"ml-2 px-2 py-1 bg-indigo-100 text-indigo-700 text-xs rounded-full font-medium\">\r\n                    {combinedOfficers.filter(o => !o.isRemoved).length} คน\r\n                  </span>\r\n                )}\r\n              </label>\r\n\r\n              {/* Manual search / add */}\r\n              <div className=\"mb-4 flex items-center space-x-2\">\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"ค้นหา/เพิ่มเจ้าหน้าที่ (ระบุหมายเลขตำแหน่งหรือชื่อ)\"\r\n                  value={manualSearch}\r\n                  onChange={(e) => setManualSearch(e.target.value)}\r\n                  className=\"flex-1 border-2 border-slate-300 rounded-lg px-4 py-2 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"\r\n                  onKeyPress={(e) => e.key === 'Enter' && handleAddManualOfficer()}\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleAddManualOfficer}\r\n                  className=\"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors\"\r\n                >\r\n                  <Plus className=\"w-4 h-4 mr-1\" />\r\n                  เพิ่ม\r\n                </button>\r\n              </div>\r\n\r\n              {/* Officers list */}\r\n              <div className=\"bg-white border-2 border-slate-300 rounded-lg p-3 max-h-60 overflow-y-auto\">\r\n                {combinedOfficers.length > 0 ? (\r\n                  <div className=\"space-y-2\">\r\n                    {combinedOfficers.map((officer, index) => (\r\n                      <div\r\n                        key={index}\r\n                        className={`flex items-center justify-between p-3 rounded-lg border ${\r\n                          officer.isRemoved \r\n                            ? 'bg-red-50 border-red-200 opacity-60' \r\n                            : 'bg-slate-50 border-slate-200'\r\n                        }`}\r\n                      >\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <div className={`w-2 h-2 rounded-full ${\r\n                            officer.source === 'manual' ? 'bg-blue-500' : 'bg-green-500'\r\n                          }`}></div>\r\n                          <div>\r\n                            <div className=\"font-medium text-slate-900\">\r\n                              {officer.prefix} {officer.firstname} {officer.lastname}\r\n                            </div>\r\n                            <div className=\"text-xs text-slate-600\">\r\n                              ตำแหน่ง: {officer.position_number} | {officer.unit_name}\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"flex items-center space-x-2\">\r\n                          {officer.isRemoved ? (\r\n                            <button\r\n                              onClick={() => handleRestoreOfficer(officer.position_number)}\r\n                              className=\"text-green-600 hover:text-green-800 text-sm font-medium\"\r\n                            >\r\n                              เรียกคืน\r\n                            </button>\r\n                          ) : (\r\n                            <button\r\n                              onClick={() => officer.source === 'manual' \r\n                                ? handleRemoveManualOfficer(officer.position_number)\r\n                                : handleRemoveOfficer(officer.position_number)\r\n                              }\r\n                              className=\"text-red-600 hover:text-red-800\"\r\n                            >\r\n                              <Trash2 className=\"w-4 h-4\" />\r\n                            </button>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"text-center text-slate-500 py-8\">\r\n                    <p>ยังไม่มีเจ้าหน้าที่ในรายการ</p>\r\n                    <p className=\"text-sm\">กรุณาเลือกส่วนงานหรือเพิ่มเจ้าหน้าที่ด้วยตนเอง</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Action Buttons */}\r\n            <div className=\"flex items-center justify-between pt-6 border-t border-slate-200\">\r\n              {isEditMode && (\r\n                <button\r\n                  onClick={onDelete}\r\n                  disabled={saving}\r\n                  className=\"flex items-center px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                >\r\n                  <Trash2 className=\"w-4 h-4 mr-2\" />\r\n                  ลบตารางเวร\r\n                </button>\r\n              )}\r\n              <div className=\"flex space-x-3 ml-auto\">\r\n                <button\r\n                  onClick={onClose}\r\n                  disabled={saving}\r\n                  className=\"px-6 py-2 border-2 border-slate-300 text-sm font-medium rounded-lg text-slate-700 bg-white hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                >\r\n                  ยกเลิก\r\n                </button>\r\n                <button\r\n                  onClick={onSave}\r\n                  disabled={saving || combinedOfficers.filter(o => !o.isRemoved).length === 0 || !selectedHeadUnit}\r\n                  className=\"inline-flex items-center px-6 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                >\r\n                  {saving ? (\r\n                    <>\r\n                      <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                      กำลังบันทึก...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <Save className=\"w-4 h-4 mr-2\" />\r\n                      บันทึก\r\n                    </>\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DutyScheduleModal;\r\n"],"mappings":"2IAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,CAAC,CAAEC,GAAG,CAAEC,IAAI,CAAEC,IAAI,CAAEC,IAAI,CAAEC,MAAM,KAAQ,cAAc,CAE/D;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBACA,KAAM,CAAAC,SAAS,CAAG,QAAAA,CAACC,IAAI,CAAoB,IAAlB,CAAAC,QAAQ,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,EAAE,CACpC,KAAM,CAAAG,SAAS,CAAGL,IAAI,CAACM,MAAM,CAAC,CAAC,CAC/B,GAAID,SAAS,GAAK,CAAC,EAAIA,SAAS,GAAK,CAAC,CAAE,MAAO,KAAI,CACnD,KAAM,CAAAE,SAAS,CAAGA,CAACC,KAAK,CAAEC,KAAK,GAAKD,KAAK,CAACE,YAAY,CAAC,CAAC,GAAKD,KAAK,CAACC,YAAY,CAAC,CAAC,CACjF,MAAO,CAAAT,QAAQ,CAACU,IAAI,CAACC,OAAO,EAAIL,SAAS,CAAC,GAAI,CAAAM,IAAI,CAACD,OAAO,CAACZ,IAAI,CAAG,WAAW,CAAC,CAAEA,IAAI,CAAC,CAAC,CACxF,CAAC,CAED,KAAM,CAAAc,iBAAiB,CAAGC,IAAA,EA0BpB,IA1BqB,CACzBC,SAAS,CACTC,UAAU,CACVC,QAAQ,CACRC,WAAW,CACXC,mBAAmB,CACnBC,sBAAsB,CACtBC,aAAa,CACbC,gBAAgB,CAChBC,gBAAgB,CAChBC,mBAAmB,CACnBC,iBAAiB,CACjBC,mBAAmB,CACnBC,sBAAsB,CACtBC,gBAAgB,CAChBC,mBAAmB,CACnBC,YAAY,CACZC,eAAe,CACfC,KAAK,CACLC,QAAQ,CACRjC,QAAQ,CACRkC,MAAM,CACNC,OAAO,CACPC,MAAM,CACNC,QAAQ,CACRC,SACF,CAAC,CAAAxB,IAAA,CACC,GAAI,CAACC,SAAS,CAAE,MAAO,KAAI,CAE3B;AACA,KAAM,CAAAwB,gBAAgB,CAAIC,QAAQ,EAAK,CACrClB,gBAAgB,CAACmB,IAAI,EAAI,CACvB,KAAM,CAAAC,QAAQ,CAAGD,IAAI,CAACE,QAAQ,CAACH,QAAQ,CAAC,CACpCC,IAAI,CAACG,MAAM,CAACC,IAAI,EAAIA,IAAI,GAAKL,QAAQ,CAAC,CACtC,CAAC,GAAGC,IAAI,CAAED,QAAQ,CAAC,CAEvB;AACA,GAAIE,QAAQ,CAACxC,MAAM,GAAK,CAAC,CAAE,CACzBsB,mBAAmB,CAAC,EAAE,CAAC,CACzB,CAEA,MAAO,CAAAkB,QAAQ,CACjB,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAI,oBAAoB,CAAIN,QAAQ,EAAK,CACzChB,mBAAmB,CAACgB,QAAQ,CAAC,CAC/B,CAAC,CAED,KAAM,CAAAO,sBAAsB,CAAGA,CAAA,GAAM,CACnC,KAAM,CAAAC,CAAC,CAAGlB,YAAY,EAAIA,YAAY,CAACmB,IAAI,CAAC,CAAC,CAC7C,GAAI,CAACD,CAAC,CAAE,MAAO,CAAAV,SAAS,CAAC,iCAAiC,CAAE,OAAO,CAAC,CAEpE;AACA,KAAM,CAAAY,KAAK,CAAGjB,QAAQ,CAACkB,IAAI,CAACC,CAAC,EAC3BC,MAAM,CAACD,CAAC,CAACE,eAAe,CAAC,GAAKN,CAAC,EAC/B,GAAAO,MAAA,CAAIH,CAAC,CAACI,SAAS,MAAAD,MAAA,CAAIH,CAAC,CAACK,QAAQ,EAAIC,WAAW,CAAC,CAAC,CAACf,QAAQ,CAACK,CAAC,CAACU,WAAW,CAAC,CAAC,CACzE,CAAC,CAED,GAAIR,KAAK,CAAE,CACT;AACA,KAAM,CAAAS,GAAG,CAAGN,MAAM,CAACH,KAAK,CAACI,eAAe,CAAC,CACzC,KAAM,CAAAM,OAAO,CAAGlC,mBAAmB,CAACyB,IAAI,CAACU,CAAC,EAAIR,MAAM,CAACQ,CAAC,CAACP,eAAe,CAAC,GAAKK,GAAG,CAAC,EACjElC,iBAAiB,CAAC0B,IAAI,CAACU,CAAC,EAAIR,MAAM,CAACQ,CAAC,CAACP,eAAe,CAAC,GAAKK,GAAG,CAAC,CAE7E,GAAIC,OAAO,CAAE,CACXtB,SAAS,CAAC,8BAA8B,CAAE,MAAM,CAAC,CACnD,CAAC,IAAM,CACLX,sBAAsB,CAACc,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAES,KAAK,CAAC,CAAC,CAChDZ,SAAS,CAAC,wBAAwB,CAAE,SAAS,CAAC,CAChD,CACF,CAAC,IAAM,CACLA,SAAS,CAAC,0BAA0B,CAAE,OAAO,CAAC,CAChD,CACAP,eAAe,CAAC,EAAE,CAAC,CACrB,CAAC,CAED,KAAM,CAAA+B,mBAAmB,CAAIC,cAAc,EAAK,CAC9C,KAAM,CAAAJ,GAAG,CAAGN,MAAM,CAACU,cAAc,CAAC,CAClClC,mBAAmB,CAACY,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAEkB,GAAG,CAAC,CAAC,CAC7C,CAAC,CAED,KAAM,CAAAK,oBAAoB,CAAID,cAAc,EAAK,CAC/C,KAAM,CAAAJ,GAAG,CAAGN,MAAM,CAACU,cAAc,CAAC,CAClClC,mBAAmB,CAACY,IAAI,EAAIA,IAAI,CAACG,MAAM,CAACqB,CAAC,EAAIA,CAAC,GAAKN,GAAG,CAAC,CAAC,CAC1D,CAAC,CAED,KAAM,CAAAO,yBAAyB,CAAIH,cAAc,EAAK,CACpD,KAAM,CAAAJ,GAAG,CAAGN,MAAM,CAACU,cAAc,CAAC,CAClCpC,sBAAsB,CAACc,IAAI,EAAIA,IAAI,CAACG,MAAM,CAACQ,CAAC,EAAIC,MAAM,CAACD,CAAC,CAACE,eAAe,CAAC,GAAKK,GAAG,CAAC,CAAC,CACrF,CAAC,CAED;AACA,KAAM,CAAAQ,gBAAgB,CAAG,EAAE,CAC3B,KAAM,CAAAC,MAAM,CAAG,GAAI,CAAAC,GAAG,CAAC,CAAC,CACxB,CAAC5C,iBAAiB,EAAI,EAAE,EAAE6C,OAAO,CAAClB,CAAC,EAAIgB,MAAM,CAACG,GAAG,CAAClB,MAAM,CAACD,CAAC,CAACE,eAAe,CAAC,CAAAkB,aAAA,CAAAA,aAAA,IAAOpB,CAAC,MAAEqB,MAAM,CAAE,MAAM,EAAE,CAAC,CAAC,CACvG,CAAC/C,mBAAmB,EAAI,EAAE,EAAE4C,OAAO,CAAClB,CAAC,EAAIgB,MAAM,CAACG,GAAG,CAAClB,MAAM,CAACD,CAAC,CAACE,eAAe,CAAC,CAAAkB,aAAA,CAAAA,aAAA,IAAOpB,CAAC,MAAEqB,MAAM,CAAE,QAAQ,EAAE,CAAC,CAAC,CAE3G,IAAK,KAAM,CAACC,GAAG,CAAEC,GAAG,CAAC,EAAI,CAAAP,MAAM,CAACQ,OAAO,CAAC,CAAC,CAAE,CACzC,KAAM,CAAAC,SAAS,CAAGjD,gBAAgB,CAACe,QAAQ,CAAC+B,GAAG,CAAC,CAChDP,gBAAgB,CAACW,IAAI,CAAAN,aAAA,CAAAA,aAAA,IAAMG,GAAG,MAAEE,SAAS,EAAE,CAAC,CAC9C,CAEA,mBACEpF,IAAA,QAAKsF,SAAS,CAAC,sFAAsF,CAAAC,QAAA,cACnGrF,KAAA,QAAKoF,SAAS,CAAC,+EAA+E,CAAAC,QAAA,eAE5FvF,IAAA,QAAKsF,SAAS,CAAC,qEAAqE,CAAAC,QAAA,cAClFrF,KAAA,QAAKoF,SAAS,CAAC,mCAAmC,CAAAC,QAAA,eAChDrF,KAAA,QAAAqF,QAAA,eACEvF,IAAA,OAAIsF,SAAS,CAAC,mBAAmB,CAAAC,QAAA,CAC9BhE,UAAU,CAAG,kBAAkB,CAAG,qBAAqB,CACtD,CAAC,CACJC,QAAQ,CAACgE,SAAS,eACjBtF,KAAA,MAAGoF,SAAS,CAAC,wCAAwC,CAAAC,QAAA,EAAC,oDAC1C,CAAC,GAAI,CAAApE,IAAI,CAACK,QAAQ,CAACgE,SAAS,CAAG,WAAW,CAAC,CAACC,kBAAkB,CAAC,OAAO,CAAE,CAChFC,OAAO,CAAE,MAAM,CACfC,IAAI,CAAE,SAAS,CACfC,KAAK,CAAE,MAAM,CACbC,GAAG,CAAE,SACP,CAAC,CAAC,CACDxF,SAAS,CAAC,GAAI,CAAAc,IAAI,CAACK,QAAQ,CAACgE,SAAS,CAAG,WAAW,CAAC,CAAEjF,QAAQ,CAAC,eAC9DP,IAAA,SAAMsF,SAAS,CAAC,uEAAuE,CAAAC,QAAA,CAAC,+DAExF,CAAM,CACP,EACA,CACJ,EACE,CAAC,cACNvF,IAAA,WACE8F,OAAO,CAAEpD,OAAQ,CACjB4C,SAAS,CAAC,sDAAsD,CAAAC,QAAA,cAEhEvF,IAAA,CAACP,CAAC,EAAC6F,SAAS,CAAC,SAAS,CAAE,CAAC,CACnB,CAAC,EACN,CAAC,CACH,CAAC,cAENtF,IAAA,QAAKsF,SAAS,CAAC,0CAA0C,CAAAC,QAAA,cACvDrF,KAAA,QAAKoF,SAAS,CAAC,eAAe,CAAAC,QAAA,eAE5BrF,KAAA,QAAKoF,SAAS,CAAC,4BAA4B,CAAAC,QAAA,eACzCvF,IAAA,UAAOsF,SAAS,CAAC,mEAAmE,CAAAC,QAAA,CAAC,iFAErF,CAAO,CAAC,cACRvF,IAAA,UACE+F,IAAI,CAAC,MAAM,CACXC,KAAK,CAAExE,QAAQ,CAACgE,SAAU,CAC1BS,QAAQ,CAAGC,CAAC,EAAK,CACfzE,WAAW,CAACuB,IAAI,EAAA+B,aAAA,CAAAA,aAAA,IACX/B,IAAI,MACPwC,SAAS,CAAEU,CAAC,CAACC,MAAM,CAACH,KAAK,CACzBI,QAAQ,CAAE/F,SAAS,CAAC,GAAI,CAAAc,IAAI,CAAC+E,CAAC,CAACC,MAAM,CAACH,KAAK,CAAG,WAAW,CAAC,CAAEzF,QAAQ,CAAC,CAAG,SAAS,CAAG,QAAQ,EAC5F,CAAC,CACL,CAAE,CACF+E,SAAS,CAAC,4JAA4J,CACvK,CAAC,CAGD9D,QAAQ,CAACgE,SAAS,eACjBxF,IAAA,QAAKsF,SAAS,CAAC,2DAA2D,CAAAC,QAAA,cACxErF,KAAA,QAAKoF,SAAS,CAAC,2BAA2B,CAAAC,QAAA,eACxCvF,IAAA,SAAMsF,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,yDAAU,CAAM,CAAC,CAC7DlF,SAAS,CAAC,GAAI,CAAAc,IAAI,CAACK,QAAQ,CAACgE,SAAS,CAAG,WAAW,CAAC,CAAEjF,QAAQ,CAAC,cAC9DP,IAAA,SAAMsF,SAAS,CAAC,iEAAiE,CAAAC,QAAA,CAAC,+DAElF,CAAM,CAAC,cAEPvF,IAAA,SAAMsF,SAAS,CAAC,qEAAqE,CAAAC,QAAA,CAAC,yDAEtF,CAAM,CACP,EACE,CAAC,CACH,CACN,EACE,CAAC,cAGNrF,KAAA,QAAKoF,SAAS,CAAC,4BAA4B,CAAAC,QAAA,eACzCvF,IAAA,UAAOsF,SAAS,CAAC,mEAAmE,CAAAC,QAAA,CAAC,iFAErF,CAAO,CAAC,cACRrF,KAAA,QAAKoF,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrCrF,KAAA,WACE6F,IAAI,CAAC,QAAQ,CACbD,OAAO,CAAEA,CAAA,GAAM,CACbnE,sBAAsB,CAAC,KAAK,CAAC,CAC7BF,WAAW,CAACuB,IAAI,EAAA+B,aAAA,CAAAA,aAAA,IAAU/B,IAAI,MAAEqD,UAAU,CAAE,KAAK,EAAG,CAAC,CACvD,CAAE,CACFf,SAAS,wGAAAxB,MAAA,CACPpC,mBAAmB,GAAK,KAAK,CACzB,uFAAuF,CACvF,4DAA4D,CAC/D,CAAA6D,QAAA,eAEHvF,IAAA,CAACN,GAAG,EAAC4F,SAAS,CAAC,cAAc,CAAE,CAAC,cAChCpF,KAAA,QAAKoF,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBvF,IAAA,QAAAuF,QAAA,CAAK,yDAAU,CAAK,CAAC,cACrBvF,IAAA,QAAKsF,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAAC,eAAa,CAAK,CAAC,EACpD,CAAC,EACA,CAAC,cACTrF,KAAA,WACE6F,IAAI,CAAC,QAAQ,CACbD,OAAO,CAAEA,CAAA,GAAM,CACbnE,sBAAsB,CAAC,OAAO,CAAC,CAC/BF,WAAW,CAACuB,IAAI,EAAA+B,aAAA,CAAAA,aAAA,IAAU/B,IAAI,MAAEqD,UAAU,CAAE,OAAO,EAAG,CAAC,CACzD,CAAE,CACFf,SAAS,wGAAAxB,MAAA,CACPpC,mBAAmB,GAAK,OAAO,CAC3B,wFAAwF,CACxF,4DAA4D,CAC/D,CAAA6D,QAAA,eAEHvF,IAAA,CAACL,IAAI,EAAC2F,SAAS,CAAC,cAAc,CAAE,CAAC,cACjCpF,KAAA,QAAKoF,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBvF,IAAA,QAAAuF,QAAA,CAAK,yDAAU,CAAK,CAAC,cACrBvF,IAAA,QAAKsF,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAAC,eAAa,CAAK,CAAC,EACpD,CAAC,EACA,CAAC,EACN,CAAC,EACH,CAAC,cAGNrF,KAAA,QAAKoF,SAAS,CAAC,4BAA4B,CAAAC,QAAA,eACzCvF,IAAA,UAAOsF,SAAS,CAAC,mEAAmE,CAAAC,QAAA,CAAC,mJAErF,CAAO,CAAC,cACRvF,IAAA,QAAKsF,SAAS,CAAC,4EAA4E,CAAAC,QAAA,cACzFvF,IAAA,QAAKsF,SAAS,CAAC,uCAAuC,CAAAC,QAAA,CACnDe,KAAK,CAACC,OAAO,CAAChE,KAAK,CAAC,EAAIA,KAAK,CAACiE,GAAG,CAACC,IAAI,eACrCvG,KAAA,UAA4BoF,SAAS,CAAC,mEAAmE,CAAAC,QAAA,eACvGvF,IAAA,UACE+F,IAAI,CAAC,UAAU,CACfW,OAAO,CAAE9E,aAAa,CAACsB,QAAQ,CAACuD,IAAI,CAACE,SAAS,CAAE,CAChDV,QAAQ,CAAEA,CAAA,GAAMnD,gBAAgB,CAAC2D,IAAI,CAACE,SAAS,CAAE,CACjDrB,SAAS,CAAC,wEAAwE,CACnF,CAAC,cACFtF,IAAA,SAAMsF,SAAS,CAAC,yCAAyC,CAAAC,QAAA,CAAEkB,IAAI,CAACG,SAAS,CAAO,CAAC,GAPvEH,IAAI,CAACE,SAQV,CACR,CAAC,CACC,CAAC,CACH,CAAC,EACH,CAAC,CAGL/E,aAAa,CAACnB,MAAM,CAAG,CAAC,eACvBP,KAAA,QAAKoF,SAAS,CAAC,oDAAoD,CAAAC,QAAA,eACjEvF,IAAA,UAAOsF,SAAS,CAAC,kEAAkE,CAAAC,QAAA,CAAC,2NAEpF,CAAO,CAAC,cACRvF,IAAA,QAAKsF,SAAS,CAAC,uCAAuC,CAAAC,QAAA,CACnD3D,aAAa,CAAC4E,GAAG,CAACzD,QAAQ,EAAI,CAC7B,KAAM,CAAA0D,IAAI,CAAGlE,KAAK,CAACmB,IAAI,CAACmD,CAAC,EAAIA,CAAC,CAACF,SAAS,GAAK5D,QAAQ,CAAC,CACtD,mBACE7C,KAAA,UAAsBoF,SAAS,CAAC,0DAA0D,CAAAC,QAAA,eACxFvF,IAAA,UACE+F,IAAI,CAAC,OAAO,CACZe,IAAI,CAAC,UAAU,CACfd,KAAK,CAAEjD,QAAS,CAChB2D,OAAO,CAAE5E,gBAAgB,GAAKiB,QAAS,CACvCkD,QAAQ,CAAEA,CAAA,GAAM5C,oBAAoB,CAACN,QAAQ,CAAE,CAC/CuC,SAAS,CAAC,4DAA4D,CACvE,CAAC,cACFtF,IAAA,SAAMsF,SAAS,CAAC,yCAAyC,CAAAC,QAAA,CAAEkB,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEG,SAAS,CAAO,CAAC,GATxE7D,QAUL,CAAC,CAEZ,CAAC,CAAC,CACC,CAAC,EACH,CACN,cAGD7C,KAAA,QAAKoF,SAAS,CAAC,4BAA4B,CAAAC,QAAA,eACzCrF,KAAA,UAAOoF,SAAS,CAAC,mEAAmE,CAAAC,QAAA,EAAC,mMAEnF,CAACb,gBAAgB,CAACjE,MAAM,CAAG,CAAC,eAC1BP,KAAA,SAAMoF,SAAS,CAAC,+EAA+E,CAAAC,QAAA,EAC5Fb,gBAAgB,CAACvB,MAAM,CAACQ,CAAC,EAAI,CAACA,CAAC,CAACyB,SAAS,CAAC,CAAC3E,MAAM,CAAC,eACrD,EAAM,CACP,EACI,CAAC,cAGRP,KAAA,QAAKoF,SAAS,CAAC,kCAAkC,CAAAC,QAAA,eAC/CvF,IAAA,UACE+F,IAAI,CAAC,MAAM,CACXgB,WAAW,CAAC,gSAAqD,CACjEf,KAAK,CAAE3D,YAAa,CACpB4D,QAAQ,CAAGC,CAAC,EAAK5D,eAAe,CAAC4D,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE,CACjDV,SAAS,CAAC,0HAA0H,CACpI0B,UAAU,CAAGd,CAAC,EAAKA,CAAC,CAAChC,GAAG,GAAK,OAAO,EAAIZ,sBAAsB,CAAC,CAAE,CAClE,CAAC,cACFpD,KAAA,WACE6F,IAAI,CAAC,QAAQ,CACbD,OAAO,CAAExC,sBAAuB,CAChCgC,SAAS,CAAC,2HAA2H,CAAAC,QAAA,eAErIvF,IAAA,CAACH,IAAI,EAACyF,SAAS,CAAC,cAAc,CAAE,CAAC,iCAEnC,EAAQ,CAAC,EACN,CAAC,cAGNtF,IAAA,QAAKsF,SAAS,CAAC,4EAA4E,CAAAC,QAAA,CACxFb,gBAAgB,CAACjE,MAAM,CAAG,CAAC,cAC1BT,IAAA,QAAKsF,SAAS,CAAC,WAAW,CAAAC,QAAA,CACvBb,gBAAgB,CAAC8B,GAAG,CAAC,CAACS,OAAO,CAAEC,KAAK,gBACnChH,KAAA,QAEEoF,SAAS,4DAAAxB,MAAA,CACPmD,OAAO,CAAC7B,SAAS,CACb,qCAAqC,CACrC,8BAA8B,CACjC,CAAAG,QAAA,eAEHrF,KAAA,QAAKoF,SAAS,CAAC,6BAA6B,CAAAC,QAAA,eAC1CvF,IAAA,QAAKsF,SAAS,yBAAAxB,MAAA,CACZmD,OAAO,CAACjC,MAAM,GAAK,QAAQ,CAAG,aAAa,CAAG,cAAc,CAC3D,CAAM,CAAC,cACV9E,KAAA,QAAAqF,QAAA,eACErF,KAAA,QAAKoF,SAAS,CAAC,4BAA4B,CAAAC,QAAA,EACxC0B,OAAO,CAACE,MAAM,CAAC,GAAC,CAACF,OAAO,CAAClD,SAAS,CAAC,GAAC,CAACkD,OAAO,CAACjD,QAAQ,EACnD,CAAC,cACN9D,KAAA,QAAKoF,SAAS,CAAC,wBAAwB,CAAAC,QAAA,EAAC,8CAC7B,CAAC0B,OAAO,CAACpD,eAAe,CAAC,KAAG,CAACoD,OAAO,CAACL,SAAS,EACpD,CAAC,EACH,CAAC,EACH,CAAC,cACN5G,IAAA,QAAKsF,SAAS,CAAC,6BAA6B,CAAAC,QAAA,CACzC0B,OAAO,CAAC7B,SAAS,cAChBpF,IAAA,WACE8F,OAAO,CAAEA,CAAA,GAAMvB,oBAAoB,CAAC0C,OAAO,CAACpD,eAAe,CAAE,CAC7DyB,SAAS,CAAC,yDAAyD,CAAAC,QAAA,CACpE,kDAED,CAAQ,CAAC,cAETvF,IAAA,WACE8F,OAAO,CAAEA,CAAA,GAAMmB,OAAO,CAACjC,MAAM,GAAK,QAAQ,CACtCP,yBAAyB,CAACwC,OAAO,CAACpD,eAAe,CAAC,CAClDQ,mBAAmB,CAAC4C,OAAO,CAACpD,eAAe,CAC9C,CACDyB,SAAS,CAAC,iCAAiC,CAAAC,QAAA,cAE3CvF,IAAA,CAACF,MAAM,EAACwF,SAAS,CAAC,SAAS,CAAE,CAAC,CACxB,CACT,CACE,CAAC,GAvCD4B,KAwCF,CACN,CAAC,CACC,CAAC,cAENhH,KAAA,QAAKoF,SAAS,CAAC,iCAAiC,CAAAC,QAAA,eAC9CvF,IAAA,MAAAuF,QAAA,CAAG,oKAA2B,CAAG,CAAC,cAClCvF,IAAA,MAAGsF,SAAS,CAAC,SAAS,CAAAC,QAAA,CAAC,sRAA8C,CAAG,CAAC,EACtE,CACN,CACE,CAAC,EACH,CAAC,cAGNrF,KAAA,QAAKoF,SAAS,CAAC,kEAAkE,CAAAC,QAAA,EAC9EhE,UAAU,eACTrB,KAAA,WACE4F,OAAO,CAAElD,QAAS,CAClBwE,QAAQ,CAAE3E,MAAO,CACjB6C,SAAS,CAAC,qKAAqK,CAAAC,QAAA,eAE/KvF,IAAA,CAACF,MAAM,EAACwF,SAAS,CAAC,cAAc,CAAE,CAAC,+DAErC,EAAQ,CACT,cACDpF,KAAA,QAAKoF,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrCvF,IAAA,WACE8F,OAAO,CAAEpD,OAAQ,CACjB0E,QAAQ,CAAE3E,MAAO,CACjB6C,SAAS,CAAC,gLAAgL,CAAAC,QAAA,CAC3L,sCAED,CAAQ,CAAC,cACTvF,IAAA,WACE8F,OAAO,CAAEnD,MAAO,CAChByE,QAAQ,CAAE3E,MAAM,EAAIiC,gBAAgB,CAACvB,MAAM,CAACQ,CAAC,EAAI,CAACA,CAAC,CAACyB,SAAS,CAAC,CAAC3E,MAAM,GAAK,CAAC,EAAI,CAACqB,gBAAiB,CACjGwD,SAAS,CAAC,kLAAkL,CAAAC,QAAA,CAE3L9C,MAAM,cACLvC,KAAA,CAAAE,SAAA,EAAAmF,QAAA,eACEvF,IAAA,QAAKsF,SAAS,CAAC,gEAAgE,CAAM,CAAC,wEAExF,EAAE,CAAC,cAEHpF,KAAA,CAAAE,SAAA,EAAAmF,QAAA,eACEvF,IAAA,CAACJ,IAAI,EAAC0F,SAAS,CAAC,cAAc,CAAE,CAAC,uCAEnC,EAAE,CACH,CACK,CAAC,EACN,CAAC,EACH,CAAC,EACH,CAAC,CACH,CAAC,EACH,CAAC,CACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAAlE,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}