{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Routes,Route,Navigate,useNavigate}from\"react-router-dom\";import AdminPage from'./pages/AdminPage';import LoginPage from'./pages/LoginPage';import OnDutyPage from'./pages/OnDutyPage';import AuthRegisterPage from'./pages/AuthRegisterPage';import DashboardPage from'./pages/DashboardPage';import PersonnelPage from'./pages/PersonnelPage';import ShiftWorkPage from'./pages/ShiftWorkPage';import AppLayout from'./layouts/AppLayout';import ChatPage from'./pages/ChatPage';import ProtectedRoute from'./routes/ProtectedRoute';import ProfilePage from'./pages/ProfilePage';import SettingsPage from'./pages/SettingsPage';import DutyManagementPage from\"./pages/DutyManagementPage\";import{CONFIG}from'./config';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[user,setUser]=useState(null);const[authLoading,setAuthLoading]=useState(true);const navigate=useNavigate();useEffect(()=>{const checkLoginStatus=async()=>{const token=localStorage.getItem('user_token');if(token){try{const response=await fetch(\"\".concat(CONFIG.API_BASE_URL,\"/api/auth/verify\"),{headers:{'Authorization':\"Bearer \".concat(token)}});const data=await response.json();if(data.success){setUser(data.user);}else{localStorage.removeItem('user_token');}}catch(error){console.error(\"Token verification failed:\",error);localStorage.removeItem('user_token');}}setAuthLoading(false);};checkLoginStatus();},[]);const handleLogin=loginData=>{localStorage.setItem('user_token',loginData.token);setUser(loginData.user);navigate(\"/\");};const handleLogout=()=>{localStorage.removeItem('user_token');setUser(null);navigate(\"/login\");};const handleOpenNotifications=()=>{alert(\"การแจ้งเตือน - ฟีเจอร์นี้อยู่ระหว่างการพัฒนา\");};return/*#__PURE__*/_jsx(\"div\",{className:\"bg-slate-100 min-h-screen\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container mx-auto p-4\",children:authLoading?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen\",children:/*#__PURE__*/_jsx(\"div\",{children:\"\\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E42\\u0E2B\\u0E25\\u0E14...\"})}):/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/on-duty\",element:/*#__PURE__*/_jsx(OnDutyPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:!user?/*#__PURE__*/_jsx(LoginPage,{onLogin:handleLogin}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:!user?/*#__PURE__*/_jsx(AuthRegisterPage,{onLoginSuccess:handleLogin}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{element:/*#__PURE__*/_jsx(ProtectedRoute,{user:user}),children:/*#__PURE__*/_jsxs(Route,{element:/*#__PURE__*/_jsx(AppLayout,{user:user,onLogout:handleLogout,onOpenNotifications:handleOpenNotifications}),children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(DashboardPage,{user:user})}),/*#__PURE__*/_jsx(Route,{path:\"/personnel\",element:/*#__PURE__*/_jsx(PersonnelPage,{user:user})}),/*#__PURE__*/_jsx(Route,{path:\"/tasks\",element:/*#__PURE__*/_jsx(ShiftWorkPage,{user:user})}),/*#__PURE__*/_jsx(Route,{path:\"/shifts\",element:/*#__PURE__*/_jsx(ShiftWorkPage,{user:user})}),/*#__PURE__*/_jsx(Route,{path:\"/chat\",element:/*#__PURE__*/_jsx(ChatPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:/*#__PURE__*/_jsx(ProfilePage,{user:user})}),/*#__PURE__*/_jsx(Route,{path:\"/settings\",element:/*#__PURE__*/_jsx(SettingsPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/duty-management\",element:/*#__PURE__*/_jsx(DutyManagementPage,{})}),(user===null||user===void 0?void 0:user.role)==='admin'&&/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(AdminPage,{user:user})})]})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:user?\"/\":\"/login\"})})]})})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","Routes","Route","Navigate","useNavigate","AdminPage","LoginPage","OnDutyPage","AuthRegisterPage","DashboardPage","PersonnelPage","ShiftWorkPage","AppLayout","ChatPage","ProtectedRoute","ProfilePage","SettingsPage","DutyManagementPage","CONFIG","jsx","_jsx","jsxs","_jsxs","App","user","setUser","authLoading","setAuthLoading","navigate","checkLoginStatus","token","localStorage","getItem","response","fetch","concat","API_BASE_URL","headers","data","json","success","removeItem","error","console","handleLogin","loginData","setItem","handleLogout","handleOpenNotifications","alert","className","children","path","element","onLogin","to","onLoginSuccess","onLogout","onOpenNotifications","role"],"sources":["C:/Users/LENOVO/Documents/GitHub/court-marshal-connect/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Routes, Route, Navigate, useNavigate } from \"react-router-dom\";\r\nimport AdminPage from './pages/AdminPage';\r\nimport LoginPage from './pages/LoginPage';\r\nimport OnDutyPage from './pages/OnDutyPage';\r\nimport AuthRegisterPage from './pages/AuthRegisterPage';\r\nimport DashboardPage from './pages/DashboardPage';\r\nimport PersonnelPage from './pages/PersonnelPage';\r\nimport ShiftWorkPage from './pages/ShiftWorkPage';\r\nimport AppLayout from './layouts/AppLayout';\r\nimport ChatPage from './pages/ChatPage';\r\nimport ProtectedRoute from './routes/ProtectedRoute';\r\nimport ProfilePage from './pages/ProfilePage';\r\nimport SettingsPage from './pages/SettingsPage';\r\nimport DutyManagementPage from \"./pages/DutyManagementPage\";\r\nimport { CONFIG } from './config';\r\n\r\nfunction App() {\r\n  const [user, setUser] = useState(null);\r\n  const [authLoading, setAuthLoading] = useState(true);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const checkLoginStatus = async () => {\r\n      const token = localStorage.getItem('user_token');\r\n      if (token) {\r\n        try {\r\n          const response = await fetch(`${CONFIG.API_BASE_URL}/api/auth/verify`, {\r\n            headers: { 'Authorization': `Bearer ${token}` }\r\n          });\r\n          const data = await response.json();\r\n          if (data.success) {\r\n            setUser(data.user);\r\n          } else {\r\n            localStorage.removeItem('user_token');\r\n          }\r\n        } catch (error) {\r\n          console.error(\"Token verification failed:\", error);\r\n          localStorage.removeItem('user_token');\r\n        }\r\n      }\r\n      setAuthLoading(false);\r\n    };\r\n    checkLoginStatus();\r\n  }, []);\r\n\r\n  const handleLogin = (loginData) => {\r\n    localStorage.setItem('user_token', loginData.token);\r\n    setUser(loginData.user);\r\n    navigate(\"/\");\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('user_token');\r\n    setUser(null);\r\n    navigate(\"/login\");\r\n  };\r\n\r\n  const handleOpenNotifications = () => {\r\n    alert(\"การแจ้งเตือน - ฟีเจอร์นี้อยู่ระหว่างการพัฒนา\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-slate-100 min-h-screen\">\r\n      <div className=\"container mx-auto p-4\">\r\n        {authLoading ? (\r\n          <div className=\"flex items-center justify-center min-h-screen\"><div>กำลังโหลด...</div></div>\r\n        ) : (\r\n          <Routes>\r\n            <Route path=\"/on-duty\" element={<OnDutyPage />} />\r\n            <Route \r\n              path=\"/login\" \r\n              element={!user ? <LoginPage onLogin={handleLogin} /> : <Navigate to=\"/\" />} \r\n            />\r\n            <Route \r\n              path=\"/register\" \r\n              element={!user ? <AuthRegisterPage onLoginSuccess={handleLogin} /> : <Navigate to=\"/\" />} \r\n            />\r\n            \r\n            <Route element={<ProtectedRoute user={user} />}>\r\n              <Route element={<AppLayout user={user} onLogout={handleLogout} onOpenNotifications={handleOpenNotifications} />}>\r\n                <Route path=\"/\" element={<DashboardPage user={user} />} />\r\n                <Route path=\"/personnel\" element={<PersonnelPage user={user} />} />\r\n                <Route path=\"/tasks\" element={<ShiftWorkPage user={user} />} />\r\n                <Route path=\"/shifts\" element={<ShiftWorkPage user={user} />} />\r\n                <Route path=\"/chat\" element={<ChatPage />} />\r\n                <Route path=\"/profile\" element={<ProfilePage user={user} />} />\r\n                <Route path=\"/settings\" element={<SettingsPage />} />\r\n                <Route path=\"/duty-management\" element={<DutyManagementPage />} />\r\n                {user?.role === 'admin' && (\r\n                  <Route path=\"/admin\" element={<AdminPage user={user} />} />\r\n                )}\r\n              </Route>\r\n            </Route>\r\n\r\n            <Route path=\"*\" element={<Navigate to={user ? \"/\" : \"/login\"} />} />\r\n          </Routes>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}