{"ast":null,"code":"import React,{useState,useCallback,useEffect}from'react';import UnitSelector from'./UnitSelector';import UnitManagementView from'./UnitManagementView';import{CONFIG}from'../../config';// Unit Structure Management Component\nimport{jsx as _jsx}from\"react/jsx-runtime\";const UnitStructureManagement=()=>{const[units,setUnits]=useState([]);const[officers,setOfficers]=useState([]);const[unitStructures,setUnitStructures]=useState([]);const[loading,setLoading]=useState(true);const[selectedUnit,setSelectedUnit]=useState(null);const[searchTerm,setSearchTerm]=useState('');const[view,setView]=useState('units');// 'units' or 'management'\n// Fetch ข้อมูลส่วนงานจาก duty_unit\nconst fetchUnits=useCallback(async()=>{try{const response=await fetch(\"\".concat(CONFIG.UNIT_STRUCTURE_API,\"/duty-units\"));const data=await response.json();if(data.success){setUnits(data.data);}}catch(error){console.error('Error fetching units:',error);}},[]);// Fetch ข้อมูลเจ้าหน้าที่\nconst fetchOfficers=useCallback(async()=>{try{const response=await fetch(\"\".concat(CONFIG.OFFICERS_API));const data=await response.json();if(data.success){setOfficers(data.data);}}catch(error){console.error('Error fetching officers:',error);}},[]);// Fetch ข้อมูลโครงสร้างส่วนงาน\nconst fetchUnitStructures=useCallback(async()=>{try{const response=await fetch(\"\".concat(CONFIG.UNIT_STRUCTURE_API));const data=await response.json();if(data.success){setUnitStructures(data.data);}}catch(error){console.error('Error fetching unit structures:',error);}finally{setLoading(false);}},[]);useEffect(()=>{fetchUnits();fetchOfficers();fetchUnitStructures();},[fetchUnits,fetchOfficers,fetchUnitStructures]);// แสดงหน้าเลือกส่วนงาน\nif(view==='units'){return/*#__PURE__*/_jsx(UnitSelector,{units:units,unitStructures:unitStructures,onSelectUnit:unit=>{setSelectedUnit(unit);setView('management');},loading:loading});}// แสดงหน้าจัดการบุคลากรในส่วนงาน\nreturn/*#__PURE__*/_jsx(UnitManagementView,{selectedUnit:selectedUnit,units:units,officers:officers,unitStructures:unitStructures,searchTerm:searchTerm,setSearchTerm:setSearchTerm,onBack:()=>{setView('units');setSelectedUnit(null);},onRefresh:fetchUnitStructures});};export default UnitStructureManagement;","map":{"version":3,"names":["React","useState","useCallback","useEffect","UnitSelector","UnitManagementView","CONFIG","jsx","_jsx","UnitStructureManagement","units","setUnits","officers","setOfficers","unitStructures","setUnitStructures","loading","setLoading","selectedUnit","setSelectedUnit","searchTerm","setSearchTerm","view","setView","fetchUnits","response","fetch","concat","UNIT_STRUCTURE_API","data","json","success","error","console","fetchOfficers","OFFICERS_API","fetchUnitStructures","onSelectUnit","unit","onBack","onRefresh"],"sources":["C:/Users/LENOVO/Documents/GitHub/court-marshal-connect/src/components/UnitStructure/UnitStructureManagement.js"],"sourcesContent":["import React, { useState, useCallback, useEffect } from 'react';\r\nimport UnitSelector from './UnitSelector';\r\nimport UnitManagementView from './UnitManagementView';\r\nimport { CONFIG } from '../../config';\r\n\r\n// Unit Structure Management Component\r\nconst UnitStructureManagement = () => {\r\n  const [units, setUnits] = useState([]);\r\n  const [officers, setOfficers] = useState([]);\r\n  const [unitStructures, setUnitStructures] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedUnit, setSelectedUnit] = useState(null);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [view, setView] = useState('units'); // 'units' or 'management'\r\n\r\n  // Fetch ข้อมูลส่วนงานจาก duty_unit\r\n  const fetchUnits = useCallback(async () => {\r\n    try {\r\n      const response = await fetch(`${CONFIG.UNIT_STRUCTURE_API}/duty-units`);\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setUnits(data.data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching units:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch ข้อมูลเจ้าหน้าที่\r\n  const fetchOfficers = useCallback(async () => {\r\n    try {\r\n      const response = await fetch(`${CONFIG.OFFICERS_API}`);\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setOfficers(data.data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching officers:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch ข้อมูลโครงสร้างส่วนงาน\r\n  const fetchUnitStructures = useCallback(async () => {\r\n    try {\r\n      const response = await fetch(`${CONFIG.UNIT_STRUCTURE_API}`);\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setUnitStructures(data.data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching unit structures:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchUnits();\r\n    fetchOfficers();\r\n    fetchUnitStructures();\r\n  }, [fetchUnits, fetchOfficers, fetchUnitStructures]);\r\n\r\n  // แสดงหน้าเลือกส่วนงาน\r\n  if (view === 'units') {\r\n    return <UnitSelector \r\n      units={units} \r\n      unitStructures={unitStructures}\r\n      onSelectUnit={(unit) => {\r\n        setSelectedUnit(unit);\r\n        setView('management');\r\n      }}\r\n      loading={loading}\r\n    />;\r\n  }\r\n\r\n  // แสดงหน้าจัดการบุคลากรในส่วนงาน\r\n  return <UnitManagementView\r\n    selectedUnit={selectedUnit}\r\n    units={units}\r\n    officers={officers}\r\n    unitStructures={unitStructures}\r\n    searchTerm={searchTerm}\r\n    setSearchTerm={setSearchTerm}\r\n    onBack={() => {\r\n      setView('units');\r\n      setSelectedUnit(null);\r\n    }}\r\n    onRefresh={fetchUnitStructures}\r\n  />;\r\n};\r\n\r\nexport default UnitStructureManagement;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}