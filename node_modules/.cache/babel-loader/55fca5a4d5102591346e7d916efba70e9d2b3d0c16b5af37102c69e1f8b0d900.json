{"ast":null,"code":"import _objectSpread from\"C:/Users/LENOVO/Documents/GitHub/court-marshal-connect/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";var _import$meta,_import$meta$env;import React,{useEffect,useRef,useState}from\"react\";import{Send,UserCircle2,Users,Shield}from\"lucide-react\";import io from\"socket.io-client\";// ชี้ไปยังโดเมนที่คุณโฮสต์เซิร์ฟเวอร์\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SOCKET_URL=((_import$meta=import.meta)===null||_import$meta===void 0?void 0:(_import$meta$env=_import$meta.env)===null||_import$meta$env===void 0?void 0:_import$meta$env.VITE_SOCKET_URL)||\"https://YOUR-SOCKET-SERVER\";const HISTORY_URL=\"\".concat(SOCKET_URL,\"/history\");// REST ดึงประวัติ\nconst DEFAULT_ROOMS=[{key:\"global\",label:\"ห้องกลาง\"}];export default function ChatPage(_ref){var _rooms$find;let{user}=_ref;const[socket,setSocket]=useState(null);const[rooms,setRooms]=useState(DEFAULT_ROOMS);const[activeRoom,setActiveRoom]=useState(\"global\");const[messages,setMessages]=useState([]);const[typingUsers,setTypingUsers]=useState({});const[text,setText]=useState(\"\");const bottomRef=useRef(null);// สร้าง JWT จากระบบล็อกอินของคุณ (ตัวอย่างเดโมเท่านั้น!)\n// ควรได้ token นี้มาตั้งแต่ตอน login แล้วเก็บใน localStorage\nconst token=localStorage.getItem(\"chatJWT\");// auto scroll\nuseEffect(()=>{var _bottomRef$current;(_bottomRef$current=bottomRef.current)===null||_bottomRef$current===void 0?void 0:_bottomRef$current.scrollIntoView({behavior:\"smooth\"});},[messages]);// connect socket\nuseEffect(()=>{const s=io(\"\".concat(SOCKET_URL,\"/chat\"),{transports:[\"websocket\",\"polling\"],auth:{token},// ใส่ JWT ที่ออกจาก backend คุณ\nwithCredentials:true});s.on(\"connect\",()=>{// สร้างรายชื่อห้องเริ่มต้นตามสิทธิ์ (ตัวอย่าง)\nconst today=new Date().toISOString().slice(0,10).replace(/-/g,\"\");const dynamicRooms=[{key:\"global\",label:\"ห้องกลาง\"},...(user!==null&&user!==void 0&&user.affiliation?[{key:\"unit-\".concat(user.affiliation),label:\"\\u0E2A\\u0E31\\u0E07\\u0E01\\u0E31\\u0E14: \".concat(user.affiliation)}]:[]),...(user!==null&&user!==void 0&&user.deph?[{key:\"dept-\".concat(user.deph),label:\"\\u0E41\\u0E1C\\u0E19\\u0E01: \".concat(user.deph)}]:[]),...(user!==null&&user!==void 0&&user.onDuty?[{key:\"duty-\".concat(today),label:\"\\u0E40\\u0E27\\u0E23\\u0E27\\u0E31\\u0E19\\u0E19\\u0E35\\u0E49 (\".concat(today,\")\")}]:[])];setRooms(dynamicRooms);setActiveRoom(\"global\");// โหลดประวัติของห้องแรก\nfetch(\"\".concat(HISTORY_URL,\"?room=global&limit=50\")).then(r=>r.json()).then(setMessages).catch(()=>{});});s.on(\"message\",msg=>{setMessages(prev=>msg.room===activeRoom?[...prev,msg]:prev);});s.on(\"typing\",_ref2=>{let{room,userId,name,typing}=_ref2;if(room!==activeRoom)return;setTypingUsers(prev=>{const clone=_objectSpread({},prev);if(typing)clone[userId]=name;else delete clone[userId];return clone;});});s.on(\"disconnect\",()=>{});setSocket(s);return()=>s.disconnect();},[]);// eslint-disable-line\n// เปลี่ยนห้อง\nconst switchRoom=async roomKey=>{setActiveRoom(roomKey);// ขอ server join เพิ่ม (เผื่อเป็นห้องไม่ได้ join อัตโนมัติ)\nsocket===null||socket===void 0?void 0:socket.emit(\"join\",roomKey);const hist=await fetch(\"\".concat(HISTORY_URL,\"?room=\").concat(encodeURIComponent(roomKey),\"&limit=50\")).then(r=>r.json()).catch(()=>[]);setMessages(hist);setTypingUsers({});};// ส่งข้อความ\nconst send=()=>{if(!text.trim()||!socket)return;const payload={room:activeRoom,text:text.trim(),clientId:\"\".concat(Date.now())};socket.emit(\"message\",payload);setText(\"\");// แสดงทันที (optimistic) จะให้รอ server echo กลับก็ได้\n// setMessages(prev => [...prev, { ...payload, senderId: user?.id, senderName: user?.firstname, createdAt: Date.now() }]);\n};const onKeyDown=e=>{if(e.key===\"Enter\"&&!e.shiftKey){e.preventDefault();send();}else{// typing indicator\nsocket===null||socket===void 0?void 0:socket.emit(\"typing\",{room:activeRoom,typing:true});// หยุด typing ผ่าน debounce ง่าย ๆ\nclearTimeout(onKeyDown._t);onKeyDown._t=setTimeout(()=>socket===null||socket===void 0?void 0:socket.emit(\"typing\",{room:activeRoom,typing:false}),800);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col h-full bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-b border-slate-200 flex items-center justify-between bg-gradient-to-r from-indigo-500 to-purple-600 text-white\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(Shield,{className:\"w-7 h-7\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold\",children:\"\\u0E41\\u0E0A\\u0E17\\u0E2B\\u0E19\\u0E48\\u0E27\\u0E22\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs opacity-80\",children:\"Realtime chat (Socket.io)\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 text-sm\",children:[/*#__PURE__*/_jsx(Users,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsxs(\"span\",{children:[rooms.length,\" \\u0E2B\\u0E49\\u0E2D\\u0E07\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2 p-2 bg-slate-50 border-b border-slate-200 overflow-x-auto\",children:rooms.map(r=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>switchRoom(r.key),className:\"px-3 py-1.5 rounded-xl text-sm whitespace-nowrap \".concat(activeRoom===r.key?\"bg-indigo-600 text-white\":\"bg-white border border-slate-200 text-slate-700\"),children:r.label},r.key))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50\",children:[messages.map(m=>{const isMe=m.senderId&&(String(m.senderId)===String(user===null||user===void 0?void 0:user.id)||m.senderName===(user===null||user===void 0?void 0:user.firstname));return/*#__PURE__*/_jsx(\"div\",{className:\"flex \".concat(isMe?\"justify-end\":\"justify-start\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-xs md:max-w-md px-4 py-2 rounded-2xl \".concat(isMe?\"bg-indigo-600 text-white rounded-br-none\":\"bg-white border border-slate-200 text-slate-800 rounded-bl-none\"),children:[!isMe&&/*#__PURE__*/_jsx(\"div\",{className:\"text-xs opacity-70 mb-0.5\",children:m.senderName}),/*#__PURE__*/_jsx(\"div\",{children:m.text}),/*#__PURE__*/_jsx(\"div\",{className:\"text-[10px] mt-1 \".concat(isMe?\"text-white/80\":\"text-slate-500\"),children:new Date(m.createdAt||Date.now()).toLocaleTimeString(\"th-TH\",{hour:\"2-digit\",minute:\"2-digit\"})})]})},m.messageId);}),Object.keys(typingUsers).length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-slate-500 italic px-2\",children:[Object.values(typingUsers).join(\", \"),\" \\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E1E\\u0E34\\u0E21\\u0E1E\\u0E4C...\"]}),/*#__PURE__*/_jsx(\"div\",{ref:bottomRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 border-t border-slate-200 bg-white flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"textarea\",{rows:1,value:text,onChange:e=>setText(e.target.value),onKeyDown:onKeyDown,placeholder:\"\\u0E1E\\u0E34\\u0E21\\u0E1E\\u0E4C\\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\\u0E16\\u0E36\\u0E07 \\\"\".concat(((_rooms$find=rooms.find(r=>r.key===activeRoom))===null||_rooms$find===void 0?void 0:_rooms$find.label)||\"\",\"\\\"\"),className:\"flex-1 resize-none rounded-xl border border-slate-300 px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"}),/*#__PURE__*/_jsx(\"button\",{onClick:send,className:\"p-3 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white flex items-center justify-center\",children:/*#__PURE__*/_jsx(Send,{className:\"w-5 h-5\"})})]})]});}","map":{"version":3,"names":["React","useEffect","useRef","useState","Send","UserCircle2","Users","Shield","io","jsx","_jsx","jsxs","_jsxs","SOCKET_URL","_import$meta","import","meta","_import$meta$env","env","VITE_SOCKET_URL","HISTORY_URL","concat","DEFAULT_ROOMS","key","label","ChatPage","_ref","_rooms$find","user","socket","setSocket","rooms","setRooms","activeRoom","setActiveRoom","messages","setMessages","typingUsers","setTypingUsers","text","setText","bottomRef","token","localStorage","getItem","_bottomRef$current","current","scrollIntoView","behavior","s","transports","auth","withCredentials","on","today","Date","toISOString","slice","replace","dynamicRooms","affiliation","deph","onDuty","fetch","then","r","json","catch","msg","prev","room","_ref2","userId","name","typing","clone","_objectSpread","disconnect","switchRoom","roomKey","emit","hist","encodeURIComponent","send","trim","payload","clientId","now","onKeyDown","e","shiftKey","preventDefault","clearTimeout","_t","setTimeout","className","children","length","map","onClick","m","isMe","senderId","String","id","senderName","firstname","createdAt","toLocaleTimeString","hour","minute","messageId","Object","keys","values","join","ref","rows","value","onChange","target","placeholder","find"],"sources":["C:/Users/LENOVO/Documents/GitHub/court-marshal-connect/src/pages/ChatPage.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport { Send, UserCircle2, Users, Shield } from \"lucide-react\";\r\nimport io from \"socket.io-client\";\r\n\r\n// ชี้ไปยังโดเมนที่คุณโฮสต์เซิร์ฟเวอร์\r\nconst SOCKET_URL = import.meta?.env?.VITE_SOCKET_URL || \"https://YOUR-SOCKET-SERVER\";\r\nconst HISTORY_URL = `${SOCKET_URL}/history`; // REST ดึงประวัติ\r\n\r\nconst DEFAULT_ROOMS = [\r\n  { key: \"global\", label: \"ห้องกลาง\" },\r\n];\r\n\r\nexport default function ChatPage({ user }) {\r\n  const [socket, setSocket] = useState(null);\r\n  const [rooms, setRooms] = useState(DEFAULT_ROOMS);\r\n  const [activeRoom, setActiveRoom] = useState(\"global\");\r\n  const [messages, setMessages] = useState([]);\r\n  const [typingUsers, setTypingUsers] = useState({});\r\n  const [text, setText] = useState(\"\");\r\n  const bottomRef = useRef(null);\r\n\r\n  // สร้าง JWT จากระบบล็อกอินของคุณ (ตัวอย่างเดโมเท่านั้น!)\r\n  // ควรได้ token นี้มาตั้งแต่ตอน login แล้วเก็บใน localStorage\r\n  const token = localStorage.getItem(\"chatJWT\");\r\n\r\n  // auto scroll\r\n  useEffect(() => {\r\n    bottomRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  }, [messages]);\r\n\r\n  // connect socket\r\n  useEffect(() => {\r\n    const s = io(`${SOCKET_URL}/chat`, {\r\n      transports: [\"websocket\", \"polling\"],\r\n      auth: { token }, // ใส่ JWT ที่ออกจาก backend คุณ\r\n      withCredentials: true\r\n    });\r\n\r\n    s.on(\"connect\", () => {\r\n      // สร้างรายชื่อห้องเริ่มต้นตามสิทธิ์ (ตัวอย่าง)\r\n      const today = new Date().toISOString().slice(0,10).replace(/-/g,\"\");\r\n      const dynamicRooms = [\r\n        { key: \"global\", label: \"ห้องกลาง\" },\r\n        ...(user?.affiliation ? [{ key: `unit-${user.affiliation}`, label: `สังกัด: ${user.affiliation}` }] : []),\r\n        ...(user?.deph ? [{ key: `dept-${user.deph}`, label: `แผนก: ${user.deph}` }] : []),\r\n        ...(user?.onDuty ? [{ key: `duty-${today}`, label: `เวรวันนี้ (${today})` }] : []),\r\n      ];\r\n      setRooms(dynamicRooms);\r\n      setActiveRoom(\"global\");\r\n      // โหลดประวัติของห้องแรก\r\n      fetch(`${HISTORY_URL}?room=global&limit=50`).then(r => r.json()).then(setMessages).catch(()=>{});\r\n    });\r\n\r\n    s.on(\"message\", (msg) => {\r\n      setMessages(prev => (msg.room === activeRoom ? [...prev, msg] : prev));\r\n    });\r\n\r\n    s.on(\"typing\", ({ room, userId, name, typing }) => {\r\n      if (room !== activeRoom) return;\r\n      setTypingUsers(prev => {\r\n        const clone = { ...prev };\r\n        if (typing) clone[userId] = name;\r\n        else delete clone[userId];\r\n        return clone;\r\n      });\r\n    });\r\n\r\n    s.on(\"disconnect\", () => {});\r\n\r\n    setSocket(s);\r\n    return () => s.disconnect();\r\n  }, []); // eslint-disable-line\r\n\r\n  // เปลี่ยนห้อง\r\n  const switchRoom = async (roomKey) => {\r\n    setActiveRoom(roomKey);\r\n    // ขอ server join เพิ่ม (เผื่อเป็นห้องไม่ได้ join อัตโนมัติ)\r\n    socket?.emit(\"join\", roomKey);\r\n    const hist = await fetch(`${HISTORY_URL}?room=${encodeURIComponent(roomKey)}&limit=50`).then(r => r.json()).catch(()=>[]);\r\n    setMessages(hist);\r\n    setTypingUsers({});\r\n  };\r\n\r\n  // ส่งข้อความ\r\n  const send = () => {\r\n    if (!text.trim() || !socket) return;\r\n    const payload = { room: activeRoom, text: text.trim(), clientId: `${Date.now()}` };\r\n    socket.emit(\"message\", payload);\r\n    setText(\"\");\r\n    // แสดงทันที (optimistic) จะให้รอ server echo กลับก็ได้\r\n    // setMessages(prev => [...prev, { ...payload, senderId: user?.id, senderName: user?.firstname, createdAt: Date.now() }]);\r\n  };\r\n\r\n  const onKeyDown = (e) => {\r\n    if (e.key === \"Enter\" && !e.shiftKey) {\r\n      e.preventDefault();\r\n      send();\r\n    } else {\r\n      // typing indicator\r\n      socket?.emit(\"typing\", { room: activeRoom, typing: true });\r\n      // หยุด typing ผ่าน debounce ง่าย ๆ\r\n      clearTimeout(onKeyDown._t);\r\n      onKeyDown._t = setTimeout(() => socket?.emit(\"typing\", { room: activeRoom, typing: false }), 800);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden\">\r\n      {/* Header */}\r\n      <div className=\"p-4 border-b border-slate-200 flex items-center justify-between bg-gradient-to-r from-indigo-500 to-purple-600 text-white\">\r\n        <div className=\"flex items-center space-x-3\">\r\n          <Shield className=\"w-7 h-7\" />\r\n          <div>\r\n            <div className=\"font-semibold\">แชทหน่วย</div>\r\n            <div className=\"text-xs opacity-80\">Realtime chat (Socket.io)</div>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2 text-sm\">\r\n          <Users className=\"w-4 h-4\" />\r\n          <span>{rooms.length} ห้อง</span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabs (Rooms) */}\r\n      <div className=\"flex gap-2 p-2 bg-slate-50 border-b border-slate-200 overflow-x-auto\">\r\n        {rooms.map(r => (\r\n          <button\r\n            key={r.key}\r\n            onClick={() => switchRoom(r.key)}\r\n            className={`px-3 py-1.5 rounded-xl text-sm whitespace-nowrap ${\r\n              activeRoom === r.key ? \"bg-indigo-600 text-white\" : \"bg-white border border-slate-200 text-slate-700\"\r\n            }`}\r\n          >\r\n            {r.label}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Messages */}\r\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50\">\r\n        {messages.map((m) => {\r\n          const isMe = m.senderId && (String(m.senderId) === String(user?.id) || m.senderName === user?.firstname);\r\n        return (\r\n          <div key={m.messageId} className={`flex ${isMe ? \"justify-end\" : \"justify-start\"}`}>\r\n            <div className={`max-w-xs md:max-w-md px-4 py-2 rounded-2xl ${\r\n              isMe ? \"bg-indigo-600 text-white rounded-br-none\" : \"bg-white border border-slate-200 text-slate-800 rounded-bl-none\"\r\n            }`}>\r\n              {!isMe && <div className=\"text-xs opacity-70 mb-0.5\">{m.senderName}</div>}\r\n              <div>{m.text}</div>\r\n              <div className={`text-[10px] mt-1 ${isMe ? \"text-white/80\" : \"text-slate-500\"}`}>\r\n                {new Date(m.createdAt || Date.now()).toLocaleTimeString(\"th-TH\",{hour:\"2-digit\",minute:\"2-digit\"})}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )})}\r\n        {/* typing */}\r\n        {Object.keys(typingUsers).length > 0 && (\r\n          <div className=\"text-xs text-slate-500 italic px-2\">\r\n            {Object.values(typingUsers).join(\", \")} กำลังพิมพ์...\r\n          </div>\r\n        )}\r\n        <div ref={bottomRef} />\r\n      </div>\r\n\r\n      {/* Input */}\r\n      <div className=\"p-3 border-t border-slate-200 bg-white flex items-center space-x-2\">\r\n        <textarea\r\n          rows={1}\r\n          value={text}\r\n          onChange={(e) => setText(e.target.value)}\r\n          onKeyDown={onKeyDown}\r\n          placeholder={`พิมพ์ข้อความถึง \"${rooms.find(r=>r.key===activeRoom)?.label || \"\"}\"`}\r\n          className=\"flex-1 resize-none rounded-xl border border-slate-300 px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"\r\n        />\r\n        <button\r\n          onClick={send}\r\n          className=\"p-3 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white flex items-center justify-center\"\r\n        >\r\n          <Send className=\"w-5 h-5\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}